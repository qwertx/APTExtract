North NNP
Korea NNP
Bitten VBN
by IN
Bitcoin NNP
Bug NNP
Financially RB
motivated JJ
campaigns NNS
reveal VB
new JJ
dimension NN
of IN
the DT
Lazarus NNP
Group NNP
Darien NNP
Huss NNP
www.proofpoint.com NN
Table NN
of IN
Contents NNS
EXECUTIVE NN
SUMMARY NN
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
. .
3 CD
OVERVIEW NN
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
4 CD
INTRODUCTION NN
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
4 CD
PowerRatankba NNP
Downloaders NNS
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
.5 NN
Campaign NNP
Timeline NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
. .
5 CD
PowerSpritz NN
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
. .
6 CD
Windows NNS
Shortcut NNP
( (
LNK NNP
) )
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
.. VBZ
8 CD
Microsoft NNP
Compiled NNP
HTML NNP
Help NNP
( (
CHM NNP
) )
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
9 CD
JavaScript NN
Downloaders NNS
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
11 CD
VBScript NNP
Macro NNP
Microsoft NNP
Office NNP
Documents NNS
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
. .
13 CD
Backdoored NNP
PyInstaller NNP
Applications NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
.. VBZ
15 CD
Implant JJ
Description NNP
and CC
Analysis NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
..18 NN
PowerRatankba NNP
Description NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
. .
18 CD
PowerRatankba.A NNP
C NNP
& CC
C NNP
Description NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
. .
19 CD
PowerRatankba.B NNP
C NNP
& CC
C NNP
Description NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
20 CD
PowerRatankba NNP
Persistence NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
20 CD
PowerRatankba.B NNP
Stage2 NNP
- :
Gh0st NNP
RAT NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
.. VBZ
21 CD
Gh0st NNP
RAT NNP
Purpose NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
.. VBZ
23 CD
Shopping VBG
Spree NN
: :
Enter NN
RatankbaPOS NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
23 CD
RatankbaPOS NNP
Analysis NN
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
.. VBZ
23 CD
RatankbaPOS NNP
Targeted NNP
Region NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
. .
28 CD
Attribution NN
to TO
Lazarus NNP
Group NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
.28 NN
Encryption NN
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
. .
28 CD
Obfuscation NN
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
.. VBZ
30 CD
Functionality NN
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
. .
30 CD
Code NNP
Overlap NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
.. VBZ
31 CD
Decoys NNS
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
32 CD
C NNP
& CC
C NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
.. VBZ
32 CD
CONCLUSION NN
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
.. VBZ
33 CD
Research NN
Contributions NNS
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
. .
33 CD
Indicators NNS
of IN
Compromise NNP
( (
IOCs NNP
) )
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
. .
34 CD
ET NNP
and CC
ETPRO NNP
Suricata/Snort NNP
Signatures NNP
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
... :
37 CD
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
2 CD
Executive NN
Summary NNP
With IN
activity NN
dating VBG
at IN
least JJS
to TO
2009 CD
, ,
the DT
Lazarus NNP
Group NNP
has VBZ
consistently RB
ranked VBN
among IN
the DT
most RBS
disruptive JJ
, ,
successful JJ
, ,
and CC
far-reaching JJ
nation-state JJ
sponsored JJ
actors NNS
. .

The DT
March NNP
20 CD
, ,
2013 CD
attack NN
in IN
South NNP
Korea NNP
, ,
the DT
Sony NNP
Pictures NNP
hack NN
in IN
2014 CD
, ,
the DT
successful JJ
theft NN
of IN
$ $
81 CD
million CD
from IN
the DT
Bangladesh NNP
Bank NNP
in IN
2014 CD
, ,
and CC
perhaps RB
most RBS
famously RB
this DT
year NN
’ VBZ
s JJ
WannaCry NNP
ransomware NN
attack NN
and CC
its PRP$
global JJ
impact NN
have VBP
all DT
been VBN
attributed VBN
to TO
the DT
group NN
. .

The DT
Lazarus NNP
Group NNP
is VBZ
widely RB
accepted VBN
as IN
being VBG
a DT
North JJ
Korean JJ
state-sponsored JJ
threat NN
actor NN
by IN
numerous JJ
organizations NNS
in IN
the DT
information NN
security NN
industry NN
, ,
law NN
enforcement NN
agencies NNS
, ,
and CC
intelligence NN
agencies NNS
around IN
the DT
world NN
. .

The DT
Lazarus NNP
Group NNP
’ NNP
s VBD
arsenal JJ
of IN
tools NNS
, ,
implants NNS
, ,
and CC
exploits NNS
is VBZ
extensive JJ
and CC
under IN
constant JJ
development NN
. .

Previously RB
, ,
they PRP
have VBP
employed VBN
DDoS NNP
botnets NNS
, ,
wiper JJR
malware NN
to TO
temporarily RB
incapacitate VB
a DT
company NN
, ,
and CC
a DT
sophisticated JJ
set NN
of IN
malware NN
targeting VBG
the DT
SWIFT NNP
banking NN
system NN
to TO
steal VB
millions NNS
of IN
dollars NNS
. .

In IN
this DT
report NN
we PRP
describe VBP
and CC
analyze VBP
a DT
new JJ
, ,
currently RB
undocumented JJ
subset NN
of IN
the DT
Lazarus NNP
Group NNP
’ NNP
s VBZ
toolset NN
that WDT
has VBZ
been VBN
widely RB
targeting VBG
individuals NNS
, ,
companies NNS
, ,
and CC
organizations NNS
with IN
interests NNS
in IN
cryptocurrency NN
. .

Threat NN
vectors NNS
for IN
this DT
new JJ
toolset NN
, ,
dubbed VBN
PowerRatankba NNP
, ,
include VBP
highly RB
targeted JJ
spearphishing VBG
campaigns NNS
using VBG
links NNS
and CC
attachments NNS
as RB
well RB
as IN
massive JJ
email NN
phishing NN
campaigns NNS
targeting VBG
both DT
personal JJ
and CC
corporate JJ
accounts NNS
of IN
individuals NNS
with IN
interests NNS
in IN
cryptocurrency NN
. .

We PRP
also RB
share NN
our PRP$
discovery NN
of IN
what WP
may MD
be VB
the DT
first JJ
publicly RB
documented VBN
instance NN
of IN
a DT
nation-state JJ
targeting VBG
a DT
point-of-sale JJ
related JJ
framework NN
for IN
the DT
theft NN
of IN
credit NN
card NN
data NNS
, ,
again RB
using VBG
a DT
variant NN
of IN
malware NN
that WDT
is VBZ
closely RB
related VBN
to TO
PowerRatankba NNP
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
3 CD
Overview NN
The DT
Lazarus NNP
Group NNP
has VBZ
increasingly RB
focused VBN
on IN
financially RB
motivated VBN
attacks NNS
and CC
appears VBZ
to TO
be VB
capitalizing VBG
on IN
both DT
the DT
increasing VBG
interest NN
and CC
skyrocketing VBG
prices NNS
for IN
cryptocurrencies NNS
. .

Proofpoint NN
researchers NNS
have VBP
uncovered VBN
a DT
number NN
of IN
multistage NN
attacks NNS
that WDT
use VBP
cryptocurrency-related JJ
lures NNS
to TO
infect VB
victims NNS
with IN
sophisticated JJ
backdoors NNS
and CC
reconnaissance NN
malware NN
. .

Victims NNS
of IN
interest NN
are VBP
then RB
infected VBN
with IN
additional JJ
malware NN
including VBG
Gh0st NNP
RAT NNP
to TO
steal VB
credentials NNS
for IN
cryptocurrency NN
wallets NNS
and CC
exchanges NNS
, ,
enabling VBG
the DT
Lazarus NNP
Group NNP
to TO
conduct VB
lucrative JJ
operations NNS
stealing VBG
Bitcoin NNP
and CC
other JJ
cryptocurrencies NNS
. .

We PRP
also RB
discovered VBD
what WP
appears VBZ
to TO
be VB
the DT
first JJ
publicly RB
documented VBN
instance NN
of IN
a DT
nation-state JJ
targeting VBG
a DT
point-of-sale JJ
related JJ
framework NN
for IN
the DT
theft NN
of IN
credit NN
card NN
data NNS
in IN
a DT
related JJ
set NN
of IN
attacks NNS
. .

Moreover RB
, ,
the DT
timing NN
of IN
the DT
point-of-sale JJ
related JJ
attacks NNS
near IN
the DT
holiday NN
shopping NN
season NN
makes VBZ
the DT
potential JJ
financial JJ
losses NNS
considerable JJ
. .

Introduction NN
It PRP
is VBZ
already RB
well-known JJ
that IN
Lazarus NNP
Group NNP
has VBZ
targeted VBN
and CC
successfully RB
breached VBD
several JJ
prominent JJ
cryptocurrency NN
companies NNS
and CC
exchanges NNS
. .

From IN
these DT
breaches NNS
, ,
law NN
enforcement NN
agencies NNS
suspect VBP
that IN
the DT
group NN
has VBZ
amassed VBN
nearly RB
$ $
100 CD
million CD
worth NN
of IN
cryptocurrencies NNS
based VBN
on IN
their PRP$
value NN
today NN
. .

We PRP
hypothesize VBP
that IN
many JJ
of IN
these DT
previously RB
reported VBD
operations NNS
targeting VBG
cryptocurrency NN
organizations NNS
have VBP
actually RB
been VBN
conducted VBN
by IN
the DT
espionage NN
team NN
of IN
the DT
Lazarus NNP
Group NNP
based VBN
on IN
evidence NN
we PRP
provide VBP
in IN
the DT
Attribution NNP
section NN
. .

Further RB
, ,
we PRP
assess VBP
that IN
until IN
today NN
, ,
many JJ
of IN
Lazarus NNP
Group NNP
’ NNP
s VBD
traditional JJ
financially RB
motivated VBN
team NN
have VBP
remained VBN
largely RB
in IN
the DT
shadows NNS
as IN
they PRP
conduct VBP
these DT
operations NNS
adding VBG
to TO
their PRP$
already RB
impressive JJ
stockpile NN
of IN
various JJ
cryptocurrencies NNS
. .

Several JJ
watering VBG
hole JJ
attacks NNS
targeting VBG
the DT
banking NN
and CC
financial JJ
industries NNS
that WDT
occurred VBD
at IN
the DT
end NN
of IN
2016 CD
and CC
beginning VBG
of IN
2017 CD
utilized VBD
a DT
first JJ
stage NN
downloader NN
implant JJ
dubbed VBN
Ratankba NNP
. .

During IN
those DT
incidents NNS
, ,
Lazarus NNP
Group NNP
primarily RB
used VBD
Ratankba NNP
as IN
a DT
reconnaissance NN
tool NN
, ,
described VBN
by IN
colleagues NNS
at IN
Trend NNP
Micro NNP
as IN
a DT
utility NN
to TO
“ VB
survey NN
the DT
lay NN
of IN
the DT
land. NN
” NN
In IN
this DT
research NN
we PRP
detail VBP
a DT
new JJ
implant NN
dubbed VBN
PowerRatankba NNP
, ,
a DT
PowerShell-based JJ
malware NN
variant NN
that WDT
closely RB
resembles VBZ
the DT
original JJ
Ratankba NNP
implant NN
. .

We PRP
believe VBP
that IN
PowerRatankba NNP
was VBD
likely RB
developed VBN
as IN
a DT
replacement NN
in IN
Lazarus NNP
Group NNP
’ NNP
s NN
strictly RB
financially RB
motivated JJ
team NN
’ NNP
s VBD
arsenal JJ
to TO
fill VB
the DT
hole NN
left VBN
by IN
Ratankba NNP
’ NNP
s JJ
discovery NN
and CC
very RB
public JJ
documentation NN
earlier RBR
this DT
year NN
. .

In IN
this DT
report NN
, ,
we PRP
first RB
provide VB
a DT
brief JJ
timeline NN
of IN
events NNS
related VBN
to TO
the DT
malicious JJ
activity NN
. .

Next JJ
, ,
we PRP
describe VBP
the DT
various JJ
delivery NN
methods NNS
that IN
Lazarus NNP
Group NNP
utilized VBD
to TO
infect VB
victims NNS
with IN
PowerRatankba NNP
( (
Fig NNP
. .

1 CD
) )
. .

We PRP
then RB
detail VBD
the DT
inner NN
workings NNS
of IN
PowerRatankba NNP
and CC
how WRB
it PRP
is VBZ
utilized JJ
to TO
deliver VB
a DT
more RBR
fully RB
capable JJ
backdoor NN
to TO
interesting VBG
victims NNS
( (
Fig NNP
. .

1 CD
) )
. .

Following VBG
that IN
, ,
we PRP
share NN
details NNS
on IN
a DT
new JJ
and CC
emerging VBG
threat NN
targeting VBG
the DT
South JJ
Korean JJ
point-of-sale JJ
industry NN
that IN
we PRP
have VB
dubbed VBN
RatankbaPOS NNP
( (
Fig NNP
. .

1 CD
) )
. .

Finally RB
, ,
we PRP
explain VBP
our PRP$
high-confidence NN
attribution NN
to TO
Lazarus NNP
Group NNP
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
4 CD

Figure NN
1 CD
: :
Flow NN
of IN
PowerRatankba NNP
activity NN
from IN
victims NNS
to TO
the DT
Lazarus NNP
Group NNP
operators NNS
PowerRatankba NNP
Downloaders NNS
In IN
this DT
section NN
we PRP
will MD
detail VB
each DT
of IN
the DT
different JJ
attack NN
vectors NNS
and CC
campaigns NNS
we PRP
have VBP
discovered VBN
that IN
eventually RB
lead VB
to TO
the DT
delivery NN
of IN
PowerRatankba NNP
. .

In IN
total JJ
we PRP
have VBP
discovered VBN
six CD
different JJ
attack NN
vectors NNS
: :
• VB
A DT
new JJ
Windows NNP
executable JJ
downloader NN
dubbed VBD
PowerSpritz NNP
• VB
A DT
malicious JJ
Windows NNP
Shortcut NNP
( (
LNK NNP
) )
file NN
• JJ
Several NNP
malicious JJ
Microsoft NNP
Compiled NNP
HTML NNP
Help NNP
( (
CHM NNP
) )
files VBZ
using VBG
two CD
different JJ
techniques NNS
• JJ
Multiple NNP
JavaScript NNP
( (
JS NNP
) )
downloaders NNS
• JJ
Two CD
macro-based JJ
Microsoft NNP
Office NNP
documents NNS
• RB
Two CD
campaigns NNS
utilizing VBG
backdoored VBD
popular JJ
cryptocurrency NN
applications NNS
hosted VBD
on IN
internationalized JJ
domain NN
( (
IDN NNP
) )
infrastructure NN
to TO
trick VB
victims NNS
into IN
thinking VBG
they PRP
were VBD
on IN
a DT
legitimate JJ
website NN
Campaign NNP
Timeline NNP
The DT
campaigns NNS
discussed VBN
in IN
this DT
research NN
began VBD
on IN
or CC
around IN
June NNP
30th CD
, ,
2017 CD
. .

According VBG
to TO
our PRP$
data NNS
those DT
campaigns NNS
were VBD
highly RB
targeted VBN
spearphishing VBG
attacks NNS
targeting VBG
at IN
least JJS
one CD
executive NN
at IN
a DT
cryptocurrency NN
organization NN
to TO
deliver VB
a DT
PowerRatankba.A NNP
variant NN
. .

All DT
other JJ
campaigns NNS
utilized JJ
PowerRatankba.B NNP
variants NNS
. .

We PRP
currently RB
have VBP
no DT
visibility NN
into IN
how WRB
the DT
LNK NNP
, ,
CHM NNP
, ,
and CC
JS NNP
campaigns NNS
were VBD
delivered VBN
to TO
users NNS
, ,
but CC
given VBN
common JJ
Lazarus NNP
modus NN
operandi NN
, ,
we PRP
can MD
speculate VB
that IN
they PRP
may MD
have VB
been VBN
delivered VBN
through IN
attachments NNS
or CC
links NNS
in IN
emails NNS
. .

We PRP
gained VBD
visibility NN
again RB
during IN
the DT
massive JJ
email NN
campaigns NNS
utilizing VBG
BTG- NNP
and CC
Electrum-themed NNP
applications NNS
to TO
ultimately RB
deliver VB
PowerRatankba NNP
. .

The DT
timeline NN
below IN
illustrates VBZ
the DT
exact JJ
dates NNS
of IN
campaigns NNS
where WRB
we PRP
are VBP
aware JJ
of IN
them PRP
. .

Where WRB
exact JJ
dates NNS
are VBP
unknown JJ
, ,
we PRP
based VBN
estimates NNS
on IN
first JJ
campaign NN
observations NNS
and CC
metadata NNS
( (
Fig NNP
. .

2 CD
) )
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
5 CD

Figure NN
2 CD
: :
Timeline NN
of IN
campaigns NNS
ultimately RB
related VBN
to TO
PowerRatankba VB
PowerSpritz NN
PowerSpritz NNP
is VBZ
a DT
Windows NNP
executable NN
that WDT
hides VBZ
both DT
its PRP$
legitimate NN
payload NN
and CC
malicious JJ
PowerShell NNP
command NN
using VBG
a DT
non-standard JJ
implementation NN
of IN
the DT
already RB
rarely RB
used VBN
Spritz NNP
encryption NN
algorithm NN
( (
see VB
the DT
Attribution NNP
section NN
for IN
additional JJ
analysis NN
of IN
the DT
Spritz NNP
implementation NN
) )
. .

This DT
malicious JJ
downloader NN
has VBZ
been VBN
observed VBN
being VBG
delivered VBN
via IN
spearphishing VBG
attacks NNS
using VBG
the DT
TinyCC NNP
link NN
shortener NN
service NN
to TO
redirect VB
to TO
likely JJ
attacker-controlled JJ
servers NNS
hosting VBG
the DT
malicious JJ
PowerSpritz NNP
payload NN
. .

In IN
early RB
July NNP
2017 CD
an DT
individual NN
on IN
Twitter NNP
shared VBD
an DT
attack NN
they PRP
observed VBD
targeting VBG
them PRP
( (
Fig NNP
. .

3 LS
) )
utilizing VBG
a DT
fake JJ
Skype NNP
update NN
lure NN
to TO
trick VB
users NNS
into IN
clicking VBG
on IN
a DT
link NN
to TO
hxxps VB
: :
//skype.2 NN
[ NN
. .
] JJ
vu/1 NN
. .

The DT
TinyCC NNP
link NN
redirected VBN
to TO
a DT
server NN
that IN
, ,
at IN
the DT
time NN
, ,
would MD
have VB
likely RB
returned VBN
a DT
PowerSpritz NNP
payload NN
: :
hxxp NN
: :
//201.211.183 JJ
[ NN
. .

] $
215:8080/ CD
update.php NN
? .
t=Skype NN
& CC
r=update NN
Figure NN
3 CD
: :
PowerSpritz NN
spearphishing VBG
email NN
shared VBN
on IN
Twitter NNP
by IN
@ NNP
LeoAW NNP
, ,
abusing VBG
Skype NNP
name NN
and CC
branding NN

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
6 CD
We PRP
have VBP
since IN
discovered VBN
three CD
additional JJ
TinyCC NNP
URLs NNP
utilized VBD
to TO
spread VB
PowerSpritz NNP
: :
one NN
with IN
a DT
Telegram NNP
theme NN
( (
hxxp NN
: :
// NN
telegramupdate.2 NN
[ NN
. .

] NN
vu/5 SYM
- :
> JJ
hxxp NN
: :
//122.248.34 JJ
[ NN
. .

] $
23/lndex.php CD
? .
t=Telegram NN
& CC
r=1.1.9 NN
) )
and CC
two CD
more JJR
with IN
Skype NNP
theme NN
( (
hxxp NN
: :
//skypeupdate.2 JJ
[ NN
. .

] NN
vu/1 SYM
- :
> JJ
hxxp NN
: :
//122.248.34 JJ
[ NN
. .

] $
23/lndex.php CD
? .
t=SkypeSetup NN
& CC
r=mail_new NN
and CC
hxxp NN
: :
//skype.2 JJ
[ NN
. .

] NN
vu/k NN
- :
> NN
unknown JJ
) )
. .

Some DT
of IN
the DT
PowerSpritz NNP
payloads NNS
were VBD
previously RB
hosted VBN
on IN
Google NNP
Drive NNP
; :
however RB
, ,
we PRP
were VBD
unable JJ
to TO
determine NN
if IN
that DT
service NN
was VBD
actually RB
used VBN
to TO
spread VB
the DT
payloads NNS
in-the-wild JJ
( (
ITW NNP
) )
. .

PowerSpritz NNP
decrypts VBZ
a DT
legitimate JJ
Skype NN
or CC
Telegram NNP
installer NN
using VBG
a DT
custom NN
Spritz NNP
implementation NN
with IN
the DT
key JJ
“ NNP
Znxkai NNP
@ NN
if8qa9w9489 NN
” NN
. .

PowerSpritz NNP
then RB
writes VBZ
the DT
legitimate JJ
installer NN
to TO
disk VB
in IN
the DT
directory NN
returned VBN
by IN
GetTempPathA NNP
either CC
as IN
a DT
hardcoded JJ
filename NN
such JJ
as IN
SkypeSetup.exe NNP
or CC
, ,
in IN
some DT
versions NNS
, ,
as IN
the DT
filename NN
returned VBN
by IN
GetTempFileNameA NNP
. .

The DT
installer NN
is VBZ
then RB
executed VBN
to TO
trick VB
the DT
potential JJ
victim NN
into IN
thinking VBG
they PRP
downloaded VBD
a DT
legitimate JJ
, ,
working VBG
application NN
installer NN
or CC
update NN
. .

Finally RB
, ,
Spritz NNP
uses VBZ
the DT
same JJ
key NN
to TO
decrypt VB
a DT
PowerShell NNP
command NN
that WDT
downloads VBZ
the DT
first JJ
stage NN
of IN
PowerRatankba NNP
( (
Fig NNP
. .

4 CD
) )
. .

All DT
three CD
PowerSpritz NNP
samples VBZ
we PRP
discovered VBD
executed VBD
the DT
identical JJ
PowerShell NNP
command NN
. .

Figure NN
4 CD
: :
Script NN
output NN
showing VBG
PowerSpritz NNP
PowerShell NNP
encoded VBD
and CC
decoded VBD
command NN
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
7 CD
As IN
shown VBN
in IN
the DT
above NN
decoded VBD
script NN
( (
Fig NNP
. .

4 CD
) )
, ,
PowerSpritz NNP
attempts VBZ
to TO
retrieve VB
a DT
payload NN
from IN
hxxp NN
: :
//dogecoin NN
. .

deaftone NN
[ NN
. .

] NN
com:8080/mainls.cs NN
that WDT
is VBZ
expected VBN
to TO
be VB
a DT
Base64-encoded JJ
PowerShell NNP
script NN
. .

After IN
decoding VBG
mainls.cs NN
, ,
a DT
PowerRatankba.A NNP
implant NN
is VBZ
revealed VBN
( (
Fig NNP
. .

5 CD
) )
with IN
hxxp NN
: :
//vietcasino.linkpc JJ
[ NN
. .

] RB
net:8080/search.jsp RB
as IN
its PRP$
command NN
and CC
control NN
( (
C NNP
& CC
C NNP
) )
. .

Figure NN
5 CD
: :
PowerSpritz NN
retrieving VBG
Base64-encoded NNP
PowerRatankba NNP
Windows NNS
Shortcut NNP
( (
LNK NNP
) )
A DT
LNK NNP
masquerading NN
as IN
a DT
PDF NNP
document NN
was VBD
discovered VBN
on IN
an DT
antivirus NN
scanning VBG
service NN
. .

The DT
malicious JJ
“ NN
Scanned VBD
Document NNP
Part NNP
1.pdf.lnk CD
” NN
LNK NNP
file NN
, ,
along IN
with IN
a DT
corrupted JJ
PDF NNP
named VBD
“ NNP
Scanned NNP
Document NNP
Part NNP
2.pdf CD
, ,
” NNS
were VBD
compressed VBN
in IN
a DT
ZIP NNP
file NN
named VBN
“ NNP
Scanned NNP
Documents.zip NNP
” NN
( (
Fig NNP
. .

6 CD
) )
. .

It PRP
is VBZ
unclear JJ
if IN
the DT
PDF NNP
document NN
was VBD
tampered VBN
with IN
intentionally RB
to TO
increase VB
the DT
chances NNS
a DT
target NN
would MD
open VB
the DT
malicious JJ
LNK NNP
or CC
if IN
the DT
actor NN
( (
s PRP
) )
unintentionally RB
used VBD
a DT
corrupted JJ
document NN
. .

We PRP
currently RB
are VBP
not RB
aware NN
of IN
how WRB
the DT
LNK NNP
or CC
compressed VBN
ZIP JJ
files NNS
were VBD
utilized JJ
ITW NNP
. .

The DT
malicious JJ
LNK NNP
uses VBZ
a DT
known JJ
AppLocker NNP
bypass NN
to TO
retrieve VB
its PRP$
payload NN
from IN
a DT
TinyURL NNP
shortener NN
link NN
hxxp NN
: :
//tinyurl JJ
[ NN
. .

] NN
com/y9jbk8cg NN
( (
Fig NNP
. .

7 CD
) )
. .

This DT
shortener NN
previously RB
redirected VBN
to TO
hxxp VB
: :
//201.211.183 NN
[ NN
. .

] $
215:8080/ CD
pdfviewer.php NN
? .
o=0 NN
& CC
t=report NN
& CC
m=0 NN
. .

At IN
the DT
time NN
of IN
analysis NN
the DT
C NNP
& CC
C NNP
server NN
was VBD
no RB
longer JJR
returning VBG
payloads NNS
. .

However RB
, ,
the DT
same JJ
IP NNP
was VBD
used VBN
in IN
the DT
PowerSpritz NNP
campaigns NNS
. .

Based VBN
on IN
the DT
same JJ
C NNP
& CC
C NNP
usage NN
and CC
similar JJ
URI NNP
structure NN
, ,
we PRP
assess VBP
with IN
low JJ
confidence NN
that IN
the DT
LNK NNP
campaign NN
would MD
have VB
delivered VBN
PowerRatankba NNP
via IN
PowerSpritz NNP
. .

Figure NN
6 CD
: :
ZIP NN
file NN
with IN
decompressed JJ
malicious JJ
LNK NNP
and CC
corrupted VBD
PDF NNP

Figure NN
7 CD
: :
Malicious JJ
LNK NNP
AppLocker NNP
bypass NN
to TO
retrieve VB
payload NN
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
8 CD
Microsoft NNP
Compiled NNP
HTML NNP
Help NNP
( (
CHM NNP
) )
Several JJ
malicious JJ
CHM NNP
files NNS
were VBD
uploaded VBN
to TO
a DT
multi NN
antivirus NN
scanning VBG
service NN
in IN
October NNP
, ,
November NNP
, ,
and CC
December NNP
. .

We PRP
inspected VBN
the DT
compressed JJ
ZIP NNP
metadata NN
to TO
better JJR
understand VB
the DT
likely JJ
chronological JJ
order NN
in IN
which WDT
the DT
CHMs NNP
were VBD
used VBN
. .

Unfortunately RB
we PRP
have VBP
been VBN
unable JJ
to TO
determine VB
how WRB
these DT
infection NN
attempts NNS
were VBD
delivered VBN
to TO
victims NNS
ITW NNP
. .

The DT
themes NNS
of IN
the DT
malicious JJ
CHMs NNP
include NN
: :
• VB
A DT
confusing NN
, ,
poorly RB
written VBN
request NN
for IN
assistance NN
with IN
creating VBG
a DT
website NN
with IN
possible JJ
romantic JJ
undertones NNS
( (
Fig NNP
. .

8-1 CD
) )
• JJ
Documentation NNP
on IN
a DT
blockchain NN
technology NN
called VBN
ALCHAIN NNP
from IN
Orient NNP
Exchange NNP
Co. NNP
( (
Fig NNP
. .

8-2 CD
) )
• VB
A DT
request NN
for IN
assistance NN
in IN
developing VBG
an DT
initial JJ
coin NN
offering NN
( (
ICO NNP
) )
platform NN
( (
Fig NNP
. .

8-3 CD
) )
• JJ
White NNP
paper NN
on IN
the DT
Falcon NNP
Coin NNP
ICO NNP
( (
Fig NNP
. .

8-4 CD
) )
• VB
A DT
request NN
for IN
applications NNS
to TO
develop VB
a DT
cryptocurrency NN
exchange NN
platform NN
( (
Fig NNP
. .

8-5 CD
) )
• VB
A DT
request NN
for IN
assistance NN
in IN
creating VBG
an DT
email NN
marketing NN
tool NN
( (
Fig NNP
. .

8-6 CD
) )

Figure NN
8 CD
: :
CHM NN
lures VBZ
utilized VBN
in IN
attempts NNS
to TO
deliver VB
PowerRatankba NNP
All DT
of IN
the DT
CHM NNP
files NNS
use VBP
a DT
well-known JJ
technique NN
to TO
create VB
a DT
shortcut NN
object NN
capable JJ
of IN
executing VBG
malicious JJ
code NN
and CC
then RB
causing VBG
that IN
shortcut NN
object NN
to TO
be VB
automatically RB
clicked VBN
via IN
the DT
“ NNP
x.Click NNP
( (
) )
; :
” JJ
function NN
. .

Two CD
different JJ
methods NNS
were VBD
used VBN
across IN
the DT
CHMs NNP
to TO
retrieve VB
the DT
malicious JJ
payload NN
. .

The DT
first JJ
method NN
uses VBZ
a DT
VBScript NNP
Execute NNP
command NN
and CC
BITSAdmin NNP
tool NN
to TO
download VB
a DT
malicious JJ
VBScript NNP
file NN
( (
Fig NNP
. .

9 CD
) )
. .

The DT
payload NN
is VBZ
downloaded VBN
( (
Fig NNP
. .

10 CD
) )
from IN
hxxp NN
: :
//www.businesshop NN
[ NN
. .

] JJ
net/hide.gif NN
and CC
saved VBD
to TO
C NNP
: :
\windows\temp\ NN
PowerOpt.vbs NNP
. .

Once RB
the DT
downloaded JJ
VBScript NNP
( (
Fig NNP
. .

10 CD
) )
is VBZ
executed VBN
, ,
it PRP
will MD
attempt VB
to TO
download VB
PowerRatankba NNP
from IN
hxxp NN
: :
//158.69.57 JJ
[ NN
. .

] RB
135/theme.gif CD
, ,
saving VBG
the DT
expected VBN
PowerShell NNP
script NN
to TO
C NNP
: :
\Users\Public\Pictures\opt.ps1 NN
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
9 CD
Figure NN
9 CD
: :
Malicious JJ
code NN
embedded VBN
in IN
CHM NNP
to TO
download VB
a DT
VBScript NNP
PowerRatankba NNP
downloader NN
Figure NN
10 CD
: :
BITSAdmin NNP
retrieving VBG
malicious JJ
payload NN
over IN
HTTP NNP
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
10 CD
Figure NN
10 CD
: :
BITSAdmin NNP
retrieving VBG
malicious JJ
payload NN
over IN
HTTP NNP
The DT
second JJ
method NN
downloads VBZ
a DT
similar JJ
VBScript-based JJ
PowerRatankba NNP
downloader NN
using VBG
PowerShell NNP
directly RB
in IN
the DT
CHM NNP
( (
Fig NNP
. .

11 CD
) )
. .

A DT
similar JJ
VBScript NNP
Execute NNP
command NN
is VBZ
utilized VBN
to TO
call VB
PowerShell NNP
’ NNP
s VBD
DownloadString VBG
to TO
execute VB
the DT
payload NN
directly RB
from IN
hxxp NN
: :
//92.222.106 JJ
[ NN
. .

] $
229/theme.gif CD
Figure NN
11 CD
: :
PowerShell NNP
utilized VBD
in IN
CHM NNP
to TO
retrieve VB
PowerRatankba NNP
downloader NN
VBS NNP
The DT
5_6283065828631904327.chm CD
( (
030b4525558f2c411f972d91b144870b388380b59372e1798926cc2958242863 CD
) )
contains NNS
notable JJ
pieces NNS
of IN
unused JJ
code NN
as RB
well RB
as IN
code NN
pointing VBG
to TO
an DT
RFC1918 NNP
private JJ
IP NNP
address NN
in IN
the DT
decompressed JJ
doc.htm NN
file NN
( (
Fig NNP
. .

12 CD
) )
. .

The DT
first JJ
excerpt NN
of IN
unused JJ
code NN
consists VBZ
of IN
a DT
more RBR
traditional JJ
PowerShell NNP
command NN
that WDT
downloads VBZ
a DT
script NN
from IN
hxxp NN
: :
//192.168.102 JJ
[ NN
. .
] $
21/power.ps1 CD
. .

The DT
next JJ
block NN
of IN
code NN
adds VBZ
an DT
obfuscation NN
technique NN
( (
also RB
present VBP
in IN
other JJ
related JJ
CHMs NNP
) )
where WRB
the DT
quotes NNS
are VBP
replaced VBN
with IN
the DT
“ NNP
* NNP
” NNP
character NN
. .

This DT
obfuscated VBD
code NN
downloads VBZ
a DT
PowerShell NNP
payload NN
from IN
the DT
same JJ
RFC1918 NNP
address NN
but CC
from IN
a DT
different JJ
URI NN
: :
hxxp NN
: :
//192.168.102 JJ
[ NN
. .
] $
21/pso.ps1 CD
. .

We PRP
assess VBP
that IN
this DT
is VBZ
likely JJ
a DT
remnant NN
of IN
the DT
author NN
developing VBG
the DT
malicious JJ
CHM NNP
method NN
using VBG
their PRP$
local JJ
environment NN
rather RB
than IN
using VBG
code NN
stolen VBN
from IN
an DT
unrelated JJ
CHM NNP
, ,
tool NN
, ,
or CC
other JJ
malicious JJ
payload NN
. .

Additionally RB
, ,
another DT
piece NN
of IN
commented JJ
code NN
follows VBZ
which WDT
executes VBZ
a DT
VBScript NNP
file NN
“ NNP
C NNP
: :
\Users\dolphinePC\Downloads\run_32.vbs JJ
” NN
. .

This DT
may MD
offer VB
another DT
clue NN
to TO
the DT
developer NN
’ NNP
s NN
environment NN
that WDT
has VBZ
a DT
possible JJ
username NN
of IN
dolphinePC NN
. .

Finally RB
, ,
a DT
PowerRatankba.B NNP
implant NN
was VBD
embedded VBN
in IN
the DT
same JJ
CHM NNP
as IN
aa.ps1 NN
and CC
configured VBN
with IN
C NNP
& CC
C NNP
servers NNS
of IN
92.222.106 CD
[ NNS
. .

] $
229 CD
and CC
158.69.57 CD
[ NN
. .
] $
135 CD
. .

Figure NN
12 CD
: :
Leftover NN
code NN
in IN
5_6283065828631904327.chm CD
As IN
a DT
final JJ
note NN
on IN
the DT
CHM NNP
campaigns NNS
, ,
the DT
following JJ
three CD
samples NNS
contain VBP
an DT
email NN
address NN
of IN
either CC
robert_mobile JJ
@ NN
gmail NN
[ NN
. .

] JJ
com NN
or CC
robert_mobile NN
@ JJ
mail NN
[ NN
. .

] NN
com NN
, ,
which WDT
we PRP
assess VBP
with IN
some DT
confidence NN
are VBP
related VBN
to TO
the DT
threat NN
actor NN
: :
• $
772b9b873100375c9696d87724f8efa2c8c1484853d40b52c6dc6f7759f5db01 CD
• $
6cb1e9850dd853880bbaf68ea23243bac9c430df576fa1e679d7f26d56785984 CD
• $
9d10911a7bbf26f58b5e39342540761885422b878617f864bfdb16195b7cd0f5 CD
JavaScript NN
Downloaders NNS
Throughout IN
November NNP
several JJ
compressed VBD
ZIP NNP
files NNS
containing VBG
a DT
JavaScript NNP
( (
JS NNP
) )
downloader NN
were VBD
observed VBN
being VBG
hosted VBN
on IN
likely JJ
attacker-controlled JJ
servers NNS
. .

We PRP
are VBP
not RB
currently RB
aware JJ
if IN
or CC
how WRB
these DT
files NNS
were VBD
delivered VBN
to TO
potential JJ
victims NNS
. .

The DT
naming NN
of IN
the DT
files NNS
and CC
the DT
decoy NN
PDF NNP
documents NNS
they PRP
retrieve VBP
provide VB
some DT
clues NNS
about IN
the DT
nature NN
of IN
the DT
lures NNS
. .

Themes NNS
include VBP
the DT
cryptocurrency NN
exchanges NNS
Coinbase NNP
and CC
Bithumb NNP
, ,
the DT
Falcon NNP
Coin NNP
ICO NNP
, ,
and CC
a DT
list NN
of IN
Bitcoin NNP
transactions NNS
. .

Each DT
JavaScript NNP
downloader NN
is VBZ
obfuscated VBN
( (
Fig NNP
. .

13 CD
) )
using VBG
JavaScript NNP
Obfuscator NNP
( (
see VB
Attribution NNP
section NN
for IN
additional JJ
analysis NN
) )
or CC
a DT
similar JJ
tool NN
. .

After IN
de-obfuscating NN
( (
Fig NNP
. .

14 CD
) )
, ,
the DT
logic NN
of IN
the DT
malicious JJ
downloader NN
is VBZ
very RB
straightforward RB
. .

First RB
, ,
an DT
obfuscated JJ
PowerRatankba.B NNP
PowerShell NNP
script NN
is VBZ
downloaded VBN
from IN
a DT
fake JJ
image NN
URL NNP
such JJ
as IN
: :
hxxp NN
: :
//51.255.219 JJ
[ NN
. .

] $
82/ CD
theme.gif NN
. .

Next RB
, ,
the DT
PowerShell NNP
script NN
is VBZ
saved VBN
to TO
C NNP
: :
\Users\Public\Pictures\opt.ps1 NN
and CC
then RB
executed VBD
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
11 CD
Figure NN
13 CD
: :
Obfuscated VBN
falconcoin.js NN
Figure NN
14 CD
: :
Deobfuscated VBN
falconcoin.js NN
revealing VBG
PowerRatankba NNP
and CC
decoy VB
PDF NNP
URLs NNP
The DT
last JJ
step NN
in IN
execution NN
is VBZ
to TO
retrieve VB
the DT
decoy NN
PDF NNP
from IN
hxxp NN
: :
//51.255.219 JJ
[ NN
. .

] $
82/files/download/falconcoin.pdf CD
and CC
open VB
it PRP
using VBG
rundll32.exe JJ
and CC
shell32.dll JJ
, ,
OpenAs_RunDLL NNP
( (
Fig NNP
. .

15-1 JJ
) )
. .

Samples NNS
using VBG
Coinbase NNP
and CC
Bithumb NNP
themes NNS
also RB
downloaded VBN
PDF NNP
decoys NNS
( (
Fig NNP
. .

15-2,15-3 JJ
) )
. .

Additionally RB
we PRP
discovered VBD
that IN
the DT
content NN
from IN
the DT
Coinbase NNP
decoy NN
has VBZ
been VBN
used VBN
in IN
Lazarus NNP
group-attributed JJ
espionage NN
campaigns NNS
( (
see VB
Attribution NNP
for IN
more JJR
details NNS
) )
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
12 CD
Figure NN
15 CD
: :
Decoys NNP
downloaded VBD
or CC
sent VBD
along IN
with IN
PowerRatankba NNP
JavaScript NNP
downloaders NNS
VBScript NNP
Macro NNP
Microsoft NNP
Office NNP
Documents NNS
Two CD
VBScript NNP
macro-laden JJ
Microsoft NNP
Office NNP
documents NNS
have VBP
been VBN
observed VBN
associated VBN
with IN
this DT
activity NN
: :
one CD
Word NN
document NN
and CC
one CD
Excel NNP
spreadsheet NN
. .

The DT
Word NNP
document NN
( (
b3235a703026b2077ccfa20b3dabd82d65c6b5645f7f1 NN
5e7bbad1ce8173c7960 CD
) )
uses VBZ
an DT
Internal NNP
Revenue NNP
Service NNP
( (
IRS NNP
) )
theme NN
and CC
was VBD
sent VBN
as IN
an DT
attachment NN
named VBN
“ NNP
report NN
phishing.doc NN
” NN
. .

The DT
spearphishing VBG
email NN
was VBD
sent VBN
from IN
an DT
@ JJ
mail.com NN
address NN
with IN
the DT
subject NN
of IN
“ NN
Phishing VBG
Warnning NNP
” NNP
[ NNP
sic JJ
] NN
. .

Ironically RB
, ,
the DT
sender NN
email NN
address NN
was VBD
spoofed VBN
as IN
phishing VBG
@ JJ
irs.gov NN
( (
Fig NNP
. .

16 CD
) )
while IN
the DT
content NN
of IN
the DT
lure NN
( (
Fig NNP
. .

17 CD
) )
was VBD
likely RB
copied VBN
from IN
an DT
official JJ
IRS NNP
webpage NN
. .

Figure NN
16 CD
: :
Spearphishing VBG
email NN
spoofed NN
sender NN
and CC
subject JJ
Figure NN
17 CD
: :
IRS NNP
themed VBD
Word NNP
document NN
PowerRatankba NNP
downloader NN
The DT
IRS-themed NNP
malicious JJ
document NN
uses VBZ
a DT
macro NN
to TO
download VB
a DT
PowerRatankba NNP
VBScript NNP
from IN
hxxp NN
: :
//198.100.157 JJ
[ NN
. .

] RB
239/hide.gif CD
( (
Fig NNP
. .

18 CD
) )
, ,
save VBP
it PRP
to TO
C NNP
: :
\ NN
Users\Public\Pictures\opt.vbs NNP
, ,
and CC
execute VB
it PRP
with IN
wscript NN
. .

exe NN
. .

It PRP
in IN
turn NN
downloads VBZ
the DT
PowerRatankba.B NNP
from IN
hxxp NN
: :
//198.100.157 JJ
[ NN
. .

] RB
239/theme.gif CD
, ,
saving VBG
the DT
downloaded JJ
payload NN
to TO
C NNP
: :
\Users\Public\Pictures\opt.ps1 NN
, ,
and CC
finally RB
executing VBG
it PRP
with IN
powershell.exe NN
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
13 CD
Figure NN
18 CD
: :
IRS-themed JJ
malicious JJ
document NN
macro NN
The DT
second JJ
malicious JJ
Office NNP
document NN
we PRP
discovered VBD
is VBZ
an DT
Excel NNP
spreadsheet NN
named VBD
bithumb.xls NN
. .

It PRP
uses VBZ
a DT
Bithumb NNP
lure NN
( (
Fig NNP
. .

19 CD
) )
and CC
includes VBZ
stolen VBN
branding NN
. .

The DT
spreadsheet NN
was VBD
found VBN
compressed VBN
in IN
a DT
ZIP NNP
file NN
named VBN
Bithumb.zip NNP
along IN
with IN
a DT
decoy JJ
PDF NNP
document NN
named VBN
“ NN
About IN
Bithumb.pdf NNP
” NNP
( (
Fig NNP
. .

20 CD
) )
. .

Figure NN
19 CD
: :
Malicious JJ
Bithumb NNP
Excel NNP
spreadsheet NN
with IN
English NNP
option NN
shown VBN
, ,
with IN
stolen VBN
branding NN
Figure NN
20 CD
: :
“ NN
About IN
Bithumb.pdf NNP
decoy NN
” NNP
document NN
inside RB
Bithumb.zip NNP
archive JJ
, ,
with IN
stolen VBN
branding NN
The DT
Excel NNP
spreadsheet NN
contains VBZ
a DT
macro NN
with IN
an DT
embedded JJ
Base64-encoded JJ
PowerRatankba NNP
VBScript NNP
downloader NN
( (
rather RB
than IN
retrieving VBG
it PRP
from IN
a DT
C NNP
& CC
C NNP
using VBG
HTTP NNP
( (
Fig NNP
. .

21 CD
) )
) )
. .

The DT
embedded JJ
VBScript NNP
is VBZ
first RB
dropped VBN
to TO
disk VB
at IN
c NN
: :
\Users\ NN
Public\Documents\Proxy.vbs NNP
and CC
then RB
executed VBD
using VBG
wscript.exe NN
. .

The DT
dropped JJ
VBScript NNP
file NN
is VBZ
configured VBN
to TO
download VB
PowerRatankba NN
from IN
hxxp NN
: :
//www.energydonate NN
[ NN
. .

] NNS
com/images/character.gif VBP
while IN
saving VBG
the DT
downloaded JJ
payload NN
to TO
C NNP
: :
\ NN
Users\Public\Documents\ProxyAutoUpdate.ps1 NNP
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
14 CD
Figure NN
21 CD
: :
Base64 NNP
encoded VBD
PowerRatankba NNP
downloader NN
embedded VBD
in IN
bithumb.xls NN
Backdoored NNP
PyInstaller NNP
Applications NNP
Most JJS
recently RB
, ,
several JJ
large JJ
email NN
phishing NN
campaigns NNS
attempted VBD
to TO
trick VB
unsuspecting JJ
victims NNS
into IN
visiting VBG
fake JJ
webpages NNS
to TO
download VB
or CC
update VB
cryptocurrency NN
applications NNS
. .

The DT
copycat NN
websites NNS
were VBD
mirror JJ
images NNS
of IN
legitimate JJ
websites NNS
with IN
software NN
download NN
links VBZ
pointing VBG
to TO
the DT
correct JJ
installers NNS
hosted VBN
on IN
the DT
legitimate JJ
websites NNS
. .

The DT
only JJ
exception NN
was VBD
the DT
link NN
to TO
download VB
the DT
Windows NNP
version NN
of IN
the DT
application NN
, ,
which WDT
was VBD
hosted VBN
on IN
the DT
copycat NN
websites VBZ
. .

These DT
PyInstaller NNP
executables NNS
were VBD
backdoored VBN
with IN
a DT
few JJ
lines NNS
of IN
Python NNP
code NN
added VBD
to TO
download VB
the DT
PowerRatankba NNP
implant NN
. .

The DT
first JJ
campaign NN
that WDT
utilized VBD
this DT
technique NN
used VBD
a DT
Bitcoin NNP
Gold NNP
( (
BTG NNP
) )
theme NN
to TO
trick VB
the DT
targets NNS
into IN
visiting VBG
an DT
internationalized VBN
domain NN
name NN
( (
IDN NNP
) )
website NN
( (
Fig NNP
. .

22 CD
) )
. .

An DT
email NN
was VBD
sent VBN
to TO
targets NNS
offering VBG
a DT
BTG NNP
wallet NN
application NN
along IN
with IN
a DT
link NN
to TO
the DT
malicious JJ
website NN
: :
hxxps NN
: :
//xn NN
-- :
bitcoingld-lcb JJ
[ NN
. .
] JJ
org/ NN
. .

However RB
, ,
web JJ
browsers NNS
and CC
email JJ
clients NNS
would MD
display VB
the DT
link NN
as IN
follows VBZ
: :
hxxps NN
: :
//bitcoingöld JJ
[ NN
. .
] JJ
org/ NN
. .

Emails NNS
in IN
this DT
BTG NNP
campaign NN
were VBD
sent VBN
between IN
approximately RB
November NNP
10-16 CD
, ,
2017 CD
. .

Some DT
of IN
the DT
known VBN
sender NN
emails NNS
include VBP
but CC
are VBP
not RB
limited VBN
to TO
: :
info NN
@ NN
xn NNP
-- :
bitcoingod-8yb JJ
[ NN
. .

] NN
com NN
, ,
info NN
@ NNP
xn NNP
-- :
bitcoigold-o1b JJ
[ NN
. .

] NN
com NN
, ,
and CC
tech JJ
@ NNP
xn NNP
-- :
bitcoingld-lcb JJ
[ NN
. .
] JJ
org NN
. .

Campaigns NNS
using VBG
IDN NNP
can MD
be VB
difficult JJ
to TO
recognize VB
as IN
malicious JJ
because IN
they PRP
are VBP
typically RB
very RB
similar JJ
to TO
the DT
mimicked JJ
legitimate JJ
domains NNS
except IN
for IN
a DT
single JJ
character NN
( (
Fig NNP
. .

23 CD
) )
. .

( (
see VB
IOC NNP
section NN
for IN
more RBR
likely JJ
related JJ
IDNs NNP
) )
Figure NN
22 CD
: :
Sample JJ
email VBP
containing VBG
a DT
URL NNP
to TO
malicious VB
IDN NNP
hosting VBG
PyInstaller NNP
PowerRatankba NNP
downloader NN
. .

The DT
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
15 CD
IDN NNP
email NN
address NN
is VBZ
emphasized VBN
in IN
a DT
red JJ
box NN
. .

Figure NN
23 CD
: :
Excerpt NN
from IN
phishing VBG
email NN
showing VBG
the DT
IDN NNP
link NN
with IN
red JJ
arrow NN
pointing VBG
to TO
internationalized VBN
character NN
Many JJ
thanks NNS
to TO
Yonathan VB
Klijnsma NNP
( (
@ NNP
ydklijnsma NNP
) )
of IN
RiskIQ NNP
, ,
whose WP$
assistance NN
allowed VBD
us PRP
to TO
analyze VB
a DT
historical JJ
scrape NN
of IN
one CD
of IN
the DT
web NN
pages NNS
hosting VBG
the DT
malware NN
at IN
xn NNP
-- :
bitcoingld- JJ
lcb NN
[ NN
. .
] JJ
org NN
. .

In IN
the DT
scrape NN
, ,
an DT
additional JJ
text NN
and CC
a DT
button NN
were VBD
inserted VBN
in IN
place NN
of IN
the DT
BTG NNP
logo NN
. .

The DT
button NN
used VBN
JavaScript NNP
to TO
download NN
a DT
payload NN
from IN
hxxps NN
: :
//bitcoingöld JJ
[ NN
. .
] JJ
org/bitcoingold NN
. .

exe NN
( (
IDN NNP
: :
xn NN
-- :
bitcoingld-lcb JJ
[ NN
. .

] JJ
org NN
) )
( (
Fig NNP
. .

24 CD
) )
. .

Additional JJ
differences NNS
are VBP
likely JJ
the DT
result NN
of IN
changes NNS
to TO
the DT
legitimate JJ
website NN
( (
Fig NNP
. .

25 CD
) )
since IN
the DT
malicious JJ
campaign NN
. .

Figure NN
24 CD
: :
Malicious JJ
BTG NNP
website NN
hosting NN
PowerRatankba NNP
downloader NN
. .

Credit NN
: :
RiskIQ NN
Figure NN
25 CD
: :
Legitimate JJ
BTG NNP
website NN
showing VBG
difference NN
between IN
legitimate JJ
and CC
malicious JJ
websites NNS
( (
note NN
: :
this DT
screenshot NN
was VBD
not RB
taken VBN
on IN
the DT
same JJ
day NN
as IN
the DT
screenshot NN
of IN
the DT
malicious JJ
website NN
) )
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
16 CD
Once RB
clicked VBN
, ,
the DT
button NN
on IN
the DT
malicious JJ
BTG NNP
page NN
would MD
have VB
directed VBN
a DT
victim NN
to TO
download VB
a DT
payload NN
from IN
hxxps NN
: :
//bitcoingöld JJ
[ NN
. .
] JJ
org/bitcoingold.exe NN
. .

At IN
the DT
time NN
of IN
our PRP$
analysis NN
, ,
this DT
URL NNP
was VBD
not RB
returning VBG
content NN
. .

However RB
, ,
we PRP
discovered VBD
from IN
a DT
comment NN
on IN
a DT
multiple JJ
anti-virus JJ
scanning NN
service NN
that IN
someone NN
targeted VBD
by IN
this DT
campaign NN
had VBD
uploaded VBN
a DT
payload NN
downloaded VBN
from IN
the DT
fake JJ
website NN
. .

The DT
file NN
in IN
that DT
case NN
was VBD
named VBN
ElectronGold-1.1.1.exe NNP
( (
eab612e333baaec0709f3f213f73388607e495d8af9a2851f352481e996283f1 NN
) )
. .

We PRP
also RB
found VBD
a DT
similar JJ
payload NN
with IN
unknown JJ
origin NN
named VBN
ElectronGold-1.1.exe NNP
( (
b530de08530d1ba19a94bc075e74e2236c106466dedc92be3abdee9908e8cf7e NN
) )
. .

The DT
second JJ
campaign NN
we PRP
discovered VBD
used VBD
a DT
fake JJ
Electrum NNP
update NN
as IN
the DT
lure NN
to TO
similarly RB
direct JJ
victims NNS
to TO
a DT
malicious JJ
IDN NN
resembling VBG
the DT
legitimate JJ
electrum.org NN
website NN
( (
Fig NNP
. .

26 CD
) )
. .

The DT
emails NNS
in IN
this DT
case NN
were VBD
sent VBN
, ,
based VBN
on IN
our PRP$
visibility NN
, ,
using VBG
a DT
unique JJ
@ NNP
mail.com NN
email NN
address NN
for IN
each DT
recipient NN
, ,
and CC
at IN
least JJS
some DT
of IN
the DT
emails NNS
were VBD
sent VBN
between IN
November NNP
18-21 CD
, ,
2017 CD
. .

A DT
subject NN
of IN
“ NNP
New NNP
Electrum NNP
Wallet NNP
Released VBD
” NNP
was VBD
used VBN
to TO
trick VB
victims NNS
into IN
thinking VBG
that IN
they PRP
needed VBD
to TO
download VB
an DT
update NN
for IN
Electrum NNP
to TO
be VB
able JJ
to TO
use VB
Segwit2X NNP
and CC
Bitcoin NNP
Gold NNP
. .

If IN
a DT
victim NN
clicked VBN
on IN
the DT
malicious JJ
link NN
, ,
they PRP
were VBD
presented VBN
with IN
what WP
appeared VBD
to TO
be VB
a DT
normal JJ
version NN
of IN
Electrum NNP
’ NNP
s VBZ
official JJ
website NN
( (
Fig NNP
. .

27 CD
) )
. .

Figure NN
26 CD
: :
Phishing VBG
email NN
with IN
fake JJ
Electrum NN
wallet NN
application NN
update JJ
announcement NN
Figure NN
27 CD
: :
A DT
fake JJ
website NN
with IN
links NNS
to TO
backdoored VB
installation NN
packages NNS
highlighted VBN
in IN
red JJ
boxes NNS
and CC
internationalized JJ
character NN
noted VBN
by IN
red JJ
arrow NN
Each DT
of IN
the DT
links NNS
highlighted VBN
in IN
red JJ
led VBD
to TO
a DT
malicious JJ
payload NN
hosted VBN
directly RB
on IN
the DT
same JJ
server NN
: :
hxxps NN
: :
//xn NN
-- :
electrm- JJ
s2a NN
[ NN
. .

] JJ
org/electrum-3.0.3.exe NN
( (
Fig NNP
. .

28 CD
) )
. .

The DT
electrum-3.0.3.exe NN
is VBZ
a DT
backdoored JJ
PyInstaller NNP
that WDT
is VBZ
configured VBN
to TO
download VB
a DT
VBScript NNP
PowerRatankba NNP
downloader NN
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
17 CD
Figure NN
28 CD
: :
HTML NNP
code NN
from IN
malicious JJ
Electrum NNP
webpage NN

In IN
both DT
campaigns NNS
, ,
the DT
same JJ
malicious JJ
Python NNP
code NN
was VBD
injected VBN
into IN
the DT
PyInstallers NNPS
, ,
specifically RB
into IN
\gui\qt\installwizard NNP
. .

py NN
. .

The DT
backdoor NN
code NN
in IN
each DT
campaign NN
is VBZ
nearly RB
identical JJ
except IN
for IN
the DT
target NN
URL NNP
and CC
the DT
file NN
name NN
to TO
which WDT
the DT
downloaded VBN
VBScript NNP
is VBZ
saved VBN
( (
Fig NNP
. .

29 CD
) )
. .

Figure NN
29 CD
: :
Side-by-side JJ
comparison NN
of IN
backdoored JJ
installwizard.py NN
scripts NNS
. .

Left VBN
: :
BTG NNP
, ,
Right NNP
: :
Electrum NN

The DT
BTG NNP
campaign NN
was VBD
configured VBN
to TO
download VB
a DT
VBScript NNP
from IN
hxxp NN
: :
//www.btc-gold JJ
[ NN
. .

] NNS
us/images/top_bar.gif VBP
while IN
saving VBG
the DT
downloaded JJ
script NN
to TO
C NNP
: :
\Users\Public\Documents\diff.vbs NN
. .

We PRP
were VBD
unable JJ
to TO
retrieve VB
this DT
file NN
but CC
suspect VBP
a DT
PowerRatankba NNP
variant NN
would MD
have VB
been VBN
downloaded VBN
based VBN
on IN
other JJ
campaigns NNS
. .

The DT
Electrum NNP
campaign NN
was VBD
similarly RB
configured VBN
to TO
download VB
a DT
VBScript NNP
; :
however RB
, ,
in IN
this DT
case NN
we PRP
were VBD
able JJ
to TO
analyze VB
the DT
downloaded VBN
payload NN
. .

The DT
backdoored JJ
installwizard.py NN
downloaded VBD
a DT
script NN
from IN
hxxp NN
: :
//trade.publicvm JJ
[ NN
. .

] NN
com/images/top_ NN
bar.gif NN
( (
see VB
Attribution NNP
section NN
for IN
more JJR
commentary NN
) )
while IN
saving VBG
the DT
downloaded JJ
script NN
to TO
C NNP
: :
\Users\Public\Documents\ NN
Electrum_backup.vbs NNP
. .

The DT
downloaded JJ
Electrum_backup.vbs NNP
was VBD
a DT
PowerRatankba NNP
downloader NN
with IN
a DT
target NN
URL NNP
of IN
hxxp NN
: :
//trade.publicvm JJ
[ NN
. .

] NN
com/images/character.gif NN
, ,
which WDT
ultimately RB
delivered VBD
a DT
PowerRatankba NNP
implant NN
with IN
a DT
C NNP
& CC
C NNP
of IN
trade NN
. .

publicvm NN
[ NN
. .
] JJ
com NN
. .

Implant JJ
Description NNP
and CC
Analysis NNP
Three CD
key JJ
implants NNS
were VBD
used VBN
at IN
various JJ
points NNS
in IN
these DT
campaigns NNS
. .

The DT
implants NNS
-- :
PowerRatankba NNP
, ,
Gh0st NNP
RAT NNP
, ,
and CC
RatankbaPOS NNP
-- :
and CC
specific JJ
variations NNS
are VBP
described VBN
in IN
detail NN
below NN
. .

PowerRatankba NNP
Description NNP
PowerRatankba NNP
is VBZ
used VBN
for IN
the DT
same JJ
purpose NN
as IN
Ratankba NNP
: :
as IN
a DT
first JJ
stage NN
reconnaissance NN
tool NN
and CC
for IN
the DT
deployment NN
of IN
further JJ
stage NN
implants NNS
on IN
targets NNS
that WDT
are VBP
deemed VBN
interesting JJ
by IN
the DT
actor NN
. .

Similar JJ
to TO
its PRP$
predecessor NN
, ,
PowerRatankba NNP
utilizes JJ
HTTP NNP
for IN
its PRP$
C NNP
& CC
C NNP
communication NN
. .

Once RB
executed VBN
, ,
PowerRatankba NNP
first RB
sends VBZ
detailed JJ
information NN
about IN
the DT
infected JJ
device NN
to TO
its PRP$
C NNP
& CC
C NNP
server NN
via IN
the DT
BaseInfo NNP
HTTP NNP
POST NNP
( (
Fig NNP
. .

30 CD
) )
, ,
including VBG
the DT
computer NN
name NN
, ,
IP NNP
address NN
( (
es NN
) )
, ,
OS NNP
boot NN
time NN
and CC
installation NN
date NN
, ,
language NN
, ,
if IN
ports NNS
139 CD
, ,
3389 CD
, ,
and/or VBZ
445 CD
are VBP
open/closed/filtered VBN
, ,
a DT
process NN
list NN
, ,
and CC
( (
PowerRatankba.B NNP
only RB
) )
output NN
from IN
two CD
WMIC NNS
commands NNS
( (
Fig NNP
. .

31 CD
) )
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
18 CD
Figure NN
30 CD
: :
Initial JJ
HTTP NNP
POST NNP
containing NN
infected VBD
device NN
information NN
to TO
PowerRatankba.A NNP
C NNP
& CC
C NNP
Figure NN
31 CD
: :
WMIC NNP
command NN
output NN
sent VBD
via IN
same JJ
initial JJ
HTTP NNP
POST NNP
There EX
are VBP
only RB
slight JJ
variations NNS
between IN
the DT
initial JJ
BaseInfo NNP
HTTP NNP
POST NNP
, ,
such JJ
as IN
the DT
process NN
list NN
is VBZ
retrieved VBN
by IN
PowerRatankba.A NNP
using VBG
“ JJ
tasklist NN
/svc NNP
” NNP
while IN
PowerRatankba.B NNP
uses VBZ
just RB
“ JJ
tasklist NN
” NN
. .

PowerRatankba.A NNP
C NNP
& CC
C NNP
Description NNP
After IN
the DT
initial JJ
C NNP
& CC
C NNP
check-in NN
, ,
PowerRatankba.A NNP
issues NNS
What WP
HTTP NNP
GET NNP
requests NNS
( (
Fig NNP
. .

32 LS
) )
to TO
retrieve VB
commands NNS
from IN
the DT
C NNP
& CC
C NNP
server NN
. .

All DT
PowerRatankba.A NNP
HTTP NNP
requests NNS
contain VBP
a DT
randomly RB
generated VBN
numeric JJ
UID NNP
passed VBD
in IN
the DT
u JJ
HTTP NNP
URI NNP
parameter NN
. .

Figure NN
32 CD
: :
PowerRatankba.A VB
What WP
HTTP NNP
GET NNP
Request NNP

This DT
variant JJ
receives VBZ
commands NNS
and CC
sends VBZ
responses NNS
in IN
plaintext NN
. .

This DT
variant NN
only RB
has VBZ
four CD
commands NNS
( (
Table JJ
1 CD
) )
including VBG
a DT
sleep NN
, ,
exit NN
, ,
and CC
two CD
different JJ
execute NN
code NN
functions NNS
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
19 CD
Table JJ
1 CD
: :
PowerRatankba.A NNP
C NNP
& CC
C NNP
commands NNS
Command NN
success NN
killkill NN
Execute NN
DownExec NN
Description NN
Sleep NNP
and CC
send VB
request NN
after IN
sleep NN
Exit NN
Download NNP
payload NN
from IN
provided VBN
URL NNP
and CC
execute VB
via IN
memory NN
injection NN
Download NNP
payload NN
from IN
provided VBN
URL NNP
, ,
save VBP
to TO
disk VB
, ,
then RB
execute VB

PowerRatankba.B NNP
C NNP
& CC
C NNP
Description NNP
Similar JJ
to TO
its PRP$
predecessor NN
, ,
PowerRatankba.B NNP
issues NNS
What WP
HTTP NNP
requests VBZ
to TO
its PRP$
C NNP
& CC
C NNP
server NN
after IN
the DT
initial JJ
check-in NN
. .

Instead RB
of IN
a DT
numeric JJ
UID NNP
, ,
this DT
variant JJ
uses VBZ
the DT
infected JJ
device NN
’ NNP
s VBD
double-Base64-encoded JJ
MAC NNP
address NN
( (
Fig NNP
. .

33 CD
) )
. .

Figure NN
33 CD
: :
PowerRatankba.B VB
What WP
HTTP NNP
GET NNP
Request NNP
Commands NNS
from IN
the DT
C NNP
& CC
C NNP
are VBP
still RB
expected VBN
as IN
plaintext NN
but CC
command NN
parameters NNS
for IN
all DT
commands NNS
except IN
interval NN
are VBP
encrypted VBN
with IN
DES NNP
using VBG
“ NNP
Casillas NNP
” NN
as IN
both DT
the DT
key NN
and CC
initialization NN
vector NN
( (
IV NNP
) )
and CC
then RB
Base64-encoded NNP
. .

The DT
response NN
of IN
the DT
cmd NN
command NN
is VBZ
the DT
only JJ
data NN
that WDT
is VBZ
sent JJ
DES NNP
encrypted VBD
to TO
the DT
C NNP
& CC
C NNP
whilst VBP
all DT
other JJ
network NN
traffic NN
sent NN
from IN
the DT
infected JJ
device NN
to TO
the DT
C NNP
& CC
C NNP
is VBZ
either DT
plaintext JJ
or CC
Base64-encoded JJ
. .

Several JJ
new JJ
commands NNS
were VBD
added VBN
to TO
this DT
variant NN
( (
Table JJ
2 CD
) )
while IN
Execute NNP
and CC
DownExec NNP
were VBD
replaced VBN
. .

The DT
command NN
exe NN
was VBD
eventually RB
changed VBN
to TO
inj VB
while IN
functionality NN
remained VBD
the DT
same JJ
. .

Additionally RB
, ,
some DT
earlier JJR
variants NNS
did VBD
not RB
contain VB
all DT
of IN
the DT
commands NNS
listed VBN
below IN
but CC
the DT
overall JJ
capabilities NNS
of IN
the DT
backdoor NN
remained VBD
largely RB
the DT
same JJ
, ,
therefore RB
for IN
the DT
purpose NN
of IN
this DT
research NN
all DT
variants NNS
with IN
DES NNP
encryption NN
are VBP
considered VBN
variant JJ
PowerRatankba.B NNP
. .

Table JJ
2 CD
: :
PowerRatankba.B NNP
C NNP
& CC
C NNP
commands NNS
Command NN
success NN
killkill NN
interval NN
cmd NN
Description NN
Sleep NNP
and CC
send VB
request NN
after IN
sleep NN
Exit NN
Change NNP
default NN
sleep NN
length NN
Execute NNP
command NN
using VBG
“ NNP
cmd.exe NN
/c NNP
$ $
cmdInst NN
” NNP
. .

Command NNP
response NN
is VBZ
sent VBN
back RB
to TO
the DT
C NNP
& CC
C NNP
DES NNP
encrypted VBD
and CC
Base64 NNP
encoded VBD
Replace NNP
SCH NNP
, ,
VBS NNP
, ,
PS1 NNP
files VBZ
with IN
provided VBN
server NN
location NN
and CC
pre-determined JJ
URI NNP
( (
e.g. NN
, ,
Download NNP
payload NN
from IN
provided VBN
URL NNP
, ,
write NN
to TO
C NNP
: :
\Users\Public\Documents\000.exe NN
, ,
and CC
then RB
execute VB
payload NN
. .

Download NNP
payload NN
from IN
provided VBN
URL NNP
, ,
inject VBP
into IN
process JJ
memory NN
using VBG
Invoke- NNP
ReflectivePEInjection NN
cf_sv NN
rrr NN
exe NN
or CC
inj NN
PowerRatankba NNP
Persistence NNP
For IN
persistence NN
, ,
PowerRatankba.A NNP
saves VBZ
a DT
JS NNP
file NN
to TO
the DT
victim NN
’ NNP
s NN
Startup NNP
folder NN
as IN
appView.js NN
that WDT
will MD
be VB
executed VBN
every DT
time NN
the DT
victim NN
’ NNP
s VBZ
user JJ
account NN
logs NNS
in IN
. .

The DT
persistence NN
JS NNP
( (
Fig NNP
. .

34 CD
) )
contains VBZ
a DT
XOR NN
encoded VBN
PowerShell NNP
script NN
to TO
retrieve VB
a DT
Base64 NNP
encoded VBN
PowerShell NNP
from IN
a DT
hardcoded VBN
URL NNP
( (
e.g. NN
, ,
hxxp NN
: :
//macintosh.linkpc JJ
[ NN
. .

] JJ
net:8080/mainls.cs NN
) )
. .

The DT
encoded VBN
PowerShell NNP
script NN
used VBD
a DT
XOR NNP
key NN
of IN
“ JJ
ZWZBGMINRQLUSVTGHWVYANJHTVUHTLTUGKOHIYOXQEFEIPHNGACNKMBWGRTJIHRANIIZJNNZHVF NNP
” NNP
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
20 CD

Figure NN
34 CD
: :
appView.js NN
persistence NN
JS NNP

PowerRatankba.B NNP
is VBZ
capable JJ
of IN
using VBG
two CD
different JJ
persistence NN
methods NNS
while IN
only RB
one CD
will MD
be VB
used VBN
based VBN
on IN
whether IN
or CC
not RB
the DT
executing VBG
user NN
has VBZ
Administrator NNP
privileges NNS
. .

PowerRatankba NNP
first RB
checks VBZ
if IN
the DT
account NN
has VBZ
administrator NN
privileges NNS
by IN
executing VBG
the DT
following JJ
command NN
: :
“ NN
whoami NN
/groups NNP
| NNP
findstr VBD
/c NNS
: :
” JJ
S-1-5-32-544 NNP
” NNP
| NNP
findstr VBD
/c NNS
: :
” NN
Enabled VBD
group NN
” NN
& CC
& CC
goto NN
: :
isadministrator NN
’ NN
’ NN
. .

If IN
the DT
user NN
account NN
does VBZ
have VB
administrator NN
privileges NNS
then RB
PowerRatankba NNP
will MD
download VB
a DT
PowerShell NNP
script NN
from IN
a DT
hardcoded VBN
location NN
( (
e.g. NN
, ,
“ JJ
$ $
BaseServer NNP
+ NNP
‘ NNP
images/character.gif NN
’ NNP
” NNP
) )
, ,
save VBP
it PRP
to TO
a DT
hardcoded VBN
location NN
( (
e.g. NN
, ,
C NNP
: :
/Windows/System32/WindowsPowerShell/v1.0/Examples/detail.ps1 NN
) )
, ,
and CC
finally RB
create VB
a DT
scheduled JJ
task NN
to TO
execute VB
the DT
downloaded VBN
PowerShell NNP
script NN
on IN
system NN
startup NN
. .

If IN
the DT
user NN
account NN
does VBZ
not RB
have VB
administrator NN
privileges NNS
then RB
a DT
VBScript NNP
file NN
is VBZ
downloaded VBN
from IN
a DT
hardcoded VBN
location NN
( (
e.g. NN
, ,
“ JJ
$ $
BaseServer NNP
+ NNP
‘ NNP
images/top_bar.gif NN
’ NNP
” NNP
) )
and CC
saved VBN
to TO
the DT
executing VBG
user JJ
’ NNP
s NN
Startup NNP
folder NN
as IN
, ,
for IN
example NN
, ,
PwdOpt.vbs NNP
or CC
ProxyServer.vbs NNP
. .

PowerRatankba.B NNP
Stage2 NNP
- :
Gh0st NNP
RAT NNP
A DT
Gh0st NNP
remote JJ
access NN
Trojan/tool NNP
( (
RAT NNP
) )
was VBD
delivered VBN
via IN
PowerRatankba.B NNP
to TO
several JJ
devices NNS
running VBG
common JJ
cryptocurrency-related JJ
applications NNS
. .

The DT
Gh0st NNP
RAT NNP
samples NNS
were VBD
delivered VBN
via IN
the DT
memory NN
injection NN
exe/inj NN
command NN
( (
Fig NNP
. .

35 CD
) )
. .

After IN
decrypting VBG
the DT
command NN
with IN
DES NNP
the DT
target NN
URL NNP
was VBD
revealed VBN
to TO
be VB
hxxp VBN
: :
//180.235.133 JJ
[ NN
. .

] RB
235/img.gif CD
( (
Fig NNP
. .

36 CD
) )
. .

Figure NN
35 CD
: :
Exe NNP
command NN
delivered VBN
from IN
PowerRatankba.B NNP
C NNP
& CC
C NNP
to TO
infected VB
device NN
Figure NN
36 CD
( (
left VBN
) )
: :
PowerRatankba.B NN
retrieving VBG
Base64-encoded JJ
Gh0st NNP
dropper NN
The DT
fake JJ
image NN
was VBD
actually RB
a DT
Base64-encoded JJ
custom NN
encryptor NN
with IN
the DT
embedded VBN
, ,
encrypted VBD
Gh0st NNP
RAT NNP
as IN
the DT
final JJ
payload NN
. .

The DT
encryptor NN
utilized JJ
AES NNP
in IN
CBC-mode NNP
with IN
the DT
NIST NNP
Special JJ
Publication NNP
800-38A JJ
example NN
key NN
of IN
“ RB
2B7E151628AED2A6ABF7158809CF4F3C CD
” NNS
and CC
IV NNP
of IN
“ RB
000102030405060708090A0B0C0D0E0F CD
” NN
( (
Fig NNP
. .

37 CD
) )
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
21 CD
Figure NN
37 CD
: :
AES NNP
key NN
and CC
IV NNP
in IN
custom NN
encryptor NN
downloaded VBN
by IN
PowerRatankba.B NNP
The DT
decrypted JJ
Gh0st NNP
implant NN
is VBZ
a DT
custom NN
variant NN
with IN
magic JJ
bytes NNS
of IN
RFC18 NNP
( (
Fig NNP
. .

38 CD
) )
. .

This DT
variant NN
was VBD
likely RB
based VBN
on IN
version NN
3.4.0.0 CD
of IN
Gh0st/PCRat NNP
, ,
however RB
we PRP
consider VBP
it PRP
likely JJ
that IN
the DT
author NN
( (
s PRP
) )
have VBP
given VBN
their PRP$
implants NNS
an DT
internal JJ
version NN
of IN
1.0.0.1 CD
as IN
can MD
be VB
observed VBN
in IN
the DT
decompressed JJ
initial JJ
check-in NN
to TO
the DT
C NNP
& CC
C NNP
( (
as RB
well RB
as IN
hardcoded VBN
in IN
the DT
binaries NNS
) )
( (
Fig NNP
. .

39 CD
) )
. .

Figure NN
38 CD
: :
Magic NNP
RFC18 NNP
value NN
in IN
unpacked JJ
Gh0st NNP
RAT NNP
sample NN
Figure NN
39 CD
: :
Version NN
1.0.0.1 CD
RFC18 NNP
Gh0st NNP
RAT NNP

Much JJ
of IN
the DT
3.4.0.0 CD
code NN
remains VBZ
the DT
same JJ
, ,
including VBG
the DT
usage NN
of IN
Zlib NNP
compression NN
and CC
the DT
infamous JJ
\x78\x9c NN
default NN
Zlib NNP
compression NN
header NN
bytes NNS
( (
Fig NNP
. .

40 CD
) )
observed VBN
in IN
countless JJ
Gh0st NNP
RAT NNP
samples VBZ
over IN
the DT
years NNS
. .

Figure NN
40 CD
: :
Initial JJ
Gh0st NNP
check-in NN
depicting VBG
RFC18 NNP
magic NN
bytes NNS
and CC
Zlib NNP
header NN


North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
22 CD
Gh0st NNP
RAT NNP
Purpose NNP
During IN
our PRP$
research NN
we PRP
discovered VBD
that IN
long-term JJ
sandboxing VBG
detonations NNS
of IN
PowerRatankba NNP
not RB
running VBG
cryptocurrency- NN
related JJ
applications NNS
were VBD
never RB
infected VBN
with IN
a DT
Stage2 NNP
implant NN
. .

This DT
may MD
indicate VB
that IN
the DT
PowerRatankba NNP
operator NN
( (
s NN
) )
were VBD
only RB
interested JJ
in IN
infecting VBG
device NN
owners NNS
with IN
an DT
obvious JJ
interest NN
in IN
various JJ
cryptocurrencies NNS
. .

In IN
one CD
case NN
, ,
a DT
RFC18 NNP
Gh0st NNP
RAT NNP
was VBD
delivered VBN
to TO
a DT
PowerRatankba.B NNP
infected JJ
device NN
within IN
twenty JJ
minutes NNS
of IN
the DT
initial JJ
infection NN
. .

From IN
analyzing VBG
C NNP
& CC
C NNP
traffic NN
logs VBZ
we PRP
assess VBP
that IN
a DT
Lazarus NNP
operator NN
almost RB
immediately RB
viewed VBD
the DT
screen NN
of IN
the DT
infected JJ
device NN
and CC
then RB
proceeded VBN
to TO
take VB
over RP
full JJ
remote NN
control NN
, ,
giving VBG
them PRP
the DT
ability NN
to TO
interact VB
with IN
applications NNS
on IN
the DT
infected JJ
device NN
, ,
including VBG
a DT
password-protected JJ
Bitcoin NNP
wallet NN
application NN
. .

Shopping VBG
Spree NN
: :
Enter NN
RatankbaPOS NNP
Beyond IN
stealing VBG
millions NNS
of IN
US NNP
dollars NNS
worth IN
of IN
cryptocurrency NN
, ,
we PRP
have VBP
discovered VBN
a DT
Lazarus NNP
operation NN
to TO
steal VB
point- JJ
of-sale JJ
( (
POS NNP
) )
data NNS
primarily RB
targeting VBG
POS NNP
terminals NNS
of IN
businesses NNS
operating VBG
in IN
South NNP
Korea NNP
. .

Considering VBG
the DT
time NN
of IN
year NN
, ,
most JJS
retail JJ
businesses NNS
around IN
the DT
world NN
report VBP
their PRP$
highest JJS
volume NN
of IN
sales NNS
between IN
November NNP
and CC
December NNP
so RB
naturally RB
POS NNP
is VBZ
a DT
popular JJ
target NN
for IN
criminals NNS
. .

Enter NNP
RatankbaPOS NNP
, ,
possibly RB
the DT
first JJ
publicly RB
documented VBN
nation-state NN
sponsored VBN
campaign NN
to TO
steal VB
POS NNP
data NNS
from IN
a DT
POS-related JJ
framework.1 NN
At IN
this DT
time NN
we PRP
have VBP
been VBN
unable JJ
to TO
determine VB
how WRB
RatankbaPOS NNP
is VBZ
being VBG
delivered VBN
; :
however RB
, ,
based VBN
on IN
its PRP$
sharing NN
of IN
C NNP
& CC
C NNP
with IN
PowerRatankba NNP
implants NNS
we PRP
hypothesize VBP
that IN
Lazarus NNP
operators NNS
infiltrated VBD
at IN
least JJS
one CD
organization NN
’ NNP
s NN
networks NNS
utilizing VBG
PowerRatankba NNP
to TO
deploy VB
later RB
stage NN
implants NNS
( (
including VBG
the DT
possibility NN
of IN
RFC18 NNP
Gh0ST NNP
RAT NNP
) )
to TO
ultimately RB
deploy VB
RatankbaPOS NNP
. .

Based VBN
on IN
the DT
fact NN
that IN
the DT
file NN
was VBD
hosted VBN
on IN
the DT
C NNP
& CC
C NNP
in IN
plaintext NN
, ,
and CC
not RB
Base64 NNP
encoded VBD
, ,
we PRP
assess VBP
that IN
RatankbaPOS NNP
was VBD
more RBR
likely JJ
deployed VBN
with IN
a DT
later JJ
stage NN
implant NN
other JJ
than IN
PowerRatankba NNP
. .

RatankbaPOS NNP
Analysis NN
RatankbaPOS NNP
is VBZ
deployed VBN
through IN
a DT
process NN
injection NN
dropper NN
that WDT
is VBZ
also RB
capable JJ
of IN
installing VBG
itself PRP
persistently RB
, ,
checking VBG
a DT
C NNP
& CC
C NNP
for IN
either DT
an DT
update NN
or CC
a DT
command NN
to TO
delete VB
itself PRP
, ,
dropping VBG
the DT
RatankbaPOS NNP
implant NN
to TO
disk VB
, ,
and CC
finally RB
searching VBG
for IN
the DT
targeted JJ
POS NNP
process NN
and CC
module NN
for IN
injection NN
and CC
ultimately RB
the DT
theft NN
of IN
POS NNP
data NNS
. .

The DT
dropper NN
first RB
sets VBZ
up RP
persistence NN
by IN
creating VBG
a DT
registry NN
key NN
in IN
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\ NNP
CurrentVersion\Run\igfxgpttray NN
. .

It PRP
uses VBZ
its PRP$
own JJ
module NN
file NN
name NN
for IN
the DT
registry NN
key JJ
value NN
. .

Next RB
, ,
it PRP
makes VBZ
an DT
HTTP NNP
request NN
to TO
a DT
hardcoded VBN
URL NNP
hxxp NN
: :
//www JJ
[ NN
. .
] CC
webkingston JJ
[ NN
. .

] NN
com/update.jsp NN
? .
action=need_update NN
using VBG
a DT
hardcoded JJ
User-Agent NN
( (
UA NNP
) )
of IN
“ NNP
Nimo NNP
Software NNP
HTTP NNP
Retriever NNP
1.0 CD
” NNP
( (
Fig NNP
. .

41 CD
) )
to TO
request VB
either DT
instruction NN
from IN
the DT
C NNP
& CC
C NNP
to TO
delete VB
itself PRP
and CC
remove VB
the DT
persistence NN
registry NN
key NN
or CC
to TO
download VB
an DT
updated JJ
implant NN
with IN
which WDT
to TO
replace VB
itself PRP
. .

If IN
no DT
response NN
is VBZ
returned VBN
from IN
the DT
C NNP
& CC
C NNP
, ,
RatankbaPOS NNP
will MD
begin VB
the DT
process NN
injection NN
search NN
. .

Figure NN
41 CD
: :
RatankbaPOS NNP
dropper IN
requesting VBG
and CC
receiving VBG
update NN
from IN
C NNP
& CC
C NNP
1 CD
We PRP
acknowledge VBP
the DT
excellent JJ
work NN
from IN
@ JJ
ashley_shen_920 NN
, ,
@ ''
051R15 CD
, ,
and CC
@ NNP
kjkwak12 VBP
with IN
their PRP$
documentation NN
of IN
North NNP
Korean-related NNP
attacks NNS
on IN
VANXATM NNP
which WDT
was VBD
targeting VBG
ATM NNP
devices NNS
and CC
not RB
directly RB
POS NNP
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
23 CD
The DT
process NN
injection NN
search NN
begins VBZ
by IN
taking VBG
a DT
snapshot NN
of IN
the DT
process NN
list NN
using VBG
CreateToolhelp32Snapshot NNP
. .

The DT
implant NN
dropper/injector NN
will MD
then RB
case-insensitive VB
search NN
for IN
a DT
process NN
named VBN
xplatform.exe NNP
which WDT
we PRP
assess VBP
is VBZ
likely JJ
associated VBN
with IN
Tobesoft NNP
’ NNP
s VBD
XPLATFORM NNP
UI/UX NNP
design NN
software NN
. .

If IN
a DT
process NN
name NN
match NN
is VBZ
found VBN
then RB
a DT
TH32CS_SNAPMODULE NN
CreateToolhelp32Snapshot NNP
call NN
is VBZ
used VBN
to TO
make VB
a DT
snapshot NN
of IN
xplatform.exe NNP
’ NNP
s VBD
running VBG
module NN
list NN
. .

Loaded VBN
modules NNS
are VBP
then RB
iterated VBN
using VBG
Module32First NNP
and CC
Module32Next NNP
while IN
converting VBG
each DT
result NN
to TO
lowercase VB
by IN
adding VBG
0x20 CD
to TO
any DT
uppercase JJ
letters NNS
and CC
then RB
finally RB
comparing VBG
the DT
string NN
to TO
ksnetadsl.dll VB
( (
Fig NNP
. .

42 CD
) )
that IN
we PRP
assess VBP
is VBZ
associated VBN
with IN
a DT
KSNET NNP
POS NNP
framework NN
. .

Finally RB
, ,
the DT
filesize NN
of IN
ksnetadsl.dll NN
is VBZ
checked VBN
to TO
make VB
sure JJ
it PRP
is VBZ
98,304 CD
bytes NNS
( (
Fig NNP
. .

42 CD
) )
. .

If IN
a DT
successful JJ
match NN
is VBZ
found VBN
then RB
the DT
process NN
ID NNP
( (
PID NNP
) )
of IN
xplatform.exe NN
is VBZ
returned VBN
. .

Lastly RB
, ,
RatankbaPOS NNP
will MD
be VB
written VBN
to TO
disk NN
as IN
c NN
: :
\windows\temp\hkp.dll NN
and CC
the DT
PID NNP
of IN
xplatform.exe NNP
process NN
will MD
be VB
used VBN
to TO
inject VB
hkp.dll NN
into IN
xplatform.exe NN
using VBG
LoadLibraryA NNP
and CC
CreateRemoteThread NNP
( (
Fig NNP
. .

43 CD
) )
. .

Figure NN
42 CD
: :
Dropper/injector NN
searching VBG
for IN
ksnetadsl.dll NN
and CC
correct JJ
filesize NN
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
24 CD

Figure NN
43 CD
: :
Injecting NN
RatankbaPOS NNP
into IN
xplatform.exe NN
RatankbaPOS NNP
will MD
first VB
hook VB
the DT
KSNETADSL.dll NNP
module NN
at IN
offset $
0xB146 CD
( (
Fig NNP
. .

44 CD
) )
. .

Interestingly RB
there EX
is VBZ
code NN
for IN
RatankbaPOS NNP
to TO
check VB
KSNETADSL.dll NNP
for IN
an DT
exported JJ
function NN
named VBD
1000B146 CD
, ,
which WDT
seems VBZ
like IN
an DT
unusual JJ
export NN
name NN
for IN
which WDT
to TO
check VB
, ,
but CC
this DT
code NN
will MD
never RB
be VB
used VBN
because IN
‘ NN
! .
strcmp NN
( (
“ JJ
1000B146 CD
” NN
, ,
“ VBZ
1000B146 CD
” NN
) )
’ NN
will MD
always RB
be VB
true JJ
. .

We PRP
hypothesize VBP
that IN
this DT
feature NN
was VBD
included VBN
either RB
by IN
mistake NN
or CC
was VBD
previously RB
used VBN
for IN
debugging VBG
. .

RatankbaPOS NNP
will MD
also RB
log NN
messages NNS
to TO
a DT
file NN
stored VBN
in IN
c NN
: :
\windows\temp\log.tmp NN
. .

Figure NN
44 CD
: :
RatankbaPOS NN
setting VBG
KSNETADSL.dll NNP
injection NN
offset NN
At IN
this DT
point NN
in IN
the DT
reverse NN
engineering NN
process NN
, ,
we PRP
would MD
naturally RB
begin VB
reversing VBG
the DT
KSNETADSL NNP
. .

dll NN
module NN
; :
however RB
, ,
we PRP
have VBP
only RB
been VBN
able JJ
to TO
find VB
two CD
such JJ
modules NNS
with IN
a DT
filesize NN
of IN
98,304 CD
bytes NNS
: :
f2f6b4770718eed349fb7c77429938ac1deae7dd6bcc141ee6f5af9f4501a695 NN
• NN
• $
6c8c801bb71b2cd90a2c1595092358e46cbfe63e62ef6994345d6969993ea2d6 CD
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
25 CD
After IN
analyzing VBG
both DT
KSNETADSL.dll NNP
modules NNS
, ,
our PRP$
preliminary JJ
assessment NN
is VBZ
that IN
neither DT
of IN
the DT
modules NNS
are VBP
the DT
correct NN
target NN
for IN
RatankbaPOS NNP
. .

We PRP
can MD
at IN
least JJS
gain VB
some DT
insight NN
into IN
the DT
purpose NN
of IN
KSNETADSL.dll NNP
, ,
which WDT
appears VBZ
to TO
be VB
the DT
handling NN
of IN
encrypted JJ
and CC
decrypted VBN
credit NN
card NN
numbers NNS
for IN
a DT
KSNET-related JJ
POS NNP
framework NN
system NN
( (
Fig NNP
. .

45 CD
) )
. .

Further RB
analysis NN
of IN
RatankbaPOS NNP
focusing VBG
on IN
the DT
code NN
used VBN
for IN
C NNP
& CC
C NNP
revealed VBD
the DT
likely JJ
purpose NN
of IN
this DT
implant NN
Figure NN
45 CD
: :
Screenshot JJ
showing VBG
KSNET NNP
module NN
interaction NN
with IN
CARD_NO NNP
registry NN
key NN
Only RB
one CD
HTTP NNP
POST NNP
request NN
is VBZ
programmed VBN
in IN
RatankbaPOS NNP
for IN
the DT
communication NN
to TO
a DT
C NNP
& CC
C NNP
that WDT
is VBZ
called VBN
via IN
CreateThread NN
in IN
the DT
hook NN
handler NN
( (
DoC2 NNP
, ,
Fig NNP
. .

46 CD
) )
. .

Figure NN
46 CD
: :
Hook NNP
handler NN
creating VBG
new JJ
thread NN
for IN
C NNP
& CC
C NNP
then RB
hooking VBG
KSNETADSL.dll NNP
Our PRP$
analysis NN
of IN
the DT
C NNP
& CC
C NNP
communication NN
revealed VBD
a DT
number NN
of IN
clues NNS
as IN
to TO
what WP
was VBD
being VBG
exfiltrated VBN
. .

Initially RB
, ,
the DT
implant NN
uses NNS
strchr VBP
to TO
find VB
the DT
first JJ
occurrence NN
of IN
“ NNP
= NNP
” NNP
in IN
the DT
string NN
data NNS
that WDT
is VBZ
received VBN
from IN
the DT
hook NN
of IN
KSNETADSL.dll NNP
. .

Next JJ
, ,
37-bytes NNS
beginning VBG
at IN
16-bytes NNS
before IN
the DT
position NN
of IN
the DT
“ NNP
= NNP
” NNP
are VBP
copied VBN
to TO
a DT
buffer NN
. .

Finally RB
, ,
that DT
buffer NN
is VBZ
compared VBN
to TO
a DT
substitution NN
buffer NN
that WDT
was VBD
created VBN
at IN
the DT
beginning NN
of IN
RatankbaPOS NNP
’ NNP
execution NN
( (
Fig NNP
. .

47 CD
) )
. .

The DT
substitution NN
algorithm NN
uses NNS
the DT
values NNS
starting VBG
at IN
offset VBN
0x30-0x39 NN
in IN
the DT
“ NNP
E NNP
” NNP
-filled VBD
buffer NN
to TO
substitute VB
the DT
ASCII NNP
values NNS
of IN
“ JJ
0-9 JJ
” NN
for IN
“ NNP
ZCKOADBLNX NNP
” NNP
as IN
well RB
as IN
at IN
offset $
0x3D CD
for IN
substitution NN
of IN
ASCII NNP
“ NNP
= NNP
” NNP
to TO
“ VB
Y NNP
” NNP
. .

Therefore RB
, ,
values NNS
“ VBP
0-9 JJ
” NN
will MD
be VB
obfuscated VBN
to TO
“ VB
ZCKOADBLNX NNP
” NN
while IN
“ JJ
= NNP
” NNP
will MD
be VB
obfuscated VBN
to TO
“ VB
Y NNP
” NNP
( (
Fig NNP
. .

48 CD
) )
. .

Figure NN
47 CD
: :
Obfuscation NN
substitution NN
buffer NN
created VBD
in IN
RatankbaPOS NNP

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
26 CD
Figure NN
48 CD
: :
Obfuscation NN
substitution NN
buffer NN
in IN
memory NN
To TO
obfuscate VB
the DT
data NNS
, ,
RatankbaPOS NNP
simply RB
uses VBZ
the DT
hex JJ
value NN
of IN
the DT
cleartext JJ
ASCII NNP
string NN
to TO
substitute VB
itself PRP
for IN
a DT
value NN
in IN
the DT
substitution NN
buffer NN
. .

For IN
instance NN
, ,
a DT
value NN
of IN
“ $
0 CD
” NNP
would MD
be VB
substituted VBN
to TO
“ VB
Z NNP
” NNP
while IN
any DT
equals NNS
signs NNS
( (
“ JJ
= NNP
” NNP
) )
will MD
be VB
substituted VBN
for IN
“ NNP
Y NNP
” NNP
. .

This DT
method NN
is VBZ
used VBN
to TO
likely JJ
obfuscate VB
the DT
data NNS
so IN
it PRP
is VBZ
harder JJR
to TO
detect VB
by IN
simply RB
glancing VBG
at IN
network NN
traffic NN
or CC
through IN
the DT
use NN
of IN
heuristic-based JJ
detection NN
of IN
plaintext JJ
credit NN
card NN
data NNS
transmitted VBD
over IN
the DT
network NN
. .

Once RB
the DT
stolen VBN
data NN
has VBZ
been VBN
obfuscated VBN
, ,
it PRP
is VBZ
sent VBN
in IN
a DT
POST NNP
HTTP NNP
request NN
to TO
the DT
URL NNP
/list.jsp NNP
? .
action=up NN
using VBG
the DT
same JJ
hardcoded VBN
UA NNP
as IN
the DT
injector NN
: :
“ NN
Nimo NNP
Software NNP
HTTP NNP
Retriever NNP
1.0 CD
” NNP
( (
Fig NNP
. .

49 CD
) )
. .

So RB
far RB
we PRP
have VBP
observed VBN
the DT
following VBG
C NNP
& CC
C NNP
domains NNS
: :
www.energydonate NN
[ NN
. .

] NN
com NN
and CC
online-help.serveftp JJ
[ NN
. .
] JJ
com NN
. .

Figure NN
49 CD
: :
DoC2 NNP
function NN
that WDT
obfuscates VBZ
stolen VBN
data NNS
and CC
exfiltrates VBZ
to TO
a DT
C NNP
& CC
C NNP
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
27 CD
Based VBN
on IN
documentation NN
we PRP
have VBP
found VBN
online NN
, ,
RatankbaPOS NNP
is VBZ
possibly RB
targeting VBG
plaintext JJ
track NN
data NNS
in IN
the DT
first JJ
16 CD
bytes NNS
followed VBN
by IN
a DT
“ JJ
= NN
” NN
and CC
finally RB
followed VBN
by IN
encrypted VBN
POS-related JJ
data NNS
beginning VBG
with IN
“ JJ
99 CD
” NN
( (
Fig NNP
. .

50 CD
) )
. .

According VBG
to TO
the DT
document NN
, ,
this DT
is VBZ
an DT
encrypted JJ
form NN
of IN
the DT
track NN
data NN
. .

Based VBN
on IN
this DT
, ,
there EX
is VBZ
the DT
possibility NN
that IN
this DT
campaign NN
may MD
be VB
targeting VBG
a DT
SoftCamp NNP
POS-related JJ
software NN
application NN
, ,
framework NN
, ,
or CC
device NN
. .

If IN
we PRP
are VBP
correct JJ
and CC
the DT
values NNS
“ VBP
99 CD
” NNP
always RB
follow VBP
the DT
“ NN
= NNP
” NNP
sign NN
then RB
one CD
could MD
potentially RB
find VB
exfiltrated JJ
data NNS
in IN
network NN
traffic NN
by IN
searching VBG
for IN
the DT
string NN
“ NNP
YXX NNP
” NNP
starting VBG
at IN
offset $
16 CD
in IN
the DT
client NN
body NN
of IN
an DT
HTTP NNP
POST NNP
request NN
. .

However RB
, ,
more JJR
logic JJ
will MD
likely RB
be VB
necessary JJ
to TO
reduce VB
false JJ
positives NNS
but CC
this DT
opens VBZ
up RP
several JJ
options NNS
for IN
detection NN
. .

Figure NN
50 CD
: :
Documentation NN
on IN
South JJ
Korean JJ
POS NNP
software NN
depicting VBG
POS NNP
data NNS
that WDT
matches VBZ
the DT
pattern NN
RatankbaPOS NNP
is VBZ
searching VBG
for IN
( (
markings NNS
not RB
ours NNS
) )
RatankbaPOS NNP
Targeted NNP
Region NNP
Based VBN
on IN
the DT
fact NN
that IN
RatankbaPOS NNP
is VBZ
targeting VBG
a DT
South JJ
Korean JJ
software NN
vendor NN
’ NNP
s NN
POS NNP
framework NN
, ,
including VBG
clues NNS
that IN
the DT
length NN
of IN
exfiltrated VBN
data NNS
matches NNS
related JJ
POS NNP
data NN
( (
document NN
here RB
, ,
and CC
another DT
document NN
here RB
) )
, ,
we PRP
assess VBP
with IN
high JJ
confidence NN
that IN
this DT
threat NN
is VBZ
primarily RB
targeting VBG
devices NNS
in IN
South NNP
Korea NNP
. .

Attribution NN
to TO
Lazarus NNP
Group NNP
Attribution NN
is VBZ
a DT
controversial JJ
topic NN
and CC
arguably RB
one CD
of IN
the DT
most RBS
difficult JJ
tasks NNS
threat NN
intelligence NN
analysts NNS
face VBP
. .

However RB
, ,
based VBN
on IN
our PRP$
research NN
, ,
we PRP
assess VBP
with IN
a DT
high JJ
level NN
of IN
confidence NN
given VBN
the DT
information NN
available JJ
to TO
us PRP
that IN
the DT
operations NNS
and CC
activity NN
discussed VBN
in IN
this DT
research NN
are VBP
attributed VBN
to TO
Lazarus NNP
Group NNP
and CC
ultimately RB
North NNP
Korea NNP
. .

In IN
consideration NN
of IN
the DT
controversial JJ
and CC
difficult JJ
task NN
at IN
hand NN
, ,
we PRP
are VBP
providing VBG
an DT
above NN
and CC
beyond IN
summary JJ
of IN
just RB
some DT
of IN
the DT
key JJ
pieces NNS
and CC
overlaps NNS
to TO
validate VB
our PRP$
assessment NN
. .

Key NNP
reasons NNS
, ,
discussed VBN
in IN
detail NN
below IN
, ,
are VBP
Encryption NNP
, ,
Obfuscation NN
, ,
Functionality NNP
, ,
Code NNP
Overlap NNP
, ,
Decoys NNP
, ,
and CC
C NNP
& CC
C NNP
. .

Encryption NN
In IN
October NNP
2016 CD
Lazarus NNP
Group NNP
pulled VBD
off RP
a DT
major JJ
operation NN
that WDT
allegedly RB
compromised VBD
at IN
least JJS
20 CD
banks NNS
in IN
Poland NNP
as IN
well RB
as IN
banks NNS
in IN
other JJ
countries NNS
around IN
the DT
world NN
. .

The DT
attacks NNS
have VBP
been VBN
well RB
documented VBN
by IN
BAE NNP
, ,
Kaspersky NNP
, ,
ESET NNP
, ,
TrendMicro NNP
, ,
and CC
Symantec NNP
. .

The DT
attribution NN
of IN
this DT
attack NN
to TO
Lazarus NNP
( (
aka NN
, ,
Bluenoroff NNP
) )
and CC
ultimately RB
North NNP
Korea NNP
is VBZ
widely RB
accepted VBN
across IN
the DT
industry NN
. .

What WP
has VBZ
not RB
been VBN
documented VBN
publicly RB
, ,
to TO
our PRP$
knowledge NN
, ,
are VBP
the DT
specifics NNS
behind IN
the DT
implementation NN
of IN
the DT
Spritz NNP
encryption NN
cipher NN
utilized VBN
in IN
some DT
of IN
the DT
implants NNS
surrounding VBG
the DT
banking NN
incidents NNS
in IN
late JJ
2016 CD
and CC
early JJ
2017 CD
. .

Spritz NNP
is VBZ
self-described JJ
as IN
a DT
spongy JJ
RC4-like JJ
stream NN
cipher NN
that WDT
was VBD
designed VBN
by IN
Ronald NNP
Rivest NNP
and CC
Jacob NNP
Schuldt NNP
. .

Multiple JJ
implementations NNS
of IN
Spritz NNP
exist VBP
on IN
Github NNP
in IN
languages NNS
like IN
C NNP
and CC
Python NNP
. .

Anyone NN
researching VBG
Lazarus NNP
Group NNP
’ NNP
s NN
version NN
of IN
Spritz NNP
will MD
quickly RB
find VB
out RP
that IN
neither DT
of IN
the DT
previously RB
mentioned VBN
implementations NNS
will MD
successfully RB
decrypt VB
hidden JJ
payloads NNS
in IN
either DT
banking NN
related JJ
implants NNS
nor CC
PowerSpritz NNP
’ NNP
s NN
legitimate JJ
installer NN
payload NN
and CC
malicious JJ
PowerShell NNP
commands NNS
. .

The DT
issue NN
, ,
or CC
possibly RB
feature NN
, ,
in IN
Lazarus NNP
Group NNP
’ NNP
s VBZ
implementation NN
of IN
Spritz NNP
can MD
be VB
found VBN
buried VBN
in IN
a DT
single JJ
paragraph NN
on IN
page NN
five CD
of IN
the DT
original JJ
Spritz NNP
publication NN
( (
Fig NNP
. .

51 CD
) )
. .

It PRP
states VBZ
that IN
addition NN
and CC
subtraction NN
may MD
be VB
substituted VBN
for IN
exclusive- NN
or CC
( (
XOR NNP
) )
and CC
is VBZ
referred VBN
to TO
Spritz-xor NNP
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
28 CD
Figure NN
51 CD
: :
Excerpt NN
from IN
Spritz NNP
publication NN
Examining VBG
Lazarus NNP
Group NNP
’ NNP
s VBZ
implementation NN
of IN
Spritz NNP
in IN
one CD
of IN
the DT
original JJ
implants NNS
utilized JJ
to TO
compromise VB
banks NNS
in IN
late JJ
2016 CD
and CC
2017 CD
via IN
watering VBG
hole NN
attacks NNS
, ,
it PRP
quickly RB
becomes NNS
apparent VBP
that IN
they PRP
have VBP
actually RB
implemented VBN
Spritz-xor JJ
instead RB
of IN
the DT
normal JJ
Spritz NNP
algorithm NN
( (
Fig NNP
. .

52 CD
) )
. .

Figure NN
52 CD
: :
Spritz-xor JJ
decrypt NN
implementation NN
in IN
Lazarus NNP
Group NNP
’ NNP
s VBD
implant JJ
from IN
compromised JJ
banks NNS
PowerSpritz NNP
utilizes VBZ
the DT
same JJ
exact JJ
Spritz-xor JJ
implementation NN
as IN
the DT
older JJR
Lazarus NNP
Group-attributed NNP
implant NN
( (
Fig NNP
. .

53 CD
) )
. .

We PRP
assess VBP
that DT
due JJ
to TO
how WRB
rare JJ
Spritz NNP
usage NN
is VBZ
ITW NNP
, ,
in IN
addition NN
to TO
the DT
implemented VBN
deviation NN
from IN
the DT
standard NN
, ,
that IN
it PRP
is VBZ
unlikely RB
a DT
different JJ
threat NN
actor NN
is VBZ
also RB
using VBG
this DT
specific JJ
implementation NN
. .

Figure NN
53 CD
: :
Spritz-xor JJ
decrypt NN
implementation NN
in IN
PowerSpritz NNP
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
29 CD
Obfuscation NN
Earlier RBR
this DT
year NN
several JJ
watering NN
hole NN
attacks NNS
targeting VBG
South NNP
Korea NNP
utilized VBD
an DT
ActiveX NNP
0day CD
exploit NN
in IN
M2Soft NNP
to TO
deliver VB
Lazarus-connected JJ
FBI-RAT NNP
and CC
Charon NNP
implants NNS
. .

Some DT
of IN
the DT
techniques NNS
observed VBN
in IN
these DT
attacks NNS
overlap VBP
with IN
the DT
JS NNP
downloader NN
and CC
CHM NNP
PowerRatankba NNP
campaigns NNS
. .

One CD
such JJ
overlap NN
was VBD
through IN
the DT
usage NN
of IN
a DT
well-known JJ
JS NN
obfuscation NN
technique NN
in IN
both CC
the DT
M2Soft NNP
exploit NN
and CC
PowerRatankba NNP
JS NNP
downloader NN
campaigns NNS
. .

The DT
method NN
is VBZ
a DT
public JJ
and CC
widely RB
used VBD
technique NN
of IN
masking VBG
strings NNS
using VBG
their PRP$
hexadecimal JJ
values NNS
and CC
placing VBG
them PRP
in IN
an DT
array NN
assigned VBD
to TO
a DT
variable JJ
with IN
a DT
naming JJ
structure NN
of IN
_0x JJ
[ NNP
a-f0-9 NN
] NNP
{ (
4 CD
} )
( (
Fig NNP
. .

54 CD
) )
. .

Figure NN
54 CD
: :
ActiveX NNP
M2Soft NNP
exploit VBD
utilizing VBG
JS NNP
obfuscation NN
also RB
observed VBD
in IN
a DT
PowerRatankba NNP
campaign NN
Functionality NN
Several JJ
features NNS
in IN
the DT
original JJ
Ratankba NNP
implants NNS
are VBP
similar JJ
or CC
identical JJ
when WRB
compared VBN
to TO
PowerRatankba NNP
and CC
RatankbaPOS NNP
. .

Furthermore RB
, ,
the DT
usage NN
of IN
a DT
common JJ
directory NN
c NN
: :
\windows\temp\ NN
for IN
the DT
storage NN
of IN
implants NNS
and CC
logs NNS
are VBP
seen VBN
across IN
a DT
wide JJ
array NN
of IN
Lazarus NNP
Group NNP
’ NNP
s VBZ
toolset NN
. .

A DT
brief JJ
overview NN
of IN
similar JJ
features NNS
is VBZ
shown VBN
in IN
below NN
( (
Table JJ
3 CD
) )
while IN
a DT
detailed JJ
description NN
of IN
each DT
overlap NN
may MD
be VB
found VBN
below IN
. .

Table JJ
3 CD
: :
Feature NN
comparison NN
table NN
Feature NN
JSP NNP
C NNP
& CC
C NNP
similarities NNS
Commands NNS
: :
success NN
, ,
killkill VB
Sleep JJ
15 CD
minutes NNS
loop VBP
c NNS
: :
\windows\temp\ NN
PowerRatankba NNP
RatankbaPOS NNP
M2Soft NNP
Exploit NNP
FEIB NNP
Spreader NNP
Ratankba NN
X NN
X NN
X NN
X NN
X NN
X NN
X NN
X NN
X NN
X NN
X NN
First RB
consider VB
the DT
C NNP
& CC
C NNP
protocols VBZ
utilized VBN
in IN
all DT
Ratankba NNP
, ,
PowerRatankba NNP
, ,
and CC
RatankbaPOS NNP
. .

Ratankba NNP
’ NNP
s VBD
initial JJ
POST NNP
to TO
C NNP
& CC
C NNP
to TO
divulge VB
compromised JJ
system NN
information NN
uses VBZ
the DT
same JJ
BaseInfo NNP
parameter NN
as IN
PowerRatankba NNP
. .

Additionally RB
, ,
a DT
Ratankba NNP
sample NN
( (
bd7332bfbb6fe50a501988c3834a160cf2ad948091d83ef4de31758b27b2fb7f NN
) )
utilizes VBZ
a DT
C NNP
& CC
C NNP
of IN
list.jsp NN
while IN
RatankbaPOS NNP
utilizes VBZ
an DT
identical JJ
URIfile NNP
name NN
for IN
allegedly RB
exfiltrating VBG
credit NN
card NN
information NN
to TO
a DT
C NNP
& CC
C NNP
. .

Second JJ
, ,
Ratankba NNP
’ NNP
s NN
supported VBD
commands NNS
include VBP
success NN
and CC
killkill VB
that DT
function NN
identically RB
to TO
the DT
respective JJ
PowerRatankba NNP
commands NNS
. .

Furthermore RB
, ,
a DT
sleep JJ
loop NN
of IN
900 CD
seconds NNS
( (
15 CD
minutes NNS
) )
is VBZ
utilized VBN
in IN
both DT
Ratankba NNP
and CC
RatankbaPOS NNP
’ NNP
dropper NN
( (
Fig NNP
. .

56,56 CD
) )
. .

Figure NN
55 CD
: :
Ratankba NNP
command VBP
loop NN
sleep NN
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
30 CD
Figure NN
56 CD
: :
RatankbaPOS NNP
dropper VBZ
target NN
process NN
search NN
loop NN
Lastly RB
, ,
while IN
further JJ
analyzing VBG
the DT
M2Soft NNP
exploit NN
discussed VBD
in IN
the DT
Obfuscation NNP
section NN
, ,
a DT
familiar JJ
destination NN
directory NN
of IN
C NNS
: :
\windows\temp\ NN
was VBD
spotted VBN
in IN
the DT
deobfuscated JJ
JS NNP
( (
Fig NNP
. .

57,58 CD
) )
. .

This DT
destination NN
directory NN
was VBD
also RB
used VBN
during IN
the DT
PowerRatankba NNP
CHM NNP
campaign NN
, ,
by IN
RatankbaPOS NNP
for IN
log NN
and CC
implant JJ
storage NN
, ,
and CC
by IN
the DT
FEIB NNP
spreader NN
. .

Figure NN
57 CD
: :
Deobfuscated VBN
M2Soft NNP
exploit NNS
used VBD
to TO
deliver VB
Lazarus NNP
FBI-RAT NNP
implant NN

Figure NN
58 CD
: :
Deobfuscated VBN
M2Soft NNP
exploit NNS
used VBD
to TO
deliver VB
Lazarus NNP
Charon NNP
implant NN
Code NNP
Overlap NNP
On IN
or CC
before IN
October NNP
3rd CD
, ,
2017 CD
, ,
the DT
Far NNP
Eastern NNP
International NNP
Bank NNP
( (
FEIB NNP
) )
in IN
Taiwan NNP
was VBD
hacked VBN
by IN
Lazarus NNP
Group NNP
to TO
steal VB
money NN
via IN
the DT
SWIFT NNP
system NN
. .

One CD
of IN
the DT
implants NNS
( (
9cc69d81613285352ce92ec3cb44227af5daa8ad4e483ecc59427fe23b122fce CD
) )
utilized VBN
in IN
that DT
attack NN
was VBD
a DT
loader NN
and CC
spreader NN
that WDT
writes VBZ
itself PRP
to TO
the DT
Windows NNP
temp NN
directory NN
: :
c NN
: :
\windows\temp\ NN
. .

This DT
directory NN
is VBZ
also RB
used VBN
by IN
numerous JJ
other JJ
Lazarus NNP
Group NNP
implants NNS
including VBG
by IN
the DT
RatankbaPOS NNP
dropper NN
for IN
the DT
payload NN
drop NN
location NN
as RB
well RB
as IN
for IN
RatankbaPOS NNP
logging NN
. .

Additionally RB
, ,
there EX
are VBP
several JJ
instances NNS
of IN
code NN
overlap NN
between IN
RatankbaPOS NNP
and CC
the DT
FEIB NNP
spreader NN
implant NN
. .

One CD
such JJ
overlap WDT
includes VBZ
the DT
way NN
in IN
which WDT
each DT
implant NN
sets VBZ
up RP
persistence NN
in IN
almost RB
precisely RB
the DT
same JJ
way NN
( (
Fig NNP
. .

59 CD
) )
. .

Figure NN
59 CD
: :
Registry NN
key JJ
persistence NN
. .

Left VBN
: :
FEIB NNP
spreader NN
, ,
Right NNP
: :
RatankbaPOS NNP
dropper NN
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
31 CD
Decoys NNS
Content NN
found VBD
in IN
a DT
PowerRatankba NNP
JS NNP
downloader NN
decoy NN
( (
transaction.pdf NN
downloaded VBN
by IN
transaction.js NN
) )
was VBD
previously RB
utilized VBN
in IN
Lazarus NNP
campaigns NNS
using VBG
techniques NNS
that WDT
have VBP
more RBR
traditionally RB
, ,
to TO
our PRP$
knowledge NN
, ,
been VBN
used VBN
for IN
espionage NN
rather RB
than IN
for IN
financial JJ
gain NN
. .

The DT
campaign NN
occurred VBD
on IN
August NNP
4th CD
, ,
2017 CD
, ,
where WRB
Lazarus NNP
Group NNP
impersonated VBD
a DT
National NNP
police JJ
officer NN
of IN
South NNP
Korea NNP
along IN
with IN
a DT
malicious JJ
Microsoft NNP
Office NNP
Excel NNP
document NN
. .

The DT
malicious JJ
Excel NNP
attachment NN
utilized VBN
a DT
macro-based JJ
VBScript NNP
XOR NNP
dropper NN
technique NN
that WDT
has VBZ
been VBN
very RB
well RB
documented VBN
in IN
public JJ
already RB
. .

The DT
document NN
used VBN
in IN
this DT
attack NN
was VBD
named VBN
비비비비 NNP
비비비비.xls NN
( (
b46530fa2bd5f9958f664e754ae392dc400bd3fcb1c5adc7130b7374e0409924 NN
) )
, ,
which WDT
roughly RB
translates VBZ
to TO
“ VB
Bitcoin NNP
transaction NN
history. NN
” NN
Using VBG
the DT
macro-based JJ
VBScript NNP
XOR NNP
dropper NN
technique NN
a DT
CoreDn NNP
downloader NN
implant NN
is VBZ
dropped VBN
to TO
disk NN
with IN
a DT
C NNP
& CC
C NNP
of IN
www.unsunozo JJ
[ NNP
. .
] NN
org NN
. .

The DT
interesting JJ
overlap NN
with IN
the DT
PowerRatankba NNP
campaigns NNS
can MD
be VB
found VBN
in IN
the DT
lure NN
used VBN
by IN
the DT
Excel NNP
spreadsheet NN
( (
Fig NNP
. .

60 CD
) )
. .

The DT
highlighted JJ
transactions NNS
, ,
after IN
the DT
“ NNP
Final NNP
bitcoin NN
Address NNP
” NNP
section NN
match NN
with IN
the DT
beginning NN
of IN
the DT
transactions NNS
used VBN
in IN
the DT
PowerRatankba NNP
decoy NN
transaction.pdf NN
. .

Figure NN
60 CD
: :
Excel NNP
CoreDn NNP
~tmp001.xls NNP
decoy NN
on IN
the DT
left NN
, ,
PowerRatankba NNP
transaction.pdf VBZ
decoy NN
on IN
the DT
right NN
On IN
a DT
final JJ
note NN
for IN
this DT
aspect NN
of IN
the DT
actor NN
attribution NN
, ,
campaigns NNS
utilizing VBG
the DT
VBScript NNP
XOR NNP
macro NN
technique NN
have VBP
historically RB
been VBN
used VBN
for IN
attacks NNS
more RBR
closely RB
associated VBN
with IN
espionage NN
than IN
for IN
direct JJ
financial JJ
gain NN
, ,
as IN
was VBD
the DT
case NN
when WRB
several JJ
campaigns NNS
targeted VBD
the DT
personal JJ
accounts NNS
of IN
employees NNS
at IN
US NNP
defense NN
contractors NNS
. .

This DT
behavior NN
may MD
offer VB
a DT
clue NN
as IN
to TO
the DT
desperation NN
North NNP
Korea NNP
has VBZ
for IN
procuring VBG
currency NN
through IN
illicit NN
means NNS
, ,
possibly RB
due JJ
to TO
the DT
economic JJ
sanctions NNS
imposed VBN
on IN
the DT
regime NN
. .

This DT
may MD
indicate VB
that IN
there EX
has VBZ
been VBN
a DT
significant JJ
shift NN
in IN
directives NNS
for IN
the DT
Lazarus NNP
team NN
( (
s PRP
) )
that WDT
historically RB
conducted VBD
espionage JJ
campaigns NNS
. .

Furthermore RB
, ,
several JJ
of IN
the DT
campaigns NNS
utilizing VBG
the DT
old JJ
VBScript NN
XOR JJ
macro NN
technique NN
have VBP
direct JJ
or CC
within-one-week JJ
overlap NN
with IN
PowerRatankba NNP
campaigns NNS
alluding VBG
to TO
the DT
possibility NN
that IN
there EX
is VBZ
in IN
fact NN
more JJR
than IN
one CD
team NN
working VBG
under IN
the DT
North JJ
Korean JJ
umbrella NN
as IN
other JJ
companies NNS
have VBP
suggested VBN
( (
e.g. NN
, ,
Kaspersky NNP
’ NNP
s JJ
excellent JJ
write-up NN
on IN
Bluenoroff NNP
) )
. .

C NNP
& CC
C NNP
A DT
report NN
was VBD
found VBN
in IN
a DT
Facebook NNP
post NN
from IN
mickeyfintech NN
that WDT
listed VBD
a DT
domain NN
utilized VBN
in IN
several JJ
PowerRatankba NNP
campaigns NNS
as IN
being VBG
associated VBN
with IN
infrastructure NN
utilized VBN
in IN
the DT
breach NN
of IN
the DT
FEIB NNP
( (
Fig NNP
. .

61 CD
) )
. .

The DT
domain NN
, ,
trade.publicvm JJ
[ NN
. .

] NN
com NN
, ,
was VBD
allegedly RB
connected VBN
to TO
the DT
FEIB NNP
hack NN
. .

That DT
domain NN
was VBD
also RB
used VBN
by IN
several JJ
PowerRatankba NNP
downloaders NNS
and CC
payloads NNS
for IN
hosting VBG
as RB
well RB
as IN
C NNP
& CC
C NNP
. .

This DT
is VBZ
a DT
low JJ
confidence NN
indicator NN
as IN
we PRP
have VBP
been VBN
unable JJ
to TO
corroborate VB
if IN
that DT
domain NN
was VBD
in IN
fact NN
utilized VBN
by IN
Lazarus NNP
in IN
the DT
hacking NN
of IN
the DT
FEIB NNP
. .

Figure NN
61 CD
: :
Facebook NN
post NN
listing NN
PowerRatankba NNP
domain NN
as IN
being VBG
associated VBN
with IN
FEIB NNP
breach NN

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
32 CD
Conclusion NN
This DT
report NN
has VBZ
introduced VBN
several JJ
new JJ
additions NNS
to TO
Lazarus NNP
Group NNP
’ NNP
s VBD
ever-growing JJ
arsenal JJ
, ,
including VBG
a DT
variety NN
of IN
different JJ
attack NN
vectors NNS
, ,
a DT
new JJ
PowerShell NNP
implant NN
and CC
Gh0st NNP
RAT NNP
variant NN
, ,
as RB
well RB
as IN
an DT
emerging VBG
point-of-sale JJ
threat NN
targeting VBG
South JJ
Korean JJ
devices NNS
. .

In IN
addition NN
to TO
insight VB
into IN
Lazarus NNP
’ NNP
emerging VBG
toolset NN
, ,
there EX
are VBP
two CD
key JJ
takeaways NNS
from IN
this DT
research NN
: :
• NN
Analyzing VBG
a DT
financially RB
motivated JJ
arm NN
of IN
a DT
state NN
actor NN
highlights VBD
an DT
often RB
overlooked JJ
or CC
underestimated JJ
aspect NN
of IN
state- NN
sponsored JJ
attacks NNS
; :
in IN
this DT
case NN
, ,
we PRP
were VBD
able JJ
to TO
differentiate VB
the DT
actions NNS
of IN
the DT
financially RB
motivated JJ
team NN
within IN
Lazarus NNP
from IN
those DT
of IN
their PRP$
espionage NN
and CC
disruption NN
teams NNS
that WDT
have VBP
recently RB
grabbed VBN
headlines NNS
. .

• NN
This DT
group NN
now RB
appears VBZ
to TO
be VB
targeting VBG
individuals NNS
rather RB
than IN
just RB
organizations NNS
: :
individuals NNS
are VBP
softer JJR
targets NNS
, ,
often RB
lacking VBG
resources NNS
and CC
knowledge NN
to TO
defend VB
themselves PRP
and CC
providing VBG
new JJ
avenues NNS
of IN
monetization NN
for IN
a DT
state- JJ
sponsored VBN
threat NN
actor NN
’ NNP
s VBZ
toolkit NN
. .

• NN
Moreover RB
, ,
both PDT
the DT
explosive JJ
growth NN
in IN
cryptocurrency NN
values NNS
and CC
the DT
emergence NN
of IN
new JJ
point-of-sale JJ
malware NN
near IN
the DT
peak JJ
holiday NN
shopping NN
season NN
provide VBP
an DT
interesting JJ
example NN
of IN
how WRB
one CD
state-sponsored JJ
actor NN
is VBZ
following VBG
the DT
money NN
, ,
adding VBG
direct JJ
theft NN
from IN
individuals NNS
and CC
organizations NNS
to TO
the DT
more JJR
“ JJ
traditional JJ
” NNP
approach NN
of IN
targeting VBG
financial JJ
institutions NNS
for IN
espionage NN
that IN
we PRP
often RB
observe VBP
with IN
other JJ
APT NNP
actors NNS
. .

Research NN
Contributions NNS
Proofpoint NN
Kafeine NNP
( (
@ NNP
kafeine NN
) )
Matthew NNP
Mesa NNP
( (
@ NNP
mesa_matt NN
) )
Kimberly NNP
( (
@ NNP
StopMalvertisin NNP
) )
James NNP
Emory NNP
( (
@ NNP
sudosev NN
) )
External JJ
Malc0de NNP
( (
@ NNP
malc0de NN
) )
Adam NNP
( (
@ NNP
infosecatom NN
) )
Jacob NNP
Soo NNP
( (
@ NNP
_jsoo_ NNP
) )
Special JJ
Thanks NNS
We PRP
would MD
like VB
to TO
thank VB
Yonathan NNP
Klijnsma NNP
( (
@ NNP
ydklijnsma NN
) )
and CC
RisqIQ NNP
( (
@ NNP
RiskIQ NNP
) )
for IN
supporting VBG
this DT
research NN
by IN
sharing VBG
data NNS
and CC
assisting VBG
with IN
some DT
of IN
the DT
infrastructure NN
analysis NN
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
33 CD
Indicators NNS
of IN
Compromise NNP
( (
IOCs NNP
) )
PowerSpritz NNP
ITW NNP
URLs NNP
hxxp NN
: :
//skype.2 JJ
[ NN
. .

] NN
vu/1 NN
hxxp NN
: :
//skype.2 JJ
[ NN
. .

] NN
vu/k NN
hxxp NN
: :
//skypeupdate.2 JJ
[ NN
. .

] NN
vu/1 NN
hxxp NN
: :
//telegramupdate.2 JJ
[ NN
. .

] NN
vu/5 NN
hxxps NN
: :
//doc-00-64-docs.googleusercontent JJ
[ NN
. .

] NN
com/docs/securesc/ NN
ha0ro937gcuc7l7deffksulhg5h7mbp1/39cbphg8k5qve4q5rr6nonee NN
1bueiu8o/1499428800000/13030420262846080952/*/0B63J1WTZC49h CD
X1JnZUo4Y1pnRG8 NN
? .
e=download NN
hxxps NN
: :
//drive.google NN
[ NN
. .

] NN
com/uc NN
? .
export=download NN
& CC
id=0B63J1WTZC49hdDR0clR3cFpITVE NN
hxxp NN
: :
//201.211.183 JJ
[ NN
. .

] $
215:8080/update.php CD
? .
t=Skype NN
& CC
r=update NN
hxxp NN
: :
//122.248.34 JJ
[ NN
. .

] $
23/lndex.php CD
? .
t=SkypeSetup NN
& CC
r=mail_new NN
hxxp NN
: :
//122.248.34 JJ
[ NN
. .

] $
23/lndex.php CD
? .
t=Telegram NN
& CC
r=1.1.9 NN
PowerSpritz NNP
Hashes NNP
cbebafb2f4d77967ffb1a74aac09633b5af616046f31dddf899019ba78a55411 NN
9ca3e56dcb2d1b92e88a0d09d8cab2207ee6d1f55bada744ef81e8b8cf155453 CD
5a162898a38601e41d538f067eaf81d6a038268bc52a86cf13c2e43ca2487c07 CD
PowerSpritz NNP
C NNP
& CC
C NNP
hxxp NN
: :
//dogecoin.deaftone NN
[ NN
. .

] NN
com:8080/mainls.cs NN
hxxp NN
: :
//macintosh JJ
[ NN
. .
] CC
linkpc JJ
[ NN
. .

] NN
net:8080/mainls.cs NN
Microsoft NNP
Compiled NNP
HTML NNP
Help NNP
( (
CHM NNP
) )
Hashes NNP
81617bd4fa5d6c1a703c40157fbe16c55c11260723b7f63de022fd5dd241bdbf CD
d5f9a81df5061c69be9c0ed55fba7d796e1a8ebab7c609ae437c574bd7b30b48 NN
4eb2dd5e90bda6da5efbd213c8472775bdd16e67bcf559f58802a8c371848212 CD
01b047e0f3b49f8ab6ebf6795bc72ba7f63d7acbc68f65f1f8f66e34de827e49 CD
I3e91f399d207178a5aa6de3d680b58fc3f239004e541a8bff2cc3e851b76e8bb NN
9d10911a7bbf26f58b5e39342540761885422b878617f864bfdb16195b7cd0f5 CD
85a263fc34883fc514be48da2d814f1b43525e63049c6b180c73c8ec00920f51 CD
6cb1e9850dd853880bbaf68ea23243bac9c430df576fa1e679d7f26d56785984 CD
772b9b873100375c9696d87724f8efa2c8c1484853d40b52c6dc6f7759f5db01 CD
6d4415a2cbedc960c7c7055626c61842b3a3ca4718e2ac0e3d2ac0c7ef41b84d CD
030b4525558f2c411f972d91b144870b388380b59372e1798926cc2958242863 CD
Microsoft NNP
Compiled NNP
HTML NNP
Help NNP
( (
CHM NNP
) )
C NNP
& CC
C NNP
hxxp NN
: :
//92.222.106 JJ
[ NN
. .

] $
229/theme.gif CD
hxxp NN
: :
//www.businesshop NN
[ NN
. .

] NN
net/hide.gif NN
MS NNP
Shortcut NNP
Link NNP
( (
LNK NNP
) )
Hashes NNP
beecb33ef8adec99bbba3b64245c7230986c3c1a7f3246b0d26c641887387bfe NN
8f0b83d4ff6d8720e134b467b34728c2823c4d75313ef6dce717b06f414bdf5c CD
MS NNP
Shortcut NNP
Link NNP
( (
LNK NNP
) )
C NNP
& CC
C NNP
hxxp NN
: :
//tinyurl JJ
[ NN
. .

] NN
com/y9jbk8cg NN
hxxp NN
: :
//201.211.183 JJ
[ NN
. .

] $
215:8080/pdfviewer.php CD
? .
o=0 NN
& CC
t=report NN
& CC
m=0 NN
JavaScript NNP
Hashes NNP
e7581e1f112edc7e9fbb0383dd5780c4f2dd9923c4acc09b407f718ab6f7753d NN
7975c09dd436fededd38acee9769ad367bfe07c769770bd152f33a10ed36529e CD
100c6400331fa1919958bed122b88f1599a61b3bb113d98b218a535443ebc3a7 CD
8ff100ca86cb62117f1290e71d5f9c0519661d6c955d9fcfb71f0bbdf75b51b3 CD
97c6c69405ed721a64c158f18ab4386e3ade19841b0dea3dcce6b521faf3a660 CD
41ee2947356b26e4d8aca826ae392be932cd8800476840713e9b6c630972604f CD
25f13dca780bafb0001d521ea6e76a3bd4dd74ce137596b948d41794ece59a66 CD
JavaScript NNP
C NNP
& CC
C NNP
hxxp NN
: :
//51.255.219 JJ
[ NN
. .

] $
82/files/download/falconcoin.zip CD
hxxp NN
: :
//51.255.219 JJ
[ NN
. .

] $
82/theme.gif CD
hxxp NN
: :
//51.255.219 JJ
[ NN
. .

] NN
.82/files/download/falconcoin.pdf NN
hxxp NN
: :
//apps.got-game JJ
[ NN
. .

] NN
org/images/character.gif NN
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
34 CD
hxxp NN
: :
//apps.got-game JJ
[ NN
. .

] NN
org/files/download/transaction.pdf NN
hxxp NN
: :
//www.energydonate NN
[ NN
. .

] NN
com/files/download/bithumb.zip NN
hxxp NN
: :
//www.energydonate NN
[ NN
. .

] NN
com/images/character.gif NN
hxxp NN
: :
//www.energydonate NN
[ NN
. .

] NN
com/files/download/bithumb.pdf NN
MS NNP
Office NNP
Docs NNP
Hashes NNP
b3235a703026b2077ccfa20b3dabd82d65c6b5645f7f15e7bbad1ce8173c7960 NN
b9cf1cba0f626668793b9624e55c76e2dab56893b21239523f2a2a0281844c6d NN
972b598d709b66b35900dc21c5225e5f0d474f241fefa890b381089afd7d44ee CD
MS NNP
Office NNP
Docs NNP
C NNP
& CC
C NNP
198.100.157 CD
[ NN
. .

] $
239 CD
hxxp NN
: :
//www.energydonate NN
[ NN
. .

] NN
com/files/download/Bithumb.zip NN
hxxp NN
: :
//www.energydonate NN
[ NN
. .

] NN
com/images/character.gif NN
PyInstaller NNP
Hashes NNP
b530de08530d1ba19a94bc075e74e2236c106466dedc92be3abdee9908e8cf7e NN
eab612e333baaec0709f3f213f73388607e495d8af9a2851f352481e996283f1 NN
eb372423e4dcd4665cc03ffc384ff625ae4afd13f6d0589e4568354be271f86e NN
PyInstaller NNP
Hosting NNP
or CC
Email NNP
IDNA NNP
xn DT
-- :
bitcin-zxa JJ
[ NN
. .

] NN
org NN
xn DT
-- :
electrm-s2a JJ
[ NN
. .

] NN
org NN
xn DT
-- :
bitcingold-hcb JJ
[ NN
. .

] NN
org NN
xn DT
-- :
bitcoigold-o1b JJ
[ NN
. .

] NN
com NN
xn DT
-- :
bitcoingld-lcb JJ
[ NN
. .

] NN
com NN
xn DT
-- :
bitcoingld-lcb JJ
[ NN
. .

] NN
org NN
xn DT
-- :
bitcoingod-8yb JJ
[ NN
. .

] NN
com NN
xn DT
-- :
btcongold-54ad JJ
[ NN
. .

] NN
com NN
xn DT
-- :
btcongold-g5ad JJ
[ NN
. .

] NN
com NN
Likely RB
Related VBN
IDNA NN
xn NN
-- :
6fgp CD
[ NN
. .

] NN
com NN
xn DT
-- :
bitcingold-5bb NN
. .

[ JJ
] NNP
com NN
xn DT
-- :
bitcingold-jbb JJ
[ NN
. .

] NN
com NN
xn DT
-- :
bitcingold-t3b JJ
[ NN
. .

] NN
com NN
xn DT
-- :
bitcoingol-4kb JJ
[ NN
. .

] NN
com NN
xn DT
-- :
bitoingold-1ib JJ
[ NN
. .

] NN
com NN
xn DT
-- :
btcoingold-v8a JJ
[ NN
. .

] NN
com NN
xn DT
-- :
bitcoingldwallet-twb JJ
[ NN
. .

] NN
org NN
PyInstaller NNP
C NNP
& CC
C NNP
hxxp NN
: :
//www.btc-gold JJ
[ NN
. .

] NN
us/images/top_bar.gif NN
hxxp NN
: :
//trade.publicvm JJ
[ NN
. .

] NN
com/images/top_bar.gif NN
PowerRatankba NNP
Hashes NNP
41f155f039448edb42c3a566e7b8e150829b97d83109c0c394d199cdcfd20f9b CD
20f7e342a5f3224cab8f0439e2ba02bb051cd3e1afcd603142a60ac8af9699ba CD
db8163d054a35522d0dec35743cfd2c9872e0eb446467b573a79f84d61761471 NN
3cd0689b2bae5109caedeb2cf9dd4b3a975ab277fadbbb26065e489565470a5c CD
b265a5d984c4654ac0b25ddcf8048d0aabc28e36d3e2439d1c08468842857f46 NN
1768f2e9cea5f8c97007c6f822531c1c9043c151187c54ebfb289980ff63d666 CD
99ad06cca4910c62e8d6b68801c6122137cf8458083bb58cbc767eebc220180d CD
f7f2dd674532056c0d67ef1fb7c8ae8dd0484768604b551ee9b6c4405008fe6b NN
d844777dcafcde8622b9472b6cd442c50c3747579868a53a505ef2f5a4f0e26a NN
NOTE NN
: :
Several JJ
of IN
these DT
domains NNS
reflect VBP
themes NNS
and CC
brands NNS
( (
only RB
BTG NNP
) )
that WDT
are VBP
confirmed VBN
to TO
have VB
been VBN
used VBN
in IN
phishing VBG
attacks NNS
. .

Additionally RB
, ,
they PRP
were VBD
registered VBN
in IN
the DT
same JJ
timeframe NN
, ,
at IN
the DT
same JJ
registrar NN
, ,
with IN
matching VBG
server NN
characteristics NNS
that WDT
were VBD
observed VBN
in IN
the DT
confirmed JJ
IDNA NNP
infrastructure NN
domains NNS
. .

These DT
domains NNS
in IN
no DT
way NN
indicate VBP
that IN
they PRP
have VBP
been VBN
used VBN
for IN
attacks NNS
, ,
nor CC
that IN
the DT
themes NNS
utilized JJ
indicate VBP
that IN
the DT
entity NN
in IN
question NN
has VBZ
been VBN
targeted VBN
or CC
compromised VBN
. .

We PRP
simply RB
assess VBD
that IN
this DT
infrastructure NN
is VBZ
related VBN
to TO
Lazarus NNP
Group NNP
and CC
currently RB
do VBP
not RB
know VB
how WRB
or CC
if IN
it PRP
was VBD
utilized VBN
for IN
campaigns NNS
. .

North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
35 CD
PowerRatankba NNP
C NNP
& CC
C NNP
51.255.219 CD
[ NN
. .

] $
82 CD
144.217.51 CD
[ NN
. .

] $
246 CD
158.69.57 CD
[ NN
. .

] $
135 CD
198.100.157 CD
[ NN
. .

] $
239 CD
201.139.226 CD
[ NN
. .

] $
67 CD
92.222.106 CD
[ NN
. .

] $
229 CD
apps.got-game JJ
[ NN
. .

] NN
org NN
trade.publicvm NN
[ NN
. .

] NN
com NN
www.businesshop NN
[ NN
. .

] JJ
net NN
vietcasino.linkpc NN
[ NN
. .

] JJ
net NN
Related JJ
Unknown NNP
Purpose NNP
C NNP
& CC
C NNP
coinbases NNS
[ VBP
. .

] NN
org NN
africawebcast NN
[ NN
. .

] NN
com NN
bitforex.linkpc NN
[ NN
. .

] JJ
net NN
macintosh.linkpc NN
[ NN
. .

] JJ
net NN
coinbroker.linkpc NN
[ NN
. .

] JJ
net NN
moneymaker.publicvm NN
[ NN
. .

] NN
com NN
RFC18 NNP
Gh0st NNP
RAT NNP
3a856d8c835232fe81711680dc098ed2b21a4feda7761ed39405d453b4e949f6 CD
RFC18 NNP
Gh0st NNP
RAT NNP
Download NNP
Locations NNP
hxxp NN
: :
//180.235.133 JJ
[ NN
. .

] $
235/img.gif CD
hxxp NN
: :
//180.235.133 JJ
[ NN
. .

] $
121/images/img.gif CD
RFC18 NNP
Gh0st NNP
RAT NNP
C NNP
& CC
C NNP
180.235.133 CD
[ NN
. .

] $
235:443 CD
180.235.133 CD
[ NN
. .

] $
121:443 CD
51.255.219 CD
[ NN
. .

] $
82:443 CD
158.69.57 CD
[ NN
. .

] $
135:443 CD
RatankbaPOS NNP
ITW NNP
hxxp NN
: :
//www.webkingston NN
[ NN
. .

] NN
com/top.gif NN
RatankbaPOS NNP
Hashes NNP
b66624ab8591c2b10730b7138cbf44703abec62bfc7774d626191468869bf21c NN
79a4b6329e35e23c3974960b2cecc68ee30ce803619158ef3fefcec5d4671c98 CD
d334c40b42d2e6286f0553ae9e6e73e7e7aaec04a85df070b790738d66fd14fb NN
2b05a692518a6102c540e209cb4eb1391b28944fdb270aef7ea47e1ddeff5ae2 CD
RatankbaPOS NNP
Loader NNP
C NNP
& CC
C NNP
hxxp NN
: :
//www.webkingston NN
[ NN
. .

] NN
com/update.jsp NN
? .
action=need_update NN
RatankbaPOS NNP
Exfiltration NNP
C NNP
& CC
C NNP
hxxp NN
: :
//www.energydonate NN
[ NN
. .

] NN
com/list.jsp NN
? .
action=up NN
hxxp NN
: :
//online-help JJ
[ NN
. .
] CC
serveftp JJ
[ NN
. .

] NN
com/list.jsp NN
? .
action=up NN
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
36 CD
ET NNP
and CC
ETPRO NNP
Suricata/Snort NNP
Signatures NNP
2824864 CD
, ,
ETPRO NNP
TROJAN NNP
Ratankba NNP
Recon NNP
Backdoor/Module NNP
CnC NNP
Beacon NNP
1 CD
2828904 CD
, ,
ETPRO NNP
TROJAN NNP
RatankbaPOS NNP
Dropper NNP
CnC NNP
Checkin NNP
M1 NNP
2828905 CD
, ,
ETPRO NNP
TROJAN NNP
RatankbaPOS NNP
Dropper NNP
CnC NNP
Checkin NNP
M2 NNP
2828906 CD
, ,
ETPRO NNP
TROJAN NNP
RatankbaPOS NNP
CnC NNP
Checkin NNP
2828921 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
1 CD
2828922 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
2 CD
2828923 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
3 CD
2828924 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
4 CD
2828925 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
5 CD
2828926 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
6 CD
2828927 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
7 CD
2828928 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
8 CD
2828929 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
9 CD
2828930 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
10 CD
2828931 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
11 CD
2828932 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
12 CD
2828933 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
13 CD
2828934 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
14 CD
2828935 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
15 CD
2828936 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
16 CD
2828937 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
17 CD
2828938 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
18 CD
2828939 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
19 CD
2828940 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
20 CD
2828941 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
21 CD
2828942 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
22 CD
2828943 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
23 CD
2828944 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
24 CD
2828945 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
25 CD
2828946 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
26 CD
2828947 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
27 CD
2828948 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
28 CD
2828949 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
29 CD
2828950 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
30 CD
2828951 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
31 CD
2828952 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
32 CD
2828953 CD
, ,
ETPRO NNP
TROJAN NNP
PowerRatankba NNP
DNS NNP
Lookup NNP
33 CD
2828971 CD
, ,
ETPRO NNP
TROJAN NNP
RatankbaPOS NNP
POS NNP
Exfiltration NNP
North NNP
Korea NNP
Bitten NNP
by IN
Bitcoin NNP
Bug NNP
37 CD
www.proofpoint.com NN

