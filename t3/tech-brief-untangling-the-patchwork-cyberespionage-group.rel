TrendLabs NN O O

Table NN O O
of IN O O
Contents NNS O O
Infection NN O O
Vectors NNS O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
. . O O
2 CD O O
Spear-phishing JJ O O
Emails NNS O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
.. VBZ O O
2 CD O O
Website JJ O O
Redirects NNS O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
.. VBZ O O
2 CD O O
Direct JJ O O
Links NNS O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
. . O O
3 CD O O
Malicious JJ O O
Attachments NNS O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
. . O O
3 CD O O
Mail NNP O O
Sending NNP O O
Method NNP O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
3 CD O O
Drive-by NNP O O
Download NNP O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
. . O O
3 CD O O
Phishing VBG O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
3 CD O O
Social NNP O O
Engineering NNP O O
and CC O O
Weaponized NNP O O
Documents NNS O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
.. VBZ O O
7 CD O O
Downloaders NNS O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
.. VBZ O O
10 CD O O
Simple JJ O O
Downloaders NNS O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
10 CD O O
DDE NNP O O
Downloader NNP O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
.. VBZ O O
12 CD O O
Payloads NNS O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
12 CD O O
xRAT NN O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
12 CD O O
NDiskMonitor NN O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
.. VBZ O O
13 CD O O
Socksbot NN O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
.. VBZ O O
14 CD O O
Badnews NNP O O
Backdoor NNP O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
. . O O
16 CD O O
File NN O O
Stealers NNS O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
. . O O
19 CD O O
Taskhost NNP O O
Stealer NNP O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
19 CD O O
Wintel NNP O O
Stealer NNP O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
. . O O
23 CD O O
AutoIt NNP O O
Stealer NNP O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
.. VBZ O O
24 CD O O
Infrastructure NN O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
.. VBZ O O
25 CD O O
Practice NNP O O
Defense NNP O O
in IN O O
Depth NNP O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
... : O O
.. VBZ O O
26 CD O O

TREND NNP O O
MICRO NNP O O
LEGAL NNP O O
DISCLAIMER NNP O O
The DT O O
information NN O O
provided VBD O O
herein NN O O
is VBZ O O
for IN O O
general JJ O O
information NN O O
and CC O O
educational JJ O O
purposes NNS O O
only RB O O
. . O O

It PRP O O
is VBZ O O
not RB O O
intended VBN O O
and CC O O
should MD O O
not RB O O
be VB O O
construed VBN O O
to TO O O
constitute VB O O
legal JJ O O
advice NN O O
. . O O

The DT O O
information NN O O
contained VBD O O
herein NN O O
may MD O O
not RB O O
be VB O O
applicable JJ O O
to TO O O
all DT O O
situations NNS O O
and CC O O
may MD O O
not RB O O
reflect VB O O
the DT O O
most RBS O O
current JJ O O
situation NN O O
. . O O

Nothing NN O O
contained VBD O O
herein NN O O
should MD O O
be VB O O
relied VBN O O
on IN O O
or CC O O
acted VBN O O
upon IN O O
without IN O O
the DT O O
benefit NN O O
of IN O O
legal JJ O O
advice NN O O
based VBN O O
on IN O O
the DT O O
particular JJ O O
facts NNS O O
and CC O O
circumstances NNS O O
presented VBN O O
and CC O O
nothing NN O O
herein NN O O
should MD O O
be VB O O
construed VBN O O
otherwise RB O O
. . O O

Trend NNP O O
Micro NNP O O
reserves NNS O O
the DT O O
right NN O O
to TO O O
modify VB O O
the DT O O
contents NNS O O
of IN O O
this DT O O
document NN O O
at IN O O
any DT O O
time NN O O
without IN O O
prior JJ O O
notice NN O O
. . O O

Translations NNS O O
of IN O O
any DT O O
material NN O O
into IN O O
other JJ O O
languages NNS O O
are VBP O O
intended VBN O O
solely RB O O
as IN O O
a DT O O
convenience NN O O
. . O O

Translation NN O O
accuracy NN O O
is VBZ O O
not RB O O
guaranteed VBN O O
nor CC O O
implied VBN O O
. . O O

If IN O O
any DT O O
questions NNS O O
arise VBP O O
related VBN O O
to TO O O
the DT O O
accuracy NN O O
of IN O O
a DT O O
translation NN O O
, , O O
please VB B-Entity 1
refer NN I-Entity O
to TO I-Entity O
the DT I-Entity O
original JJ I-Entity O
language NN I-Entity O
official JJ I-Entity O
version NN I-Entity O
of IN I-Entity O
the DT I-Entity O
document NN I-Entity O
. . O O

Any DT O O
discrepancies NNS O O
or CC O O
differences NNS O O
created VBN O O
in IN O O
the DT O O
translation NN O O
are VBP O O
not RB O O
binding VBG O O
and CC O O
have VBP O O
no DT O O
legal JJ O O
effect NN O O
for IN O O
compliance NN O O
or CC O O
enforcement NN O O
purposes NNS O O
. . O O

Although IN O O
Trend NNP O O
Micro NNP O O
uses VBZ O O
reasonable JJ O O
efforts NNS O O
to TO O O
include VB O O
accurate JJ O O
and CC O O
up-to-date JJ O O
information NN O O
herein NN O O
, , O O
Trend NNP O O
Micro NNP O O
makes VBZ O O
no DT O O
warranties NNS O O
or CC O O
representations NNS O O
of IN O O
any DT O O
kind NN O O
as IN O O
to TO O O
its PRP$ O O
accuracy NN O O
, , O O
currency NN O O
, , O O
or CC O O
completeness NN O O
. . O O

You PRP O O
agree VBP O O
that IN O O
access NN O O
to TO O O
and CC O O
use NN O O
of IN O O
and CC O O
reliance VB O O
on IN O O
this DT O O
document NN O O
and CC O O
the DT O O
content NN O O
thereof NN O O
is VBZ O O
at IN O O
your PRP$ O O
own JJ O O
risk NN O O
. . O O

Trend NNP O O
Micro NNP O O
disclaims VBZ O O
all DT O O
warranties NNS O O
of IN O O
any DT O O
kind NN O O
, , O O
express NN O O
or CC O O
implied VBN O O
. . O O

Neither DT O O
Trend NNP O O
Micro NNP O O
nor CC O O
any DT O O
party NN O O
involved VBN O O
in IN O O
creating VBG O O
, , O O
producing VBG O O
, , O O
or CC O O
delivering VBG B-Action 1
this DT B-Entity 2
document NN I-Entity O
shall MD I-Entity O
be VB I-Entity O
liable JJ I-Entity O
for IN I-Entity O
any DT I-Entity O
consequence NN I-Entity O
, , I-Entity O
loss NN I-Entity O
, , I-Entity O
or CC I-Entity O
damage NN I-Entity O
, , O O
including VBG O O
direct JJ O O
, , O O
indirect JJ O O
, , O O
special JJ O O
, , O O
consequential JJ O O
, , O O
loss NN O O
of IN O O
business NN O O
profits NNS O O
, , O O
or CC O O
special JJ O O
damages NNS O O
, , O O
whatsoever RB O O
arising VBG O O
out IN O O
of IN O O
access NN O O
to TO O O
, , O O
use NN O O
of IN O O
, , O O
or CC O O
inability NN O O
to TO O O
use VB O O
, , O O
or CC O O
in IN O O
connection NN O O
with IN O O
the DT O O
use NN O O
of IN O O
this DT O O
document NN O O
, , O O
or CC O O
any DT O O
errors NNS O O
or CC O O
omissions NNS O O
in IN O O
the DT O O
content NN O O
thereof NN O O
. . O O

Use NN O O
of IN O O
this DT O O
information NN O O
constitutes VBZ O O
acceptance NN O O
for IN O O
use NN O O
in IN O O
an DT O O
“ NN O O
as IN O O
is VBZ O O
” JJ O O
condition NN O O
. . O O

Patchwork NN O O
( ( O O
also RB O O
known VBN O O
as IN O O
Dropping NNP O O
Elephant NNP O O
) ) O O
is VBZ O O
a DT O O
cyberespionage NN O O
group NN O O
whose WP$ O O
targets NNS O O
included VBD O O
diplomatic JJ O O
and CC O O
government NN O O
agencies NNS O O
as RB O O
well RB O O
as IN O O
businesses NNS O O
. . O O

Patchwork NN O O
is VBZ O O
known VBN O O
for IN O O
rehashing VBG O O
off-the- JJ O O
rack NN O O
tools NNS O O
and CC O O
malware NN O O
for IN O O
its PRP$ O O
own JJ O O
campaigns NNS O O
. . O O

The DT B-Entity 1
group NN I-Entity O
uses VBZ I-Entity O
attack NN I-Entity O
vectors NNS I-Entity O
that WDT I-Entity O
may MD I-Entity O
not RB I-Entity O
be VB I-Entity O
groundbreaking—what RB I-Entity O
with IN I-Entity O
other JJ I-Entity O
groups NNS I-Entity O
exploiting VBG I-Entity O
zero-days NNS I-Entity O
or CC I-Entity O
cunningly RB I-Entity O
adjusting VBG I-Entity O
their PRP$ I-Entity O
tactics—but NN I-Entity O
as IN I-Entity O
its PRP$ I-Entity O
moniker NN I-Entity O
entails NNS I-Entity O
, , I-Entity O
its PRP$ I-Entity O
repertoire NN I-Entity O
of IN I-Entity O
infection NN I-Entity O
vectors NNS I-Entity O
and CC I-Entity O
payloads NNS I-Entity O
still RB O O
makes VBZ O O
them PRP O O
a DT O O
credible JJ O O
threat NN O O
. . O O

We PRP O O
trailed VBD O O
Patchwork NNP O O
’ NNP O O
s NN O O
activities NNS O O
over IN O O
the DT O O
course NN O O
of IN O O
its PRP$ O O
campaigns NNS O O
in IN O O
2017 CD O O
. . O O

The DT O O
diversity NN O O
of IN O O
their PRP$ O O
methods NNS O O
is VBZ O O
notable—from IN O O
the DT O O
social JJ O O
engineering NN O O
hooks NNS O O
, , O O
attack NN O O
chains NNS O O
, , O O
and CC O O
backdoors NNS O O
they PRP O O
deployed VBP O O
. . O O

They PRP O O
also RB O O
included JJ O O
Dynamic NNP O O
Data NNP O O
Exchange NNP O O
( ( O O
DDE NNP O O
) ) O O
and CC O O
Windows NNP O O
Script NNP O O
Component NNP O O
( ( O O
SCT NNP O O
) ) O O
abuse NN O O
to TO O O
their PRP$ O O
tactics NNS O O
, , O O
as IN O O
well RB O O
as IN O O
started VBN O O
exploiting VBG O O
recently RB O O
reported VBN O O
vulnerabilities NNS O O
. . O O

These DT O O
imply VBP O O
they PRP O O
’ VBP O O
re NNS O O
at IN O O
least JJS O O
keeping VBG O O
an DT O O
eye NN O O
on IN O O
other JJ O O
threats NNS O O
and CC O O
security NN O O
flaws NNS O O
to TO O O
repurpose VB O O
for IN O O
their PRP$ O O
own JJ O O
ends NNS O O
. . O O

Also RB O O
of IN O O
note NN O O
are VBP O O
its PRP$ O O
attempts NNS O O
to TO O O
be VB O O
more JJR O O
cautious JJ O O
and CC O O
efficient JJ O O
in IN O O
their PRP$ O O
operations NNS O O
. . O O

This DT O O
technical JJ O O
brief NN O O
provides VBZ O O
deeper JJR O O
analyses NNS O O
of IN O O
their PRP$ O O
campaigns—from NN O O
the DT O O
infection NN O O
vectors NNS O O
and CC O O
social JJ O O
engineering NN O O
to TO O O
the DT O O
infrastructure NN O O
and CC O O
malware NN O O
they PRP O O
used VBD O O
. . O O

The DT O O
indicators NNS O O
of IN O O
compromise NN O O
are VBP O O
in IN O O
this DT O O
appendix NN O O
. . O O

Spear-phishing JJ O O
emails NNS O O
are VBP O O
their PRP$ O O
staple JJ O O
method NN O O
for IN O O
delivering VBG O O
malware NN O O
. . O O

These DT O O
socially RB O O
engineered VBN O O
emails NNS O O
contain NN O O
web JJ O O
links NNS O O
of IN O O
weaponized JJ O O
documents NNS O O
containing VBG O O
exploits NNS O O
or CC O O
macros NNS O O
. . O O

We PRP O O
found VBD O O
Patchwork NNP O O
using VBG O O
three CD O O
variations NNS O O
of IN O O
this DT O O
method NN O O
. . O O

Patchwork NN O O
set VBN O O
up RP O O
an DT O O
English-language JJ O O
news NN O O
site NN O O
. . O O

The DT O O
spoofed JJ O O
website JJ O O
looks VBZ O O
exactly RB O O
like IN O O
the DT O O
legitimate JJ O O
and CC O O
original JJ O O
website NN O O
. . O O

Inspection NN O O
of IN O O
the DT O O
fake JJ O O
site NN O O
’ NNP O O
s VBZ O O
HTML NNP O O
source NN O O
code NN O O
, , O O
however RB O O
, , O O
reveals VBZ O O
the DT O O
addition NN O O
of IN O O
a DT O O
small JJ O O
code NN O O
snippet NN O O
. . O O

It PRP O O
contains VBZ O O
an DT O O
additional JJ O O
meta NN O O
tag NN O O
at IN O O
the DT O O
end NN O O
of IN O O
the DT O O
web JJ O O
page NN O O
source NN O O
code NN O O
, , O O
“ NN O O
refreshing VBG O O
” NNP O O
( ( O O
redirecting VBG O O
) ) O O
the DT O O
site NN O O
visitor NN O O
to TO O O
the DT O O
weaponized JJ O O
document NN O O
. . O O

The DT O O
web JJ O O
page NN O O
is VBZ O O
not RB O O
indexed VBN O O
in IN O O
search NN O O
engines NNS O O
. . O O

It PRP B-Entity 1
can MD O O
only RB O O
be VB O O
visited VBN O O
by IN O O
clicking VBG O O
on IN O O
the DT O O
link NN O O
contained VBN O O
in IN O O
the DT O O
spear-phishing JJ O O
emails NNS O O
, , O O
helping VBG B-Action 2
it PRP B-Entity 3
evade JJ I-Entity O
traditional JJ I-Entity O
security NN I-Entity O
mechanisms NNS I-Entity O
compared VBN I-Entity O
to TO I-Entity O
directly RB I-Entity O
sending VBG I-Entity O
the DT I-Entity O
link NN I-Entity O
to TO I-Entity O
the DT I-Entity O
malicious JJ I-Entity O
document NN I-Entity O
. . O O

Figure NN O O
1 CD O O
: : O O
The DT O O
added JJ O O
code NN O O
snippet NN O O
that WDT O O
redirects VBZ O O
its PRP$ O O
visitors NNS O O
to TO O O
the DT O O
malicious JJ O O
document NN O O

We PRP O O
also RB O O
saw VBD O O
spear-phishing JJ O O
emails NNS O O
containing VBG O O
direct JJ O O
links NNS O O
to TO O O
the DT O O
weaponized JJ O O
documents NNS O O
hosted VBN O O
on IN O O
servers NNS O O
they PRP O O
own VBP O O
. . O O

The DT O O
group NN O O
employs VBZ O O
typosquatting VBG O O
to TO O O
increase VB O O
clicks NNS O O
. . O O

These DT O O
servers NNS O O
were VBD O O
reached VBN O O
through IN O O
domain NN O O
names NNS O O
similar JJ O O
to TO O O
legitimate VB O O
websites NNS O O
, , O O
such JJ O O
as IN O O
rannd NN O O
[ NN O O
. . O O

] JJ O O
org MD O O
instead RB O O
of IN O O
rand.org NN O O
. . O O

The DT B-Entity 1
malicious JJ I-Entity O
documents NNS I-Entity O
were VBD O O
also RB O O
directly RB O O
attached VBN O O
to TO O O
the DT O O
email NN O O
. . O O

However RB O O
, , O O
we PRP O O
didn VBP O O
’ JJ O O
t NN O O
see VBP O O
this DT O O
method NN O O
used VBN O O
as IN O O
much JJ O O
, , O O
as IN O O
the DT O O
attachments NNS O O
can MD O O
be VB O O
detected VBN O O
by IN O O
spam NN O O
filters NNS O O
. . O O

The DT O O
spear-phishing JJ O O
emails NNS O O
were VBD O O
sometimes RB O O
sent VBN O O
to TO O O
victims NNS O O
by IN O O
misusing VBG O O
YMLP NNP O O
and CC O O
serversecure.net NN O O
, , O O
which WDT O O
are VBP O O
email/newsletter JJ O O
distribution NN O O
services NNS O O
. . O O

Abusing VBG O O
these DT O O
legitimate JJ O O
online NN O O
services NNS O O
helps VBZ O O
improve VB O O
their PRP$ O O
emails NNS O O
’ NNP O O
chances NNS O O
of IN O O
not RB O O
being VBG O O
flagged VBN O O
as IN O O
spam NN O O
. . O O

More RBR O O
recently RB O O
, , O O
they PRP O O
’ VBP O O
ve RB O O
started VBN O O
sending VBG O O
emails NNS O O
using VBG O O
a DT O O
Postfix NNP O O
server NN O O
they PRP O O
operate VBP O O
. . O O

The DT O O
domain NN O O
name NN O O
“ JJ O O
servicelogin.center NN O O
” NN O O
was VBD O O
linked VBN O O
to TO O O
this DT O O
server NN O O
. . O O

It PRP O O
had VBD O O
a DT O O
proper JJ O O
MX NNP O O
record NN O O
, , O O
an DT B-Entity 1
SSL NNP I-Entity O
certificate NN I-Entity O
issued VBN I-Entity O
by IN I-Entity O
Let VB I-Entity O
’ NNP I-Entity O
s VB I-Entity O
Encrypt NNP I-Entity O
, , I-Entity O
and CC I-Entity O
the DT I-Entity O
domain NN I-Entity O
property NN I-Entity O
validated VBD I-Entity O
on IN I-Entity O
Google NNP I-Entity O
. . O O

Recently RB O O
, , O O
the DT O O
TXT NNP O O
SPF1 NNP O O
record NN O O
of IN O O
domains NNS O O
hosting VBG O O
malicious JJ O O
documents NNS O O
has VBZ O O
been VBN O O
updated VBN O O
to TO O O
include VB O O
“ NNP O O
servicelogin.center NN O O
” NNP O O
, , O O
probably RB O O
to TO O O
bypass VB O O
spam NN O O
filters NNS O O
. . O O

The DT B-Entity 1
attackers NNS I-Entity O
also RB O O
reportedly RB O O
used VBD O O
a DT O O
fake JJ O O
Youku NNP O O
Tudou NNP O O
website NN O O
( ( O O
a DT O O
video NN O O
platform NN O O
similar JJ O O
to TO O O
YouTube VB O O
very RB O O
popular JJ O O
in IN O O
China NNP O O
) ) O O
. . O O

It PRP O O
entices VBZ O O
users NNS O O
to TO O O
download VB B-Action 1
a DT B-Entity 2
fake JJ I-Entity O
Adobe NNP I-Entity O
Flash NNP I-Entity O
player NN I-Entity O
update NN I-Entity O
, , O O
which WDT O O
turned VBD O O
out RP O O
to TO O O
be VB O O
a DT O O
variant NN O O
of IN O O
the DT O O
xRAT NNP O O
malware NN O O
. . O O

The DT B-Entity 1
group NN I-Entity O
also RB O O
employs VBZ O O
phishing VBG O O
to TO O O
harvest VB O O
their PRP$ O O
targets NNS O O
’ VBP O O
credentials NNS O O
to TO O O
access NN O O
email NN O O
accounts NNS O O
and CC O O
other JJ O O
online NN O O
services NNS O O
. . O O

We PRP O O
took VBD O O
a DT B-Entity 1
closer NN I-Entity O
look NN I-Entity O
at IN I-Entity O
a DT I-Entity O
phishing VBG I-Entity O
kit NN I-Entity O
hosted VBN I-Entity O
on IN I-Entity O
Patchwork NNP I-Entity O
’ NNP I-Entity O
s JJ I-Entity O
infrastructure NN I-Entity O
. . O O

Opening VBG O O
one CD O O
of IN O O
the DT O O
suspicious JJ O O
domains NNS O O
, , O O
hxxps NN O O
: : O O
//accounts NNS O O
[ VBP O O
- : O O
] NN O O
login NN O O
[ NNP O O
- : O O
] NN O O
secure NN O O
[ NNP O O
. . O O
] CC O O
163 CD O O
[ NN O O
. . O O
] CC O O
com JJ O O
[ NN O O
. . O O
] JJ O O
neteease JJ O O
[ NN O O
. . O O

] NN O O
com NN O O
, , O O
in IN O O
a DT O O
web NN O O
browser NN O O
returns NNS O O
an DT O O
“ JJ O O
account NN O O
suspended VBD O O
” JJ O O
message NN O O
, , O O
which WDT O O
they PRP O O
’ VBP O O
ve NNS O O
copied VBN O O
from IN O O
a DT O O
web NN O O
development NN O O
company NN O O
. . O O

Figure NN O O
2 CD O O
: : O O
One CD O O
of IN O O
the DT O O
domains NNS O O
of IN O O
Patchwork NNP O O
’ NNP O O
s VBD O O
phishing VBG O O
kit NN O O
whose WP$ O O
appearance NN O O
was VBD O O
copied VBN O O
from IN O O
a DT O O
web NN O O
development NN O O
company NN O O
A DT O O
closer JJR O O
look NN O O
reveals NNS O O
that IN O O
the DT O O
phishing VBG O O
kit NN O O
expects VBZ O O
a DT O O
few JJ O O
parameters NNS O O
. . O O

The DT O O
kit NN O O
, , O O
which WDT O O
spoofs VBZ O O
a DT O O
legitimate JJ O O
web JJ O O
portal NN O O
and CC O O
email NN O O
service NN O O
, , O O
consists VBZ O O
of IN O O
two CD O O
PHP NNP O O
files NNS O O
: : O O
main.php NN O O
, , O O
which WDT O O
has VBZ O O
the DT O O
initial JJ O O
webpage NN O O
; : O O
and CC O O
error.php NN O O
, , O O
which WDT O O
harvests VBZ O O
and CC O O
processes VBZ O O
entered VBN O O
credentials NNS O O
. . O O

Figure NN O O
3 CD O O
: : O O
The DT O O
PHP NNP O O
file NN O O
that WDT O O
processes VBZ O O
entered VBN O O
credentials NNS O O

main.php NN O O
expects VBZ O O
the DT O O
following JJ O O
commands NNS O O
with IN O O
base64-encoded JJ O O
values NNS O O
( ( O O
seen VBN O O
on IN O O
the DT O O
screenshot NN O O
above IN O O
) ) O O
: : O O
u JJ O O
= NNP O O
user NN O O
( ( O O
encoded JJ O O
username NN O O
, , O O
the DT O O
victim NN O O
can MD O O
not RB O O
change VB O O
it PRP O O
on IN O O
the DT O O
web JJ O O
form NN O O
) ) O O
r NN O O
= '' O O
referrer NN O O
( ( O O
hxxp NN O O
: : O O
//mial JJ O O
[ NN O O
. . O O
] CC O O
163 CD O O
[ NN O O
. . O O

] NN O O
com NN O O
was VBD O O
used VBN O O
as IN O O
referrer NN O O
; : O O
the DT O O
use NN O O
of IN O O
“ NNP O O
mial JJ O O
” NNP O O
instead RB O O
of IN O O
“ JJ O O
mail NN O O
” NN O O
is VBZ O O
noted VBN O O
) ) O O
d NN O O
= NN O O
domain NN O O
( ( O O
163 CD O O
or CC O O
126 CD O O
or CC O O
yeah CD O O
or CC O O
shouji NNS O O
) ) O O
The DT O O
domain NN O O
has VBZ O O
one CD O O
of IN O O
the DT O O
four CD O O
possible JJ O O
values NNS O O
: : O O
MTYz NNP O O
is VBZ O O
163 CD O O
MTI2 NNP O O
is VBZ O O
126 CD O O
eWVhaA== NN O O
is VBZ O O
yeah JJ O O
c2hvdWpp NN O O
is VBZ O O
shouji VBN O O
( ( O O
which WDT O O
means VBZ O O
mobile JJ O O
phone NN O O
in IN O O
Chinese NNP O O
) ) O O

As IN O O
of IN O O
November NNP O O
24 CD O O
, , O O
2017 CD O O
, , O O
we PRP O O
found VBD O O
three CD O O
different JJ O O
phishing VBG O O
websites NNS O O
using VBG O O
a DT O O
valid JJ O O
SSL NNP O O
certificate NN O O
issued VBD O O
by IN O O
Let NNP O O
’ NNP O O
s VB O O
Encrypt NNP O O
for IN O O
three CD O O
months NNS O O
. . O O

Some DT O O
of IN O O
them PRP O O
used VBD O O
the DT O O
new JJ O O
TLD NNP O O
“ NNP O O
.support NNP O O
” NNP O O
. . O O

The DT O O
SSL NNP O O
certificates NNS O O
listed VBN O O
the DT O O
following VBG O O
domain NN O O
names NNS O O
: : O O
 JJ O O
accounts NNS O O
[ SYM O O
- : O O
] NN O O
login NN O O
[ NNP O O
- : O O
] NN O O
secure NN O O
[ NNP O O
- : O O
] NN O O
163 CD O O
[ SYM O O
- : O O
] NN O O
com NN O O
[ NNP O O
- : O O
] NN O O
neteease.com NN O O
 JJ O O
accounts NNS O O
[ SYM O O
- : O O
] NN O O
login NN O O
[ NNP O O
- : O O
] NN O O
secure NN O O
[ NNP O O
- : O O
] NN O O
qq NN O O
[ NNP O O
- : O O
] NN O O
com NN O O
[ NNP O O
- : O O
] NN O O
neteease.com NN O O
 JJ O O
accounts NNS O O
[ SYM O O
- : O O
] NN O O
login NN O O
[ NNP O O
- : O O
] NN O O
vip NN O O
[ NNP O O
- : O O
] NN O O
sina NN O O
[ NNP O O
- : O O
] NN O O
com NN O O
[ NNP O O
- : O O
] NN O O
neteease NN O O
[ NNP O O
- : O O
] NN O O
com NN O O
 JJ O O
neteease NN O O
[ NN O O
. . O O

] NN O O
com NN O O
 JJ O O
accounts NNS O O
[ VBP O O
. . O O
] JJ O O
login NN O O
[ NNP O O
. . O O
] CC O O
yahoomail JJ O O
[ NN O O
. . O O

] JJ O O
support NN O O
 NN O O
yahoomail NN O O
[ NN O O
. . O O

] JJ O O
support NN O O
 JJ O O
accounts NNS O O
[ VBP O O
. . O O
] JJ O O
login NN O O
[ NNP O O
. . O O
] CC O O
googlemail JJ O O
[ NN O O
. . O O

] JJ O O
support NN O O

Figure NN O O
4 CD O O
: : O O
Page NN O O
information NN O O
properties NNS O O
of IN O O
one CD O O
of IN O O
the DT O O
phishing NN O O
websites NNS O O
The DT O O
parameters NNS O O
sent VBD O O
to TO O O
the DT O O
error.php NN O O
script NN O O
that IN O O
attackers NNS O O
collect VBP O O
are VBP O O
username JJ O O
, , O O
domain NN O O
, , O O
password NN O O
and CC O O
redirector NN O O
values NNS O O
. . O O

Figure NN O O
5 CD O O
: : O O
Parameters NNS O O
sent VBD O O
to TO O O
the DT O O
error.php NN O O
script NN O O

Given VBN O O
how WRB O O
the DT O O
phishing JJ O O
kit NN O O
works NNS O O
, , O O
the DT B-Entity 1
attackers NNS I-Entity O
seem VBP O O
cautious JJ O O
. . O O

The DT O O
phishing NN O O
page NN O O
can MD O O
only RB O O
be VB O O
obtained VBN O O
by IN O O
sending VBG O O
specific JJ O O
arguments NNS O O
to TO O O
the DT O O
PHP NNP O O
script NN O O
. . O O

Any DT B-Entity 1
other JJ I-Entity O
way NN I-Entity O
will MD O O
lead VB O O
to TO O O
the DT O O
fake NN O O
suspended VBD O O
account NN O O
page NN O O
. . O O

The DT O O
link NN O O
leading VBG O O
to TO O O
the DT O O
phishing NN O O
page NN O O
can MD O O
only RB O O
be VB O O
found VBN O O
on IN O O
the DT O O
emails NNS O O
sent VBD O O
to TO O O
the DT O O
victims NNS O O
. . O O

Many JJ O O
of IN O O
the DT O O
documents NNS O O
were VBD O O
found VBN O O
in IN O O
a DT O O
directory NN O O
accidentally RB O O
left VBD O O
open JJ O O
. . O O

The DT B-Entity 1
group NN I-Entity O
uses VBZ B-Action 2
sociopolitical JJ B-Entity 3
themes NNS I-Entity O
as IN B-Modifier 4
social JJ B-Entity 5
engineering NN I-Entity O
hooks NNS I-Entity O
. . O O

Those DT O O
with IN O O
the DT O O
.doc JJ O O
extension NN O O
are VBP O O
actually RB O O
Rich NNP O O
Text NNP O O
format NN O O
( ( O O
RTF NNP O O
) ) O O
files NNS O O
that WDT O O
trigger VBP O O
an DT O O
exploit NN O O
for IN O O
CVE-2012-1856 NNP O O
, , O O
patched VBD O O
via IN O O
MS12-060 NNP O O
last JJ O O
August NNP O O
2012 CD O O
. . O O

It PRP O O
is VBZ O O
a DT O O
remote JJ O O
code NN O O
execution NN O O
( ( O O
RCE NNP O O
) ) O O
vulnerability NN O O
in IN O O
the DT O O
Windows NNP O O
common JJ O O
control NN O O
MSCOMCTL NNP O O
, , O O
an DT O O
ActiveX NNP O O
Control NNP O O
module NN O O
. . O O

These DT B-Entity 1
files NNS I-Entity O
drop NN I-Entity O
variants NNS I-Entity O
of IN I-Entity O
the DT I-Entity O
NDiskMonitor NNP I-Entity O
backdoor NN I-Entity O
. . O O

The DT O O
PowerPoint NNP O O
Open NNP O O
XML NNP O O
Slide NNP O O
Show NNP O O
( ( O O
PPSX NNP O O
) ) O O
files VBZ O O
exploit JJ O O
Sandworm NNP O O
( ( O O
CVE-2014-4114 NNP O O
) ) O O
, , O O
an DT O O
RCE NNP O O
vulnerability NN O O
in IN O O
Windows NNP O O
’ NNP O O
Object NNP O O
Linking NNP O O
and CC O O
Embedding NNP O O
( ( O O
OLE NNP O O
) ) O O
feature NN O O
patched VBN O O
last JJ O O
October NNP O O
2014 CD O O
. . O O

Figure NN O O
6 CD O O
: : O O
The DT O O
directory NN O O
containing VBG O O
the DT O O
documents NNS O O

The DT O O
PowerPoint NNP O O
( ( O O
PPT NNP O O
) ) O O
file NN O O
exploits VBZ O O
CVE-2017-0199 NNP O O
, , O O
an DT O O
RCE NNP O O
vulnerability NN O O
in IN O O
Microsoft NNP O O
Office NNP O O
’ NNP O O
s NN O O
Windows NNP O O
OLE NNP O O
, , O O
patched VBN O O
last JJ O O
April NNP O O
2017 CD O O
. . O O

Once RB O O
the DT O O
victim NN O O
clicks VBZ O O
“ NNP O O
Enable NNP O O
Editing NNP O O
” NNP O O
, , O O
the DT O O
file NN O O
will MD O O
attempt VB O O
to TO O O
download VB B-Action 1
an DT B-Entity 2
.HTA NN I-Entity O
file NN I-Entity O
and CC O O
silently RB O O
exploits VBZ O O
it PRP O O
by IN O O
leveraging VBG O O
CVE-2017-0199 NNP O O
. . O O

Figure NN O O
7 CD O O
: : O O
The DT O O
PPT NNP O O
containing VBG O O
the DT O O
CVE-2017-0199 NNP O O
exploit NN O O

Figure NN O O
8 CD O O
: : O O
Code NNP O O
snapshot VBZ O O
showing VBG O O
the DT O O
PPT NNP O O
file NN O O
downloading VBG O O
a DT O O
malicious JJ O O
.HTA NN O O
file NN O O
We PRP O O
also RB O O
saw VBD O O
another DT O O
document NN O O
that WDT O O
comes VBZ O O
with IN O O
an DT O O
executable JJ O O
instead RB O O
of IN O O
a DT O O
macro NN O O
. . O O

The DT O O
file NN O O
decodes NNS O O
and CC O O
executes VBZ O O
a DT O O
Visual JJ O O
Basic NNP O O
script NN O O
( ( O O
VBS NNP O O
) ) O O
that IN O O
drops NNS O O
and CC O O
executes VBZ O O
a DT O O
hybrid JJ O O
batch/.NET NN O O
file NN O O
, , O O
which WDT O O
then RB O O
downloads NNS O O
and CC O O
executes VBZ B-Action 1
the DT B-Entity 2
NDiskMonitor NNP I-Entity O
backdoor NN I-Entity O
and CC I-Entity O
a DT I-Entity O
decoy JJ I-Entity O
document NN I-Entity O
. . O O

The DT O O
relatively RB O O
long JJ O O
infection NN O O
chain NN O O
can MD O O
be VB O O
construed VBN O O
as IN O O
their PRP$ O O
way NN O O
to TO O O
obscure VB O O
their PRP$ O O
activities NNS O O
. . O O

A DT B-Entity 1
document NN I-Entity O
the DT I-Entity O
group NN I-Entity O
recently RB O O
used VBD O O
had VBD O O
an DT O O
additional JJ O O
step NN O O
, , O O
likely RB O O
done VBN O O
to TO O O
avoid VB O O
antivirus NN O O
( ( O O
AV NNP O O
) ) O O
detection NN O O
. . O O

A DT B-Entity 1
Word NNP I-Entity O
document NN I-Entity O
embedded VBD I-Entity O
with IN I-Entity O
a DT I-Entity O
malicious JJ I-Entity O
PPSX NNP I-Entity O
file NN I-Entity O
urges VBZ B-Action 2
the DT B-Entity 3
victim NN I-Entity O
to TO I-Entity O
click VB I-Entity O
on IN I-Entity O
a DT I-Entity O
fake JJ I-Entity O
PDF NNP I-Entity O
icon NN I-Entity O
to TO I-Entity O
open VB I-Entity O
the DT I-Entity O
malicious JJ I-Entity O
document NN I-Entity O
. . O O

It PRP O O
exploits VBZ O O
CVE-2017-8570 NNP O O
( ( O O
an DT O O
RCE NNP O O
vulnerability NN O O
in IN O O
Microsoft NNP O O
Office NNP O O
patched VBN O O
last JJ O O
July NNP O O
2017 CD O O
) ) O O
to TO O O
download VB B-Action 1
a DT B-Entity 2
Windows NNP I-Entity O
Script NNP I-Entity O
Component NNP I-Entity O
( ( I-Entity O
SCT NNP I-Entity O
) ) I-Entity O
file NN I-Entity O
from IN I-Entity O
a DT I-Entity O
Patchwork-owned JJ I-Entity O
server NN I-Entity O
. . O O

Figure NN O O
9 CD O O
: : O O
Screenshot NN O O
of IN O O
the DT B-Entity 1
Word NNP I-Entity O
document NN I-Entity O
containing VBG I-Entity O
a DT I-Entity O
PPSX NNP I-Entity O
file NN I-Entity O
that WDT O O
exploits VBZ O O
CVE-2017-8570 NNP O O

Figure NN O O
10 CD O O
: : O O
Code NNP O O
snippet NN O O
showing VBG O O
the DT O O
malicious JJ O O
SCT NNP O O
to TO O O
be VB O O
retrieved VBN O O
The DT O O
scriptlet NN O O
.SCT NNP O O
file NN O O
shown VBN O O
above IN O O
contains NNS O O
PowerShell NNP O O
code NN O O
. . O O

The DT O O
payload NN O O
downloads VBZ O O
a DT O O
malicious JJ O O
xRAT JJ O O
sample NN O O
and CC O O
a DT O O
decoy JJ O O
PowerPoint NNP O O
presentation NN O O
. . O O

It PRP B-Entity 1
also RB O O
recursively RB O O
deletes VBZ O O
Resiliency NNP O O
registry NN O O
keys NNS O O
created VBN O O
by IN O O
Microsoft NNP O O
Office NNP O O
applications NNS O O
( ( O O
Word NNP O O
, , O O
Excel NNP O O
, , O O
PowerPoint NNP O O
, , O O
etc FW O O
. . O O
) ) O O
. . O O

Some DT O O
items NNS O O
in IN O O
the DT O O
Resiliency NN O O
registry NN O O
key NN O O
are VBP O O
created VBN O O
when WRB O O
the DT O O
Office NNP O O
application NN O O
does VBZ O O
not RB O O
terminate VB O O
correctly RB O O
, , O O
later RB O O
displaying VBG O O
this DT O O
information NN O O
to TO O O
the DT O O
user NN O O
. . O O

Deleting VBG O O
Resiliency NNP O O
keys NNS O O
will MD O O
make VB O O
the DT O O
Office NNP O O
application NN O O
think VBP O O
that IN O O
everything NN O O
was VBD O O
correct JJ O O
and CC O O
there EX O O
were VBD O O
no DT O O
problems NNS O O
during IN O O
the DT O O
latest JJS O O
application NN O O
run NN O O
. . O O

The DT O O
latest JJS O O
step NN O O
involves NNS O O
starting VBG O O
PowerPoint NNP O O
, , O O
maximizing VBG O O
its PRP$ O O
window NN O O
, , O O
and CC O O
loading VBG O O
a DT O O
decoy JJ O O
document NN O O
while IN O O
starting VBG O O
the DT O O
payload NN O O
in IN O O
the DT O O
background NN O O
. . O O

We PRP O O
also RB O O
found VBD O O
other JJ O O
PPSX NNP O O
documents NNS O O
that WDT O O
exploited VBD O O
this DT O O
vulnerability NN O O
, , O O
but CC O O
they PRP O O
were VBD O O
sent VBN O O
directly RB O O
and CC O O
not RB O O
embedded VBN O O
in IN O O
a DT O O
DOCX NNP O O
file NN O O
. . O O

We PRP O O
also RB O O
uncovered VBD O O
documents NNS B-Entity 1
related VBN I-Entity O
to TO I-Entity O
the DT I-Entity O
Bangladesh NNP I-Entity O
Army NNP I-Entity O
and CC I-Entity O
a DT I-Entity O
United NNP I-Entity O
Nations NNP I-Entity O
Development NNP I-Entity O
Programme NNP I-Entity O
in IN I-Entity O
Sri NNP I-Entity O
Lanka NNP I-Entity O
. . O O

These DT B-Entity 1
documents NNS I-Entity O
contained VBD B-Action 2
malicious JJ B-Entity 3
macros NNS I-Entity O
that WDT I-Entity O
deliver VBP I-Entity O
the DT I-Entity O
xRAT NNP I-Entity O
remote NN I-Entity O
access NN I-Entity O
tool NN I-Entity O
, , O O
which WDT O O
lets VBZ O O
attackers NNS O O
control VB O O
the DT O O
infected JJ O O
machine NN O O
. . O O

There EX O O
were VBD O O
also RB O O
other JJ O O
socially RB O O
engineered VBN O O
documents NNS O O
that IN O O
used VBD O O
government-related JJ O O
news NN O O
and CC O O
activities NNS O O
, , O O
with IN O O
subjects NNS O O
such JJ O O
as IN O O
“ JJ O O
Supply NNP O O
Chain NNP O O
Management NNP O O
” NNP O O
as IN O O
lures NNS O O
. . O O

These DT O O
are VBP O O
RTF NNP O O
files NNS O O
exploiting VBG O O
CVE-2015- NN O O
1641 CD O O
, , O O
a DT O O
memory NN O O
corruption NN O O
vulnerability NN O O
in IN O O
Microsoft NNP O O
Office NNP O O
patched VBD O O
last JJ O O
April NNP O O
2015 CD O O
. . O O

When WRB O O
executed VBN O O
, , O O
it PRP O O
drops NNS O O
a DT O O
signed VBN O O
java-rmi.exe NN O O
executable NN O O
from IN O O
Java NNP O O
Runtime NNP O O
and CC O O
two CD O O
dynamic-link JJ O O
libraries NNS O O
( ( O O
DLLs NNP O O
) ) O O
—a NN O O
clean JJ O O
msvcr71.dll NN O O
and CC O O
malicious JJ O O
jli.dll NN O O
. . O O

The DT O O
malicious JJ O O
DLL NNP O O
, , O O
which WDT O O
contains VBZ O O
the DT O O
Badnews NNP O O
backdoor NN O O
, , O O
is VBZ O O
loaded VBN O O
and CC O O
executed VBN O O
using VBG O O
the DT O O
DLL NNP O O
side-loading NN O O
technique NN O O
. . O O

Figure NN O O
11 CD O O
: : O O
Screenshots NNS O O
of IN O O
RTF NNP O O
files NNS O O
that WDT O O
exploit VBP O O
CVE-2015-1641 NNP O O
and CC O O
deliver VB B-Action 1
the DT B-Entity 2
Badnews NNP I-Entity O
backdoor NN I-Entity O

We PRP O O
managed VBD O O
to TO O O
acquire VB B-Action 1
a DT B-Entity 2
few JJ I-Entity O
samples NNS I-Entity O
abusing VBG I-Entity O
a DT I-Entity O
technique NN I-Entity O
called VBN I-Entity O
self-compiled JJ I-Entity O
.NET NN I-Entity O
hybrids NNS I-Entity O
. . O O

One CD O O
text NN O O
file NN O O
contains VBZ O O
both DT O O
JavaScript NNP O O
code NN O O
and CC O O
batch NN O O
code NN O O
, , O O
which WDT O O
compiles VBZ O O
the DT O O
JavaScript NNP O O
code NN O O
into IN O O
executable JJ O O
files NNS O O
and CC O O
later RB O O
executes VBZ O O
it PRP O O
. . O O

The DT O O
file NN O O
starts VBZ O O
with IN O O
two CD O O
lines NNS O O
, , O O
shown VBN O O
below IN O O
. . O O

The DT O O
first JJ O O
line NN O O
must MD O O
be VB O O
a DT O O
valid JJ O O
statement NN O O
in IN O O
both DT O O
languages NNS O O
. . O O

If IN O O
executed VBN O O
as IN O O
a DT O O
batch NN O O
script NN O O
, , O O
the DT B-Entity 1
first JJ I-Entity O
comparison NN I-Entity O
( ( I-Entity O
@ NNP I-Entity O
X NNP I-Entity O
) ) I-Entity O
== NNP I-Entity O
( ( I-Entity O
@ NNP I-Entity O
Y NNP I-Entity O
) ) I-Entity O
is VBZ B-Action 2
evaluated VBN I-Action O
as IN B-Modifier 3
False NNP B-Entity 4
. . O O

Therefore RB O O
@ JJ O O
end NN O O
is VBZ O O
not RB O O
executed VBN O O
. . O O

Each DT O O
following JJ O O
line NN O O
is VBZ O O
then RB O O
evaluated VBN O O
by IN O O
a DT O O
batch NN O O
file NN O O
interpreter NN O O
until IN O O
the DT O O
“ NNP O O
exit NN O O
/b NNP O O
” NNP O O
command NN O O
causes VBZ O O
the DT O O
batch NN O O
processing NN O O
to TO O O
terminate VB O O
. . O O

Figure NN O O
12 CD O O
: : O O
Code NNP O O
snippet NN O O
of IN O O
samples NNS O O
using VBG O O
the DT O O
self-compiled JJ O O
.NET NNP O O
hybrid NN O O

JavaScript NNP O O
, , O O
however RB O O
, , O O
treats NNS O O
terms NNS O O
starting VBG O O
with IN O O
@ NNP O O
as IN O O
conditional JJ O O
compilation NN O O
variables NNS O O
, , O O
evaluated VBD O O
as IN O O
False NNP O O
, , O O
followed VBN O O
by IN O O
a DT O O
multiline JJ O O
comment NN O O
. . O O

JavaScript NNP O O
, , O O
therefore RB O O
, , O O
ignores VBZ O O
all PDT O O
the DT O O
code NN O O
between IN O O
/* NNP O O
and CC O O
*/ NNP O O
, , O O
and CC O O
only RB O O
the DT O O
code NN O O
that WDT O O
follows VBZ O O
*/ NN O O
is VBZ O O
considered VBN O O
. . O O

The DT O O
compilation NN O O
process NN O O
is VBZ O O
achieved VBN O O
by IN O O
the DT O O
following JJ O O
command NN O O
, , O O
where WRB O O
% NN O O
jsc NN O O
% NN O O
points NNS O O
to TO O O
a DT O O
JScript NN O O
compiler NN O O
and CC O O
% NN O O
~dpsfnx0 NN O O
is VBZ O O
resolved VBN O O
to TO O O
the DT O O
name NN O O
of IN O O
the DT O O
currently RB O O
executed VBN O O
batch NN O O
file NN O O
( ( O O
d JJ O O
means VBZ O O
disc NN O O
, , O O
p NN O O
means NNS O O
path NN O O
, , O O
f JJ O O
means NNS O O
file NN O O
, , O O
x NN O O
means VBZ O O
extension NN O O
; : O O
all DT O O
are VBP O O
modifiers NNS O O
of IN O O
a DT O O
special JJ O O
% NN O O
0 CD O O
parameter NN O O
) ) O O
. . O O

Figure NN O O
13 CD O O
: : O O
Command NN O O
that WDT O O
facilitates VBZ O O
the DT O O
compilation NN O O
process NN O O
The DT O O
end NN O O
of IN O O
the DT O O
batch NN O O
script NN O O
behind IN O O
the DT O O
*/ JJ O O
comment NN O O
is VBZ O O
treated VBN O O
as IN O O
source NN O O
code NN O O
. . O O

The DT O O
code NN O O
shown VBN O O
below IN O O
makes VBZ O O
a DT O O
simple JJ O O
command-line JJ O O
downloader NN O O
with IN O O
two CD O O
parameters NNS O O
, , O O
URL NNP O O
, , O O
and CC O O
file NN O O
name NN O O
. . O O

Figure NN O O
14 CD O O
: : O O
Snapshot JJ O O
showing VBG O O
the DT O O
command-line JJ O O
downloader NN O O
After IN O O
compilation NN O O
, , O O
the DT O O
batch NN O O
script NN O O
uses VBZ O O
the DT O O
previously RB O O
compiled VBN O O
simpledownloader.exe NN O O
to TO O O
download NN O O
and CC O O
execute VB O O
both DT O O
the DT O O
payload NN O O
and CC O O
decoy JJ O O
document NN O O
. . O O

Figure NN O O
15 CD O O
: : O O
Snapshot JJ O O
showing VBG O O
the DT O O
payload NN O O
and CC O O
decoy JJ O O
document NN O O
being VBG O O
retrieved VBN O O
The DT O O
scvhost6.exe NN O O
file NN O O
is VBZ O O
actually RB O O
a DT O O
variant NN O O
of IN O O
the DT O O
NDiskMonitor NNP O O
backdoor NN O O
, , O O
while IN O O
the DT O O
document.doc NN O O
is VBZ O O
a DT O O
decoy JJ O O
document NN O O
, , O O
which WDT O O
is VBZ O O
a DT O O
legitimate JJ O O
sociopolitical JJ O O
essay NN O O
. . O O

Patchwork NNP O O
also RB O O
abused VBD O O
the DT O O
Dynamic NNP O O
Data NNP O O
Exchange NNP O O
( ( O O
DDE NNP O O
) ) O O
protocol NN O O
to TO O O
deliver VB O O
their PRP$ O O
malware NN O O
. . O O

The DT O O
internal JJ O O
structure NN O O
of IN O O
a DT O O
sample NN O O
we PRP O O
analyzed VBD O O
, , O O
an DT O O
Office NNP O O
Open NNP O O
XML NNP O O
file NN O O
, , O O
is VBZ O O
a DT O O
ZIP NNP O O
archive NN O O
that WDT O O
contains VBZ O O
the DT O O
“ JJ O O
document.xml NN O O
” NNP O O
file NN O O
, , O O
which WDT O O
contains VBZ O O
an DT O O
embedded JJ O O
DDE NNP O O
payload NN O O
. . O O

The DT O O
payload NN O O
starts VBZ O O
with IN O O
a DT O O
DDEAUTO NNP O O
string NN O O
, , O O
followed VBN O O
by IN O O
a DT O O
command NN O O
to TO O O
be VB O O
executed VBN O O
. . O O

The DT B-Entity 1
command NN I-Entity O
can MD O O
be VB O O
split VBN O O
into IN O O
several JJ O O
fields NNS O O
by IN O O
“ JJ O O
w NN O O
: : O O
instrText JJ O O
” NN O O
or CC O O
through IN O O
the DT O O
use NN O O
of IN O O
other JJ O O
methods NNS O O
. . O O

In IN O O
the DT O O
figure NN O O
below IN O O
, , O O
the DT O O
entire JJ O O
PowerShell NNP O O
command NN O O
( ( O O
displayed VBN O O
in IN O O
black JJ O O
) ) O O
is VBZ O O
split VBN O O
into IN O O
several JJ O O
chunks NNS O O
. . O O

When WRB O O
a DT O O
victim NN O O
opens VBZ O O
the DT O O
document NN O O
and CC O O
DDE NNP O O
is VBZ O O
enabled VBN O O
on IN O O
the DT O O
machine NN O O
, , O O
the DT O O
PowerShell NNP O O
command NN O O
downloads NNS O O
and CC O O
displays VBZ O O
the DT O O
decoy NN O O
document NN O O
then RB O O
retrieves VBZ O O
and CC O O
executes VBZ O O
xRAT NNS O O
. . O O

Figure NN O O
16 CD O O
: : O O
PowerShell NNP O O
command VB O O
retrieving VBG O O
and CC O O
executing VBG O O
xRAT NN O O

xRAT NN O O
, , O O
renamed VBD O O
QuasarRAT NNP O O
in IN O O
its PRP$ O O
latest JJS O O
versions NNS O O
, , O O
is VBZ O O
a DT O O
remote JJ O O
access NN O O
tool NN O O
whose WP$ O O
source NN O O
is VBZ O O
publicly RB O O
available JJ O O
on IN O O
Github NNP O O
. . O O

This DT O O
availability NN O O
allows VBZ O O
anyone NN O O
to TO O O
easily RB O O
clone VB O O
the DT O O
project NN O O
and CC O O
compile VB O O
it PRP O O
. . O O

The DT O O
project NN O O
is VBZ O O
actively RB O O
maintained VBN O O
, , O O
with IN O O
users NNS O O
reporting VBG O O
bugs NNS O O
and CC O O
the DT O O
developer NN O O
fixing VBG O O
them PRP O O
and CC O O
committing VBG B-Action 1
the DT B-Entity 2
repaired VBN I-Entity O
files NNS I-Entity O
back RB I-Entity O
to TO I-Entity O
the DT I-Entity O
Github NNP I-Entity O
repository NN I-Entity O
. . O O

NDiskMonitor NN B-Entity 1
is VBZ B-Action 2
a DT B-Entity 3
custom JJ I-Entity O
backdoor NN I-Entity O
written VBN I-Entity O
in IN I-Entity O
.NET NNP I-Entity O
, , O O
named VBN O O
after IN O O
the DT O O
project NN O O
name NN O O
. . O O

We PRP O O
haven VBP O O
’ JJ O O
t NN O O
seen VBN O O
this DT O O
backdoor NN O O
used VBN O O
by IN O O
any DT O O
other JJ O O
threat NN O O
actor NN O O
, , O O
so IN O O
we PRP O O
construe VBP O O
this DT O O
as IN O O
Patchwork NNP O O
’ NNP O O
s VBD O O
own JJ O O
. . O O

Figure NN O O
17 CD O O
: : O O
Snapshot NN O O
of IN O O
NDiskMonitor NNP O O
’ NNP O O
s NN O O
properties NNS O O

NDiskMonitor NNP O O
’ NNP O O
s NN O O
configuration NN O O
is VBZ O O
stored VBN O O
in IN O O
update_details JJ O O
global JJ O O
variable NN O O
. . O O

70600 CD O O
is VBZ O O
probably RB O O
its PRP$ O O
backdoor NN O O
ID NNP O O
, , O O
`` `` O O
FuckYou NNP O O
'' '' O O
is VBZ O O
the DT O O
AES NNP O O
password NN O O
used VBN O O
for IN O O
encrypting VBG O O
certain JJ O O
information NN O O
, , O O
and CC O O
the DT O O
string NN O O
following VBG O O
it PRP O O
is VBZ O O
the DT O O
command NN O O
and CC O O
control NN O O
( ( O O
C NNP O O
& CC O O
C NNP O O
) ) O O
address NN O O
. . O O

Figure NN O O
18 CD O O
: : O O
NDiskMonitor NN O O
’ NN O O
s NN O O
configuration NN O O

NDiskMonitor NNP O O
spawns VBD O O
a DT O O
few JJ O O
threads NNS O O
. . O O

The DT B-Entity 1
first JJ I-Entity O
thread JJ I-Entity O
beacons NNS I-Entity O
regularly RB O O
to TO O O
let VB O O
attackers NNS O O
know VB O O
that IN O O
the DT O O
machine NN O O
is VBZ O O
alive JJ O O
. . O O

The DT O O
parameter NN O O
license NN O O
is VBZ O O
the DT O O
encrypted JJ O O
username NN O O
, , O O
current_license NN O O
is VBZ O O
the DT O O
encrypted JJ O O
computer NN O O
name NN O O
, , O O
and CC O O
bui NN O O
is VBZ O O
the DT O O
backdoor JJ O O
ID NNP O O
. . O O

Figure NN O O
19 CD O O
: : O O
Thread NN O O
spawned VBN O O
by IN O O
NDiskMonitor NN O O

The DT B-Entity 1
second JJ I-Entity O
thread NN I-Entity O
listens NNS I-Entity O
for IN I-Entity O
backdoor JJ I-Entity O
commands NNS I-Entity O
. . O O

Backdoor NNP B-Entity 1
queries NNS I-Entity O
are VBP B-Action 2
done VBN I-Action O
via IN B-Modifier 3
updatecheck.php NN B-Entity 4
, , O O
with IN O O
parameters NNS O O
client NN O O
as IN O O
the DT O O
encrypted VBN O O
user NN O O
name NN O O
. . O O

Supported VBN O O
commands NNS O O
are VBP O O
: : O O
cme-update| JJ O O
< NN O O
base64 NN O O
command NN O O
> NN O O
Dv NN O O
rr| NN O O
< NNP O O
base64 NN O O
directory NN O O
> NN O O
ue| JJ O O
< NNP O O
base64 NN O O
url NN O O
> NN O O
execute NN O O
command NN O O
, , O O
AES-encrypted JJ O O
result NN O O
exfiltrated VBN O O
with IN O O
/php/component_update.php NN O O
, , O O
parameters NNS O O
component VBP O O
= NNP O O
user NN O O
name NN O O
and CC O O
check VB B-Action 1
= NN B-Entity 2
encrypted VBN I-Entity O
result NN I-Entity O
return JJ I-Entity O
list NN I-Entity O
of IN I-Entity O
all DT I-Entity O
logical JJ I-Entity O
drives NNS I-Entity O
, , I-Entity O
separated VBN I-Entity O
by IN I-Entity O
“ NNP I-Entity O
& CC I-Entity O
” NNP I-Entity O
list NN I-Entity O
all PDT I-Entity O
the DT I-Entity O
files NNS I-Entity O
and CC I-Entity O
directories NNS I-Entity O
in IN I-Entity O
given VBN I-Entity O
directory NN I-Entity O
download NN I-Entity O
and CC I-Entity O
execute NN I-Entity O
file NN I-Entity O
from IN I-Entity O
given VBN I-Entity O
URL NNP I-Entity O
The DT I-Entity O
third JJ I-Entity O
thread JJ I-Entity O
regularly RB I-Entity O
downloads NNS I-Entity O
and CC O O
executes VBZ O O
the DT O O
Wintel NNP O O
file/information NN O O
stealer NN O O
, , O O
while IN O O
the DT O O
fourth JJ O O
thread NN O O
runs VBZ O O
a DT O O
custom NN O O
Task NNP O O
Host NNP O O
program NN O O
. . O O

It PRP O O
’ VBZ O O
s VBZ O O
a DT O O
persistence NN O O
mechanism NN O O
for IN O O
Wintel NNP O O
, , O O
which WDT O O
doesn VBZ O O
’ NN O O
t NNS O O
have VBP O O
one CD O O
on IN O O
its PRP$ O O
own JJ O O
. . O O

Of IN O O
note NN O O
were VBD O O
multiple JJ O O
NDiskmonitor NNP O O
samples VBZ O O
we PRP O O
found VBD O O
in IN O O
the DT O O
wild NN O O
that WDT O O
had VBD O O
different JJ O O
hashes NNS O O
but CC O O
similar JJ O O
code NN O O
. . O O

The DT B-Entity 1
attackers NNS I-Entity O
added VBD O O
four CD O O
extra JJ O O
bytes NNS O O
of IN O O
random JJ O O
uppercase NN O O
and CC O O
lowercase NN O O
letters NNS O O
after IN O O
the DT O O
PE- NN O O
referenced VBN O O
data NNS O O
in IN O O
the DT O O
overlay NN O O
. . O O

We PRP O O
think VBP O O
this DT O O
is VBZ O O
done VBN O O
solely RB O O
to TO O O
change VB O O
the DT O O
file NN O O
hashes NNS O O
since IN O O
the DT O O
Windows NNP O O
PE NNP O O
loader NN O O
wo MD O O
n't RB O O
even RB O O
load VB O O
those DT O O
extra JJ O O
bytes NNS O O
into IN O O
memory NN O O
. . O O

Patchwork NN B-Entity 1
also RB O O
uses VBZ B-Action 2
the DT B-Entity 3
Socksbot NNP I-Entity O
backdoor NN I-Entity O
. . O O

As IN O O
its PRP$ O O
name NN O O
suggests VBZ O O
, , O O
it PRP O O
abuses VBZ O O
Socket NNP O O
Secure NNP O O
( ( O O
SOCKS NNP O O
) ) O O
proxies NNS O O
. . O O

Figure NN O O
20 CD O O
: : O O
Snapshot JJ O O
showing NN O O
Socksbot NNP O O

All DT B-Entity 1
Socksbot NNP I-Entity O
binaries NNS I-Entity O
are VBP I-Entity O
DLL NNP I-Entity O
files NNS I-Entity O
that WDT I-Entity O
create VBP I-Entity O
a DT I-Entity O
suspended JJ I-Entity O
svchost NN I-Entity O
process NN I-Entity O
, , O O
in IN O O
which WDT O O
the DT O O
DLL NNP O O
is VBZ O O
injected VBN O O
and CC O O
then RB O O
executed VBD O O
( ( O O
e.g. JJ O O
, , O O
as IN O O
a DT O O
module NN O O
in IN O O
another DT O O
backdoor NN O O
) ) O O
. . O O

When WRB O O
Socksbot NNP O O
communicates VBZ O O
with IN O O
the DT O O
C NNP O O
& CC O O
C NNP O O
server NN O O
, , O O
the DT O O
response NN O O
will MD O O
include VB O O
a DT O O
status NN O O
code NN O O
. . O O

Based VBN O O
on IN O O
the DT O O
status NN O O
code NN O O
, , O O
Socksbot NNP O O
will MD O O
execute VB O O
one CD O O
of IN O O
the DT O O
following JJ O O
branches NNS O O
: : O O
 JJ O O
200 CD O O
: : O O
start VB O O
a DT O O
SOCKS NNP O O
proxy NN O O
thread NN O O
 JJ O O
202 CD O O
: : O O
take VB O O
a DT O O
screenshot NN O O
and CC O O
list NN B-Entity 1
of IN I-Entity O
all DT I-Entity O
running VBG I-Entity O
processes NNS I-Entity O
to TO O O
C NNP O O
& CC O O
C NNP O O
 JJ O O
203 CD O O
: : O O
activate VB O O
the DT O O
backdoor NN O O
function NN O O
, , O O
which WDT O O
depends VBZ O O
on IN O O
the DT O O
first JJ O O
byte NN O O
of IN O O
received VBN O O
and CC O O
decoded VBN O O
buffer NN O O
, , O O
which WDT O O
can MD O O
be VB O O
: : O O
o JJ O O
Write NNP O O
and CC O O
execute VB B-Action 2
an DT B-Entity 3
EXE NNP I-Entity O
file NN I-Entity O
o JJ I-Entity O
Write NNP I-Entity O
and CC I-Entity O
execute VB I-Entity O
a DT I-Entity O
PowerShell NNP I-Entity O
script NN I-Entity O
o JJ I-Entity O
Write NNP I-Entity O
and CC I-Entity O
execute VB I-Entity O
a DT I-Entity O
PowerShell NNP I-Entity O
script NN I-Entity O
and CC I-Entity O
exit NN I-Entity O

Figure NN O O
21 CD O O
: : O O
Code NNP O O
snippets VBZ O O
showing VBG O O
Socksbot NNP O O
executing VBG O O
branches NNS O O
based VBN O O
on IN O O
status NN O O
code NN O O

This DT O O
backdoor NN O O
, , O O
which WDT O O
has VBZ O O
been VBN O O
used VBN O O
in IN O O
other JJ O O
campaigns NNS O O
, , O O
has VBZ O O
an DT O O
interesting JJ O O
method NN O O
for IN O O
retrieving VBG O O
the DT O O
actual JJ O O
C NNP O O
& CC O O
C NNP O O
address NN O O
. . O O

The DT O O
binary NN O O
has VBZ O O
a DT O O
few JJ O O
hardcoded JJ O O
and CC O O
encoded VBD O O
URL NNP O O
addresses NNS O O
, , O O
which WDT O O
can MD O O
be VB O O
decoded VBN O O
by IN O O
subtracting VBG O O
0x01 CD O O
from IN O O
each DT O O
character NN O O
. . O O

After IN O O
the DT O O
decoding NN O O
, , O O
we PRP O O
get VBP O O
the DT O O
actual JJ O O
URLs NNP O O
. . O O

Figure NN O O
22 CD O O
: : O O
The DT O O
hardcoded JJ O O
strings NNS O O
( ( O O
above IN O O
) ) O O
, , O O
and CC O O
the DT O O
actual JJ O O
URLs NNP O O
when WRB O O
decoded VBN O O
( ( O O
below IN O O
) ) O O

These DT O O
addresses NNS O O
refer VBP O O
to TO O O
legitimate VB O O
websites NNS O O
such JJ O O
as IN O O
Github NNP O O
, , O O
Feed43 NNP O O
, , O O
WebRSS NNP O O
, , O O
Wordpress NNP O O
, , O O
and CC O O
Weebly RB O O
, , O O
likely RB O O
to TO O O
circumvent VB O O
AV NNP O O
detection NN O O
. . O O

Accessing VBG O O
these DT O O
decoded VBN O O
URLs NN O O
reveals NNS O O
a DT O O
long JJ O O
base64 NN O O
string NN O O
enclosed VBD O O
within IN O O
parentheses NNS O O
. . O O

This DT O O
may MD O O
be VB O O
hidden VBN O O
on IN O O
some DT O O
websites NNS O O
, , O O
as IN O O
the DT O O
text NN O O
has VBZ O O
white JJ O O
color NN O O
on IN O O
a DT O O
white JJ O O
background NN O O
, , O O
so IN O O
it PRP O O
’ VBZ O O
s JJ O O
important JJ O O
to TO O O
“ VB O O
make VB O O
a DT O O
selection NN O O
” NN O O
to TO O O
highlight VB O O
the DT O O
text NN O O
. . O O

Figure NN O O
23 CD O O
: : O O
base64 NN O O
string VBG O O
enclosed VBN O O
in IN O O
the DT O O
decoded JJ O O
URLs NNP O O
( ( O O
above IN O O
and CC O O
center NN O O
) ) O O
, , O O
and CC O O
how WRB O O
it PRP O O
’ VBZ O O
s NN O O
decoded VBD O O
( ( O O
below IN O O
) ) O O
The DT O O
text NN O O
needs VBZ O O
to TO O O
be VB O O
decoded VBN O O
on IN O O
the DT O O
actual JJ O O
C NNP O O
& CC O O
C NNP O O
server NN O O
. . O O

This DT O O
can MD O O
be VB O O
done VBN O O
by IN O O
base64 NN O O
decoding NN O O
, , O O
decoding VBG O O
Hex NNP O O
string VBG O O
to TO O O
bytes NNS O O
, , O O
then RB O O
XORing VBG O O
each DT O O
byte NN O O
with IN O O
0x23 CD O O
and CC O O
rotating VBG O O
left VBN O O
by IN O O
three CD O O
positions NNS O O
. . O O

The DT O O
decoded VBN O O
C NNP O O
& CC O O
C NNP O O
URL NNP O O
looks VBZ O O
like IN O O
the DT O O
following NN O O
: : O O
hxxp NN O O
: : O O
//188 JJ B-Entity 1
[ NN I-Entity O
. . I-Entity O
] CC I-Entity O
165 CD I-Entity O
[ NN I-Entity O
. . I-Entity O
] CC I-Entity O
124 CD I-Entity O
[ NN I-Entity O
. . I-Entity O
] CC I-Entity O
30/c6afebaa8acd80e7/byuehf8af CD I-Entity O
[ NN I-Entity O
. . O O

] NN O O
php NN O O
Badnews NNS O O
will MD O O
then RB O O
start VB O O
to TO O O
communicate VB O O
with IN O O
the DT O O
C NNP O O
& CC O O
C NNP O O
server NN O O
. . O O

The DT O O
request NN O O
is VBZ O O
not RB O O
sent VBN O O
in IN O O
clear JJ O O
text JJ O O
form NN O O
, , O O
but CC O O
is VBZ O O
encoded VBN O O
using VBG O O
the DT O O
same JJ O O
algorithm NN O O
used VBN O O
for IN O O
encoding VBG O O
the DT O O
C NNP O O
& CC O O
C NNP O O
server NN O O
name NN O O
: : O O
uid= JJ O O
< $ O O
14 CD O O
hex NN O O
digits NNS O O
> NNP O O
& CC O O
u= JJ O O
< NN O O
hex NN O O
encoded VBD O O
Unicode NNP O O
username JJ O O
> NNP O O
& CC O O
c= NN O O
< NN O O
hex NN O O
encoded VBD O O
Unicode NNP O O
computer NN O O
name NN O O
> NNP O O
& CC O O
v=2.2 NN O O

The DT O O
server NN O O
response NN O O
may MD O O
include VB O O
any DT O O
of IN O O
these DT O O
11 CD O O
implemented VBD O O
commands NNS O O
: : O O
 JJ O O
shell—download NN O O
and CC O O
save VB O O
file NN O O
 JJ O O
link—download NN O O
and CC O O
write NN O O
file NN O O
, , O O
run VB O O
with IN O O
ShellExecute NNP O O
, , O O
inject VBP O O
into IN O O
process NN O O
if IN O O
writing VBG O O
to TO O O
file VB O O
fails NNS O O
 JJ O O
mod—download NN O O
and CC O O
save VB O O
DLL NNP O O
file NN O O
; : O O
likely JJ O O
module NN O O
 JJ O O
upd—download NN O O
and CC O O
save VB O O
EXE NNP O O
file NN O O
; : O O
likely JJ O O
update NN O O
 JJ O O
dwd—create NN O O
empty JJ O O
file NN O O
and CC O O
send VB O O
it PRP O O
to TO O O
C NNP O O
& CC O O
C NNP O O
server NN O O
; : O O
probably RB O O
for IN O O
testing VBG O O
purposes NNS O O
 JJ O O
kl—send VB O O
logged JJ O O
keys NNS O O
to TO O O
C NNP O O
& CC O O
C NNP O O
server NN O O
 NN O O
snp—snap NN O O
, , O O
take VBP O O
screenshot NN O O
 JJ O O
ustr—upload JJ O O
stolen VBN O O
documents NNS O O
 JJ O O
sdwl—upload NN O O
file NN O O
to TO O O
C NNP O O
& CC O O
C NNP O O
server NN O O
 JJ O O
utop—stop JJ O O
stealing NN O O
files NNS O O
 JJ O O
hcmd—run NN O O
cmd.exe NN O O
as IN O O
a DT O O
shell NN O O
Figure NN O O
24 CD O O
: : O O
Badnews NNS O O
’ VBP O O
backdoor JJ O O
commands NNS O O

Depending VBG O O
on IN O O
Badnews NNP O O
’ NNP O O
version NN O O
, , O O
there EX O O
are VBP O O
two CD O O
threads NNS O O
. . O O

One CD O O
logs VBZ O O
all PDT O O
the DT O O
pressed VBN O O
keys NNS O O
and CC O O
stores NNS O O
them PRP O O
in IN O O
a DT O O
file NN O O
, , O O
which WDT O O
, , O O
based VBN O O
on IN O O
the DT O O
received JJ O O
backdoor NN O O
command NN O O
, , O O
may MD O O
be VB O O
sent VBN O O
back RB O O
to TO O O
C NNP O O
& CC O O
C NNP O O
server NN O O
. . O O

The DT O O
same JJ O O
goes VBZ O O
for IN O O
the DT O O
file-stealing JJ O O
thread NN O O
, , O O
which WDT O O
monitors VBZ O O
USB NNP O O
devices NNS O O
and CC O O
copies NNS O O
files NNS O O
with IN O O
certain JJ O O
extensions NNS O O
to TO O O
the DT O O
backdoor NN O O
’ NNP O O
s NN O O
predefined VBD O O
directory NN O O
. . O O

Depending VBG O O
on IN O O
C NNP O O
& CC O O
C NNP O O
server NN O O
’ NNP O O
s NN O O
command NN O O
, , O O
it PRP O O
can MD O O
send VB B-Action 1
the DT B-Entity 2
stolen NN I-Entity O
files NNS I-Entity O
back RB I-Entity O
to TO I-Entity O
C NNP I-Entity O
& CC I-Entity O
C NNP I-Entity O
server NN I-Entity O
. . O O

This DT O O
feature NN O O
is VBZ O O
probably RB O O
implemented VBN O O
to TO O O
overcome VB B-Action 1
air-gapped JJ B-Entity 2
environments NNS I-Entity O
, , O O
as IN O O
not RB O O
all DT O O
of IN O O
its PRP$ O O
versions NNS O O
have VBP O O
a DT O O
thread NN O O
that IN O O
steals NNS B-Entity 3
data NNS I-Entity O
stored VBD I-Entity O
on IN I-Entity O
USB NNP I-Entity O
devices NNS I-Entity O
. . O O

Badnews NNS O O
is VBZ O O
usually RB O O
compiled VBN O O
as IN O O
a DT O O
DLL NNP O O
loaded VBN O O
by IN O O
a DT O O
legitimate JJ O O
Java NNP O O
runtime NN O O
executable NN O O
, , O O
which WDT O O
is VBZ O O
vulnerable JJ O O
to TO O O
DLL NNP O O
hijacking NN O O
. . O O

The DT O O
real JJ O O
Authenticode NNP O O
certificate NN O O
is VBZ O O
sometimes RB O O
appended VBN O O
to TO O O
the DT O O
DLL NNP O O
to TO O O
make VB O O
it PRP O O
look VB O O
more RBR O O
legitimate JJ O O
, , O O
but CC O O
it PRP O O
is VBZ O O
invalid NN O O
. . O O

We PRP O O
recently RB O O
saw VBD O O
a DT O O
sample NN O O
of IN O O
it PRP O O
as IN O O
an DT O O
executable JJ O O
in IN O O
the DT O O
wild NN O O
. . O O

In IN O O
Patchwork NNP O O
’ NNP O O
s NN O O
case NN O O
, , O O
file NN O O
stealers NNS O O
are VBP O O
used VBN O O
to TO O O
search VB B-Action 1
for IN B-Modifier 2
files NNS B-Entity 3
with IN I-Entity O
certain JJ I-Entity O
extensions NNS I-Entity O
, , O O
which WDT O O
are VBP B-Action 4
then RB I-Action O
uploaded VBN I-Action O
to TO B-Modifier 5
their PRP$ B-Entity 6
C NNP I-Entity O
& CC I-Entity O
C NNP I-Entity O
server NN I-Entity O
. . O O

The DT O O
stealers NNS O O
we PRP O O
found VBD O O
seem VBP O O
to TO O O
be VB O O
developed VBN O O
and CC O O
used VBN O O
exclusively RB O O
by IN O O
Patchwork NN O O
. . O O

Taskhost NNP B-Entity 1
Stealer NNP I-Entity O
combines NNS I-Entity O
theft NN I-Entity O
and CC I-Entity O
persistence NN I-Entity O
capabilities NNS I-Entity O
. . O O

It PRP O O
’ VBZ O O
s JJ O O
written VBN O O
in IN O O
.NET NNP O O
and CC O O
obfuscated VBN O O
with IN O O
Crypto NNP O O
Obfuscator NNP O O
, , O O
which WDT O O
can MD O O
be VB O O
removed VBN O O
with IN O O
the DT O O
de4dot NN O O
tool NN O O
. . O O

Figure NN O O
25 CD O O
: : O O
Taskhost NNP O O
Stealer NNP O O
’ NNP O O
s NN O O
properties NNS O O

Taskhost NNP O O
Stealer NNP O O
has VBZ O O
a DT O O
constructor NN O O
of IN O O
a DT O O
class NN O O
, , O O
where WRB O O
the DT O O
base.Load NN O O
function NN O O
is VBZ O O
assigned VBN O O
an DT O O
important JJ O O
function NN O O
called VBD O O
RemoveResources NNS O O
. . O O

The DT B-Entity 1
IP NNP I-Entity O
address NN I-Entity O
of IN I-Entity O
C NNP I-Entity O
& CC I-Entity O
C NNP I-Entity O
server NN I-Entity O
is VBZ O O
also RB O O
assigned VBN O O
to TO O O
a DT O O
variable NN O O
named VBN O O
windowID NN O O
. . O O

Note NN O O
that IN O O
function NN O O
names NNS O O
don VBP O O
’ JJ O O
t NNS O O
have VBP O O
any DT O O
relation NN O O
to TO O O
their PRP$ O O
actual JJ O O
function NN O O
, , O O
e.g. NN O O
, , O O
RemoveResources NNS O O
doesn VBP O O
’ JJ O O
t NN O O
mean NN O O
that IN O O
it PRP O O
“ VBZ O O
removes NNS O O
resources NNS O O
” VBP O O
. . O O

The DT O O
fake JJ O O
names NNS O O
were VBD O O
probably RB O O
made VBN O O
to TO O O
confuse NN O O
reverse NN O O
engineers NNS O O
and CC O O
researchers NNS O O
. . O O

Figure NN O O
26 CD O O
: : O O
Code NNP O O
snapshot VBD O O
showing VBG O O
RemoveResources NNS O O
Within IN O O
the DT O O
RemoveResources NNPS O O
function NN O O
is VBZ O O
a DT B-Entity 1
list NN I-Entity O
of IN I-Entity O
document NN I-Entity O
extensions NNS I-Entity O
that WDT I-Entity O
are VBP I-Entity O
of IN I-Entity O
interest NN I-Entity O
to TO I-Entity O
Patchwork NNP I-Entity O
, , O O
which WDT O O
are VBP O O
files NNS O O
commonly RB O O
associated VBN O O
with IN O O
cyberespionage NN O O
. . O O

It PRP B-Entity 1
also RB O O
has VBZ O O
a DT O O
function NN O O
that WDT O O
checks VBZ O O
for IN O O
the DT O O
existence NN O O
of IN O O
a DT O O
sys.bin NN O O
file NN O O
in IN O O
% NN O O
APPDATA\Roaming\Microsoft\taskhost\1.0.0.0\ NNP O O
. . O O

This DT O O
file NN O O
contains VBZ O O
a DT O O
list NN O O
of IN O O
all DT O O
documents NNS O O
with IN O O
paths NNS O O
accessible JJ O O
from IN O O
the DT O O
infected JJ O O
machine NN O O
. . O O

Figure NN O O
27 CD O O
: : O O
Document NN O O
extensions NNS O O
specified VBN O O
by IN O O
Taskhost NNP O O
Stealer NNP O O

Then RB O O
, , O O
it PRP O O
drops VBZ O O
Microsoft.Win32.TaskScheduler.dll NNP O O
and CC O O
adds VBZ O O
persistence NN O O
. . O O

The DT O O
code NN O O
snippet NN O O
below IN O O
shows NNS O O
the DT O O
name NN O O
of IN O O
the DT O O
task NN O O
( ( O O
Active JJ O O
Qiho NNP O O
Security NNP O O
) ) O O
, , O O
as RB O O
well RB O O
as IN O O
the DT O O
time NN O O
interval NN O O
( ( O O
5 CD O O
minutes NNS O O
) ) O O
and CC O O
duration NN O O
( ( O O
60 CD O O
days NNS O O
) ) O O
. . O O

It PRP O O
means VBZ O O
that IN O O
the DT O O
process NN O O
of IN O O
looking VBG O O
for IN O O
new JJ O O
files NNS O O
repeats VBZ O O
every DT O O
5 CD O O
minutes NNS O O
for IN O O
the DT O O
next JJ O O
86,400 CD O O
minutes NNS O O
( ( O O
60 CD O O
days NNS O O
) ) O O
, , O O
based VBN O O
on IN O O
the DT O O
code NN O O
and CC O O
scheduled VBN O O
task NN O O
exported VBN O O
to TO O O
XML VB O O
format NN O O
. . O O

Figure NN O O
28 CD O O
: : O O
Code NNP O O
snippets NNS O O
showing VBG O O
how WRB O O
Taskhost NNP O O
Stealer NNP O O
looks VBZ O O
for IN O O
new JJ O O
files NNS O O
( ( O O
above IN O O
) ) O O
, , O O
which WDT O O
is VBZ O O
also RB O O
in IN O O
the DT O O
XML NNP O O
file NN O O
exported VBN O O
from IN O O
Task NNP O O
Scheduler NNP O O
( ( O O
below IN O O
) ) O O
It PRP O O
then RB O O
enumerates VBZ O O
all PDT O O
the DT O O
available JJ O O
drives NNS O O
and CC O O
makes VBZ B-Action 1
a DT B-Entity 2
POST NNP I-Entity O
request NN I-Entity O
on IN I-Entity O
C NNP I-Entity O
& CC I-Entity O
C NNP I-Entity O
about IN O O
the DT O O
existence NN O O
of IN O O
these DT O O
drives NNS O O
: : O O

Figure NN O O
29 CD O O
: : O O
Available JJ O O
drives NNS O O
in IN O O
the DT O O
infected JJ O O
machine NN O O
are VBP O O
enumerated VBN O O

The DT O O
request NN O O
contains VBZ O O
parameters NNS O O
drive NN O O
and CC O O
student_name NN O O
. . O O

drive NN O O
’ NN O O
s JJ O O
value NN O O
is VBZ O O
a DT O O
disk NN O O
letter NN O O
followed VBN O O
by IN O O
information NN O O
if IN O O
it PRP O O
is VBZ O O
a DT O O
Fixed NNP O O
or CC O O
Network NNP O O
drive NN O O
. . O O

student_name NN O O
contains VBZ O O
computer NN O O
name NN O O
and CC O O
username NN O O
, , O O
separated VBN O O
by IN O O
a DT O O
hyphen NN O O
. . O O

Files NNS O O
on IN O O
all DT O O
“ NNP O O
ready JJ O O
” NNP O O
drives NNS O O
will MD O O
be VB O O
enumerated VBN O O
as RB O O
saved VBN O O
as IN O O
a DT O O
list NN O O
in IN O O
sys.bin NN O O
. . O O

Figure NN O O
30 CD O O
: : O O
POST NN O O
request NN O O
with IN O O
the DT O O
drive NN O O
and CC O O
student_name NN O O
parameters NNS O O
( ( O O
above IN O O
) ) O O
and CC O O
files VBZ O O
being VBG O O
enumerated VBN O O
( ( O O
below IN O O
) ) O O
The DT O O
next JJ O O
step NN O O
is VBZ O O
to TO O O
read VB O O
from IN O O
hxxp NN O O
: : O O
//209 JJ O O
[ NN O O
. . O O
] CC O O
58 CD O O
[ NN O O
. . O O
] CC O O
185 CD O O
[ NN O O
. . O O

] RB O O
35/LOG/ CD O O
< JJ O O
computer NN O O
name NN O O
> NNP O O
- : O O
< NN O O
user NN O O
name NN O O
> NNP O O
[ NNP O O
. . O O
] NN O O
html NN O O
. . O O

If IN O O
the DT O O
response NN O O
is VBZ O O
c121 JJ O O
, , O O
the DT B-Entity 1
program NN I-Entity O
ends VBZ I-Entity O
. . O O

This DT O O
lets VBZ O O
attackers NNS O O
control NN O O
which WDT O O
machines NNS O O
they PRP O O
do VBP O O
not RB O O
want VB O O
to TO O O
receive JJ O O
files NNS O O
from IN O O
. . O O

All DT O O
files NNS O O
from IN O O
the DT O O
previously RB O O
created VBN O O
list NN O O
will MD O O
be VB O O
uploaded JJ O O
one CD O O
by IN O O
one CD O O
. . O O

A DT O O
list NN O O
of IN O O
uploaded JJ O O
files NNS O O
will MD O O
be VB B-Action 1
in IN B-Modifier 2
s.dwg NN B-Entity 3
, , O O
while IN O O
the DT O O
list NN O O
of IN O O
all DT O O
files NNS O O
is VBZ O O
in IN O O
sys.bin NN O O
. . O O

During IN O O
each DT O O
run NN O O
, , O O
sys.bin NN O O
is VBZ O O
deleted VBN O O
and CC O O
newly RB O O
created VBN O O
; : O O
however RB O O
, , O O
s.dwg NN O O
remains VBZ O O
the DT O O
same JJ O O
. . O O

This DT O O
ensures VBZ O O
that IN O O
only RB O O
newly RB O O
created VBN O O
files NNS O O
are VBP O O
uploaded JJ O O
. . O O

The DT O O
upload NN O O
path NN O O
looks VBZ O O
like IN O O
this DT O O
: : O O
drive NN O O
( ( O O
Fixed NNP O O
or CC O O
Network NNP O O
) ) O O
, , O O
followed VBN O O
by IN O O
path NN O O
, , O O
computer NN O O
name NN O O
, , O O
and CC O O
username NN O O
. . O O

Figure NN O O
31 CD O O
: : O O
Code NNP O O
snippets VBZ O O
showing VBG O O
the DT O O
c121 NN O O
response NN O O
( ( O O
top JJ O O
) ) O O
and CC O O
s.dwg NN O O
( ( O O
bottom NN O O
) ) O O

Wintel NNP O O
Stealer NNP O O
( ( O O
Win NNP O O
Telephonic NNP O O
Services NNPS O O
) ) O O
is VBZ O O
another DT O O
.NET JJ O O
stealer NN O O
named VBN O O
after IN O O
the DT O O
project NN O O
name NN O O
. . O O

Compared VBN O O
to TO O O
the DT O O
Taskhost NNP O O
Stealer NNP O O
, , O O
Wintel NNP O O
Stealer NNP O O
targets NNS O O
different JJ O O
files NNS O O
types NNS O O
and CC O O
has VBZ O O
no DT O O
persistence NN O O
mechanism NN O O
. . O O

The DT O O
information NN O O
of IN O O
files NNS O O
are VBP O O
stored VBN O O
in IN O O
the DT O O
following JJ O O
format NN O O
: : O O
filename NN O O
whose WP$ O O
path NN O O
is VBZ O O
AES-encrypted JJ O O
with IN O O
a DT O O
hardcoded VBN O O
password NN O O
, , O O
then RB O O
encoded VBD O O
with IN O O
base64 NN O O
, , O O
with IN O O
the DT O O
& CC O O
, , O O
SHA256 NNP O O
hash NN O O
, , O O
and CC O O
$ $ O O
character NN O O
appended VBN O O
. . O O

This DT O O
structure NN O O
is VBZ O O
stored VBN O O
in IN O O
a DT O O
global JJ O O
variable NN O O
and CC O O
remains VBZ O O
in IN O O
memory NN O O
. . O O

A DT O O
timer NN O O
is VBZ O O
enabled VBN O O
, , O O
starting VBG O O
the DT O O
upload JJ O O
process NN O O
when WRB O O
an DT O O
internet NN O O
connection NN O O
is VBZ O O
available JJ O O
. . O O

Figure NN O O
32 CD O O
: : O O
Wintel NNP O O
Stealer NNP O O
’ NNP O O
s NN O O
configuration NN O O
( ( O O
left VBN O O
) ) O O
and CC O O
the DT O O
file NN O O
types VBZ O O
it PRP O O
targets VBZ O O
( ( O O
right NN O O
) ) O O

Figure NN O O
33 CD O O
: : O O
Information NN O O
about IN O O
the DT O O
files NNS O O
is VBZ O O
stored VBN O O
in IN O O
a DT O O
certain JJ O O
format NN O O

The DT O O
load_check.php JJ O O
script NN O O
is VBZ O O
first JJ O O
queried VBN O O
with IN O O
the DT O O
parameters NNS O O
user VBP O O
, , O O
which WDT O O
is VBZ O O
base64-encoded JJ O O
username NN O O
, , O O
and CC O O
hsh NN O O
, , O O
which WDT O O
is VBZ O O
file JJ O O
hash NN O O
. . O O

The DT O O
? . O O
ussr= NN O O
in IN O O
the DT O O
screenshot NN O O
below NN O O
is VBZ O O
likely JJ O O
a DT O O
typo NN O O
; : O O
it PRP O O
should MD O O
be VB O O
user JJR O O
and CC O O
not RB O O
ussr NN O O
( ( O O
Soviet NNP O O
Union NNP O O
) ) O O
. . O O

Figure NN O O
34 CD O O
: : O O
Wintel NNP O O
Stealer NNP O O
’ NNP O O
s VBD O O
load_check.php JJ O O
script NN O O
Querying VBG O O
this DT O O
script NN O O
will MD O O
tell VB O O
whether IN O O
the DT O O
files NNS O O
are VBP O O
of IN O O
interest NN O O
and CC O O
should MD O O
be VB O O
uploaded VBN O O
, , O O
and CC O O
also RB O O
ensures NNS O O
that IN O O
the DT O O
backend NN O O
server NN O O
doesn NN O O
’ NNP O O
t NN O O
upload NN O O
duplicate NN O O
files NNS O O
. . O O

The DT O O
up.php JJ O O
script NN O O
is VBZ O O
for IN O O
uploading VBG O O
files NNS O O
, , O O
using VBG O O
parameters NNS O O
use VBP O O
for IN O O
username NN O O
, , O O
fl NN O O
for IN O O
bytes NNS O O
of IN O O
the DT O O
file NN O O
, , O O
hs NN O O
for IN O O
the DT O O
SHA256 NNP O O
. . O O

Older JJR B-Entity 1
versions NNS I-Entity O
of IN I-Entity O
Patchwork NNP I-Entity O
’ NNP I-Entity O
s NN I-Entity O
file NN I-Entity O
stealers NNS I-Entity O
were VBD O O
written VBN O O
in IN O O
AutoIt NNP O O
, , O O
and CC O O
each DT O O
of IN O O
these DT O O
contains NNS O O
an DT O O
endless NN O O
loop NN O O
. . O O

The DT O O
function NN O O
__searchindex NN O O
searches NNS O O
drive VBP O O
C NNP O O
: : O O
\ NN O O
for IN O O
certain JJ O O
file JJ O O
extensions NNS O O
. . O O

They PRP B-Entity 1
will MD O O
copy VB O O
the DT O O
targeted VBN O O
files NNS O O
to TO O O
a DT O O
directory NN O O
named VBN O O
index NN O O
. . O O

It PRP B-Entity 1
also RB O O
maintains VBZ O O
a DT O O
file NN O O
Temp.log NNP O O
, , O O
each DT O O
line NN O O
of IN O O
which WDT O O
containing VBG O O
a DT O O
file NN O O
’ JJ O O
s JJ O O
hex-encoded JJ O O
MD5 NNP O O
hash NN O O
. . O O

The DT O O
function NN O O
__sendoutlist NN O O
uploads IN O O
all PDT O O
the DT O O
files NNS O O
from IN O O
index NN O O
directory NN O O
to TO O O
the DT O O
C NNP O O
& CC O O
C NNP O O
server NN O O
and CC O O
deletes VBZ O O
them PRP O O
. . O O

Persistence NN B-Entity 1
is VBZ B-Action 2
carried VBN I-Action O
out RP I-Action O
by IN B-Modifier 3
modifying VBG B-Entity 4
the DT I-Entity O
Run NNP I-Entity O
registry NN I-Entity O
key NN I-Entity O
. . O O

Figure NN O O
35 CD O O
: : O O
The DT B-Entity 1
functions NNS I-Entity O
of IN I-Entity O
the DT I-Entity O
AutoIt NNP I-Entity O
stealers NNS I-Entity O
We PRP I-Entity O
found VBD I-Entity O
30 CD I-Entity O
to TO I-Entity O
40 CD I-Entity O
IP NNP I-Entity O
addresses NNS I-Entity O
as RB I-Entity O
well RB I-Entity O
as IN I-Entity O
domain NN I-Entity O
names NNS I-Entity O
used VBN I-Entity O
by IN I-Entity O
Patchwork NNP I-Entity O
in IN I-Entity O
2017 CD I-Entity O
. . O O

Each DT O O
server NN O O
has VBZ O O
a DT O O
different JJ O O
purpose NN O O
. . O O

Some DT O O
are VBP O O
only RB O O
meant VBN O O
to TO O O
be VB B-Action 1
C NNP B-Entity 2
& CC I-Entity O
C NNP I-Entity O
servers NNS I-Entity O
that WDT I-Entity O
collect VBP I-Entity O
data NNS I-Entity O
sent VBN I-Entity O
by IN I-Entity O
the DT I-Entity O
file NN I-Entity O
stealers NNS I-Entity O
, , I-Entity O
and CC I-Entity O
no DT I-Entity O
domain NN I-Entity O
name NN I-Entity O
points NNS I-Entity O
to TO I-Entity O
those DT I-Entity O
IP NNP I-Entity O
addresses NNS I-Entity O
. . O O

In IN O O
some DT O O
cases NNS O O
, , O O
the DT B-Entity 1
same JJ I-Entity O
server NN I-Entity O
is VBZ I-Entity O
used VBN I-Entity O
for IN I-Entity O
C NNP I-Entity O
& CC I-Entity O
C NNP I-Entity O
communication NN I-Entity O
while IN O O
also RB O O
acting VBG O O
as IN O O
a DT O O
website JJ O O
hosting NN O O
content NN O O
copied VBN O O
from IN O O
legitimate JJ O O
websites NNS O O
and CC O O
propagating VBG O O
malware NN O O
or CC O O
weaponized JJ O O
documents NNS O O
. . O O

They PRP O O
misuse VBP O O
publicly RB O O
available JJ O O
PHP NNP O O
scripts NNS O O
to TO O O
retrieve VB O O
files NNS O O
from IN O O
the DT O O
server NN O O
without IN O O
disclosing VBG O O
their PRP$ O O
real JJ O O
paths NNS O O
. . O O

While IN O O
this DT O O
could MD O O
be VB O O
for IN O O
tracking VBG O O
purposes NNS O O
, , O O
it PRP O O
’ VBZ O O
s RB O O
more RBR O O
likely JJ O O
for IN O O
deterring VBG B-Action 1
researchers NNS B-Entity 2
from IN B-Modifier 3
finding VBG B-Entity 4
open JJ I-Entity O
directories NNS I-Entity O
. . O O

The DT O O
documents NNS O O
are VBP O O
almost RB O O
always RB O O
downloaded VBN O O
from IN O O
the DT O O
/xinwen NNP O O
directory NN O O
, , O O
which WDT O O
is VBZ O O
now RB O O
properly RB O O
configured VBN O O
and CC O O
can MD O O
not RB O O
be VB O O
browsed VBN O O
. . O O

On IN O O
multiple JJ O O
occasions NNS O O
, , O O
we PRP O O
observed VBD O O
them PRP O O
temporarily RB O O
removing VBG O O
the DT O O
file NN O O
so IN O O
it PRP O O
could MD O O
not RB O O
be VB O O
retrieved VBN O O
. . O O

Sometimes RB O O
they PRP O O
replaced VBD O O
it PRP O O
with IN O O
a DT O O
legitimate JJ O O
file NN O O
to TO O O
dupe VB O O
researchers NNS O O
. . O O

In IN O O
some DT O O
of IN O O
their PRP$ O O
servers NNS O O
’ VBP O O
homepages NNS O O
, , O O
they PRP O O
display VBP O O
a DT O O
fake JJ O O
302 CD O O
redirection NN O O
page NN O O
to TO O O
trick VB O O
researchers NNS O O
into IN O O
thinking VBG O O
the DT O O
files NNS O O
are VBP O O
gone VBN O O
. . O O

Other JJ O O
servers NNS O O
are VBP O O
used VBN O O
only RB O O
to TO O O
host VB O O
phishing NN O O
websites NNS O O
. . O O

Content JJ O O
changes NNS O O
between IN O O
each DT O O
campaign NN O O
, , O O
but CC O O
the DT O O
same JJ O O
server NN O O
remains VBZ O O
. . O O

For IN O O
instance NN O O
, , O O
the DT O O
qzonecn NN O O
[ NN O O
. . O O

] JJ O O
com NN O O
domain NN O O
has VBZ O O
been VBN O O
pointing VBG O O
to TO O O
the DT O O
same JJ O O
IP NNP O O
address NN O O
since IN O O
January NNP O O
2017 CD O O
, , O O
but CC O O
it PRP O O
now RB O O
points VBZ O O
to TO O O
yahoomail VB B-Action 1
[ NNP B-Entity 2
. . I-Entity O
] JJ I-Entity O
support NN I-Entity O
. . O O

It PRP O O
references VBZ O O
euuwebmail JJ O O
[ NN O O
. . O O

] NN O O
com NN O O
for IN O O
four CD O O
months NNS O O
, , O O
and CC O O
then RB O O
militaryreviews NNS O O
[ VBP O O
. . O O

] JJ O O
net NN O O
for IN O O
a DT O O
week NN O O
. . O O

This DT O O
is VBZ O O
consistent JJ O O
with IN O O
the DT O O
three CD O O
months NNS O O
of IN O O
validity NN O O
of IN O O
the DT O O
Let NNP O O
’ NNP O O
s VB O O
Encrypt NNP O O
certificates NNS O O
. . O O

Apart RB O O
from IN O O
militaryreviews NNS O O
[ NNS O O
. . O O

] JJ O O
net NN O O
, , O O
all DT O O
of IN O O
these DT O O
domain NN O O
names NNS O O
are VBP O O
similar JJ O O
to TO O O
legitimate VB O O
websites NNS O O
that IN O O
require VBP O O
authentication NN O O
. . O O

We PRP O O
also RB O O
found VBD O O
one CD O O
server NN O O
that WDT O O
was VBD O O
not RB O O
hosting VBG O O
any DT O O
content NN O O
but CC O O
had VBD O O
a DT O O
Postfix NNP O O
instance NN O O
running VBG O O
and CC O O
being VBG O O
used VBN O O
to TO O O
send VB B-Action 1
targeted JJ B-Entity 2
emails NNS I-Entity O
. . O O

All DT O O
of IN O O
these DT O O
servers NNS O O
seem VBP O O
to TO O O
use VB O O
Apache NNP O O
on IN O O
CentOS NNP O O
. . O O

The DT O O
favicon NN O O
on IN O O
a DT O O
server NN O O
they PRP O O
recently RB O O
used VBD O O
was VBD O O
still RB O O
similar JJ O O
to TO O O
the DT O O
one NN O O
used VBN O O
in IN O O
WampServer NNP O O
. . O O

It PRP O O
’ VBZ O O
s RBR O O
probable JJ O O
that IN O O
Patchwork NNP O O
uses VBZ O O
this DT O O
package NN O O
to TO O O
facilitate VB B-Action 1
server NN B-Entity 2
installation NN I-Entity O
when WRB I-Entity O
using VBG I-Entity O
a DT I-Entity O
Windows NNP I-Entity O
environment NN I-Entity O
. . O O

The DT O O
domain NN O O
names NNS O O
are VBP O O
always RB O O
registered VBN O O
using VBG O O
a DT O O
service NN O O
protecting VBG O O
the DT O O
related JJ O O
whois NN O O
information NN O O
, , O O
which WDT O O
wasn NN O O
’ NNP O O
t NN O O
always RB O O
the DT O O
case NN O O
before IN O O
Patchwork NNP O O
’ NNP O O
s NN O O
activities NNS O O
were VBD O O
disclosed VBN O O
in IN O O
2016 CD O O
. . O O

Additionally RB O O
, , O O
many JJ O O
of IN O O
the DT O O
domain NN O O
names NNS O O
published VBN O O
in IN O O
previous JJ O O
reports NNS O O
have VBP O O
been VBN O O
either RB O O
sinkholed VBN O O
by IN O O
security NN O O
companies NNS O O
or CC O O
abandoned VBN O O
by IN O O
the DT B-Entity 1
attackers NNS I-Entity O
. . O O

Patchwork NN O O
is VBZ O O
in IN O O
a DT O O
vicious JJ O O
cycle NN O O
, , O O
given VBN O O
the DT O O
group NN O O
’ NNP O O
s VBZ O O
habit NN O O
of IN O O
rehashing NN O O
tools NNS O O
and CC O O
malware NN O O
. . O O

The DT O O
more JJR O O
these DT O O
tools NNS O O
are VBP O O
used VBN O O
, , O O
the DT O O
likelier JJR O O
it PRP O O
is VBZ O O
for IN O O
them PRP O O
to TO O O
be VB O O
incorporated VBN O O
into IN O O
the DT O O
group NN O O
’ NNP O O
s VBZ O O
arsenal JJ O O
. . O O

For IN O O
enterprises NNS O O
, , O O
the DT O O
gamut NN O O
of IN O O
tools NNS O O
and CC O O
techniques NNS O O
at IN O O
Patchwork NNP O O
’ NNP O O
s NN O O
disposal NN O O
highlights VBZ O O
the DT O O
significance NN O O
of IN O O
defense NN O O
in IN O O
depth NN O O
: : O O
arraying VBG O O
proactive JJ O O
defense NN O O
to TO O O
thwart VB O O
threats NNS O O
at IN O O
each DT O O
level—from IN O O
the DT O O
gateways NNS O O
, , O O
endpoints NNS O O
, , O O
and CC O O
networks NNS O O
to TO O O
servers NNS O O
. . O O

What WP O O
can MD O O
enterprises VB O O
do VB O O
? . O O

Keep VB B-Action 1
the DT B-Entity 2
operating NN I-Entity O
system NN I-Entity O
and CC I-Entity O
its PRP$ I-Entity O
applications NNS I-Entity O
updated—or JJ I-Entity O
employ VBP I-Entity O
virtual JJ I-Entity O
patching VBG I-Entity O
for IN I-Entity O
legacy NN I-Entity O
systems—to JJ I-Entity O
prevent JJ I-Entity O
security NN I-Entity O
gaps NNS I-Entity O
and CC I-Entity O
deter NN I-Entity O
attackers NNS I-Entity O
from IN B-Modifier 3
exploiting VBG B-Entity 4
them PRP I-Entity O
. . O O

Firewall NN O O
, , O O
sandbox NN O O
, , O O
and CC O O
intrusion NN O O
detection NN O O
and CC O O
prevention NN O O
systems NNS O O
help VBP O O
detect VB O O
red JJ O O
flags NNS O O
in IN O O
the DT O O
network NN O O
. . O O

Enforce NN O O
the DT O O
principle NN O O
of IN O O
least JJS O O
privilege NN O O
: : O O
blacklist NN O O
and CC O O
secure VB B-Action 1
the DT B-Entity 2
use NN I-Entity O
of IN I-Entity O
tools NNS I-Entity O
usually RB I-Entity O
reserved VBN I-Entity O
for IN I-Entity O
system NN I-Entity O
administrators NNS I-Entity O
, , I-Entity O
such JJ I-Entity O
as IN I-Entity O
PowerShell NNP I-Entity O
. . O O

Network NNP O O
segmentation NN O O
and CC O O
data NNS O O
categorization NN O O
thwart IN O O
lateral JJ O O
movement NN O O
and CC O O
risk NN O O
of IN O O
further JJ O O
data NNS O O
theft NN O O
, , O O
while IN O O
behavior JJ O O
monitoring NN O O
and CC O O
application NN O O
control/whitelisting NN O O
block RB O O
anomalous JJ O O
routines NNS O O
executed VBN O O
by IN O O
suspicious JJ O O
files NNS O O
. . O O

And CC O O
more RBR O O
importantly RB O O
, , O O
secure VB O O
the DT O O
email NN O O
gateway NN O O
. . O O

Patchwork NN B-Entity 1
may MD O O
only RB O O
be VB O O
reusing VBG O O
vulnerability NN O O
exploits NNS O O
and CC O O
malware NN O O
, , O O
but CC O O
they PRP O O
’ VBP O O
re VB O O
tried-and-tested—it JJ O O
only RB O O
takes VBZ O O
one CD O O
susceptible JJ O O
layer NN O O
to TO O O
affect VB O O
the DT O O
whole NN O O
chain NN O O
. . O O

Trend NNP O O
Micro NNP O O
Incorporated NNP O O
, , O O
a DT O O
global JJ O O
leader NN O O
in IN O O
security NN O O
software NN O O
, , O O
strives VBZ O O
to TO O O
make VB O O
the DT O O
world NN O O
safe NN O O
for IN O O
exchanging VBG O O
digital JJ O O
information NN O O
. . O O

Our PRP$ O O
innovative JJ O O
solutions NNS O O
for IN O O
consumers NNS O O
, , O O
businesses NNS O O
and CC O O
governments NNS O O
provide VBP O O
layered VBN O O
content JJ O O
security NN O O
to TO O O
protect VB B-Action 1
information NN B-Entity 2
on IN I-Entity O
mobile JJ I-Entity O
devices NNS I-Entity O
, , I-Entity O
endpoints NNS I-Entity O
, , I-Entity O
gateways NNS I-Entity O
, , I-Entity O
servers NNS I-Entity O
and CC I-Entity O
the DT I-Entity O
cloud NN I-Entity O
. . O O

All DT B-Entity 1
of IN I-Entity O
our PRP$ I-Entity O
solutions NNS I-Entity O
are VBP B-Action 2
powered VBN I-Action O
by IN O O
cloud-based JJ O O
global JJ O O
threat NN O O
intelligence NN O O
, , O O
the DT O O
Trend NNP O O
Micro™ NNP O O
Smart NNP O O
Protection NNP O O
Network™ NNP O O
, , O O
and CC O O
are VBP O O
supported VBN O O
by IN O O
over IN O O
1,200 CD O O
threat NN O O
experts NNS O O
around IN O O
the DT O O
globe NN O O
. . O O

For IN O O
more JJR O O
information NN O O
, , O O
visit NN O O
www.trendmicro.com NN O O
. . O O

t-ball NN O O
©2017 NN O O
by IN O O
Trend NNP O O
Micro NNP O O
, , O O
Incorporated NNP O O
. . O O

All DT B-Entity 1
rights NNS I-Entity O
reserved VBN I-Entity O
. . O O

Trend NNP O O
Micro NNP O O
and CC O O
the DT O O
Trend NNP O O
Micro NN O O
trademarks NNS O O
of IN O O
Trend NNP O O
Micro NNP O O
, , O O
Incorporated VBN O O
. . O O

All DT B-Entity 1
other JJ I-Entity O
product NN I-Entity O
or CC I-Entity O
company NN I-Entity O
names NNS I-Entity O
may MD O O
be VB O O
trademarks NNS O O
or CC O O
registered VBD O O
trademarks NNS O O
of IN O O
their PRP$ O O
owners NNS O O
. . O O

trademarks NNS O O
or CC O O
registered VBD O O
logo NN O O
are VBP O O

